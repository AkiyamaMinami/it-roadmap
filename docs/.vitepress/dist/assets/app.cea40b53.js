var Bs=Object.defineProperty,Xs=Object.defineProperties;var Ws=Object.getOwnPropertyDescriptors;var Hn=Object.getOwnPropertySymbols;var Ys=Object.prototype.hasOwnProperty,Hs=Object.prototype.propertyIsEnumerable;var Nn=(a,t,g)=>t in a?Bs(a,t,{enumerable:!0,configurable:!0,writable:!0,value:g}):a[t]=g,Bi=(a,t)=>{for(var g in t||(t={}))Ys.call(t,g)&&Nn(a,g,t[g]);if(Hn)for(var g of Hn(t))Hs.call(t,g)&&Nn(a,g,t[g]);return a},Xi=(a,t)=>Xs(a,Ws(t));function Wi(a,t){const g=Object.create(null),v=a.split(",");for(let _=0;_<v.length;_++)g[v[_]]=!0;return t?_=>!!g[_.toLowerCase()]:_=>!!g[_]}const Ns="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Us=Wi(Ns);function Un(a){return!!a||a===""}function Yi(a){if(gt(a)){const t={};for(let g=0;g<a.length;g++){const v=a[g],_=At(v)?Vs(v):Yi(v);if(_)for(const C in _)t[C]=_[C]}return t}else{if(At(a))return a;if(Tt(a))return a}}const zs=/;(?![^(]*\))/g,Gs=/:(.+)/;function Vs(a){const t={};return a.split(zs).forEach(g=>{if(g){const v=g.split(Gs);v.length>1&&(t[v[0].trim()]=v[1].trim())}}),t}function me(a){let t="";if(At(a))t=a;else if(gt(a))for(let g=0;g<a.length;g++){const v=me(a[g]);v&&(t+=v+" ")}else if(Tt(a))for(const g in a)a[g]&&(t+=g+" ");return t.trim()}const Qt=a=>a==null?"":gt(a)||Tt(a)&&(a.toString===qn||!vt(a.toString))?JSON.stringify(a,zn,2):String(a),zn=(a,t)=>t&&t.__v_isRef?zn(a,t.value):ke(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((g,[v,_])=>(g[`${v} =>`]=_,g),{})}:Vn(t)?{[`Set(${t.size})`]:[...t.values()]}:Tt(t)&&!gt(t)&&!Kn(t)?String(t):t,St={},Ee=[],Vt=()=>{},$s=()=>!1,qs=/^on[^a-z]/,Xe=a=>qs.test(a),Hi=a=>a.startsWith("onUpdate:"),It=Object.assign,Gn=(a,t)=>{const g=a.indexOf(t);g>-1&&a.splice(g,1)},Ks=Object.prototype.hasOwnProperty,Ct=(a,t)=>Ks.call(a,t),gt=Array.isArray,ke=a=>li(a)==="[object Map]",Vn=a=>li(a)==="[object Set]",vt=a=>typeof a=="function",At=a=>typeof a=="string",Ni=a=>typeof a=="symbol",Tt=a=>a!==null&&typeof a=="object",$n=a=>Tt(a)&&vt(a.then)&&vt(a.catch),qn=Object.prototype.toString,li=a=>qn.call(a),Js=a=>li(a).slice(8,-1),Kn=a=>li(a)==="[object Object]",Ui=a=>At(a)&&a!=="NaN"&&a[0]!=="-"&&""+parseInt(a,10)===a,We=Wi(",key,ref,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ci=a=>{const t=Object.create(null);return g=>t[g]||(t[g]=a(g))},Qs=/-(\w)/g,Zt=ci(a=>a.replace(Qs,(t,g)=>g?g.toUpperCase():"")),Zs=/\B([A-Z])/g,Ae=ci(a=>a.replace(Zs,"-$1").toLowerCase()),hi=ci(a=>a.charAt(0).toUpperCase()+a.slice(1)),zi=ci(a=>a?`on${hi(a)}`:""),Ye=(a,t)=>!Object.is(a,t),Gi=(a,t)=>{for(let g=0;g<a.length;g++)a[g](t)},ui=(a,t,g)=>{Object.defineProperty(a,t,{configurable:!0,enumerable:!1,value:g})},to=a=>{const t=parseFloat(a);return isNaN(t)?a:t};let Jn;const eo=()=>Jn||(Jn=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let ve;const fi=[];class io{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&ve&&(this.parent=ve,this.index=(ve.scopes||(ve.scopes=[])).push(this)-1)}run(t){if(this.active)try{return this.on(),t()}finally{this.off()}}on(){this.active&&(fi.push(this),ve=this)}off(){this.active&&(fi.pop(),ve=fi[fi.length-1])}stop(t){if(this.active){if(this.effects.forEach(g=>g.stop()),this.cleanups.forEach(g=>g()),this.scopes&&this.scopes.forEach(g=>g.stop(!0)),this.parent&&!t){const g=this.parent.scopes.pop();g&&g!==this&&(this.parent.scopes[this.index]=g,g.index=this.index)}this.active=!1}}}function no(a,t){t=t||ve,t&&t.active&&t.effects.push(a)}const Vi=a=>{const t=new Set(a);return t.w=0,t.n=0,t},Qn=a=>(a.w&le)>0,Zn=a=>(a.n&le)>0,ro=({deps:a})=>{if(a.length)for(let t=0;t<a.length;t++)a[t].w|=le},so=a=>{const{deps:t}=a;if(t.length){let g=0;for(let v=0;v<t.length;v++){const _=t[v];Qn(_)&&!Zn(_)?_.delete(a):t[g++]=_,_.w&=~le,_.n&=~le}t.length=g}},$i=new WeakMap;let He=0,le=1;const qi=30,Ne=[];let _e;const ye=Symbol(""),Ki=Symbol("");class Ji{constructor(t,g=null,v){this.fn=t,this.scheduler=g,this.active=!0,this.deps=[],no(this,v)}run(){if(!this.active)return this.fn();if(!Ne.includes(this))try{return Ne.push(_e=this),oo(),le=1<<++He,He<=qi?ro(this):tr(this),this.fn()}finally{He<=qi&&so(this),le=1<<--He,Ce(),Ne.pop();const t=Ne.length;_e=t>0?Ne[t-1]:void 0}}stop(){this.active&&(tr(this),this.onStop&&this.onStop(),this.active=!1)}}function tr(a){const{deps:t}=a;if(t.length){for(let g=0;g<t.length;g++)t[g].delete(a);t.length=0}}let De=!0;const Qi=[];function Me(){Qi.push(De),De=!1}function oo(){Qi.push(De),De=!0}function Ce(){const a=Qi.pop();De=a===void 0?!0:a}function Wt(a,t,g){if(!er())return;let v=$i.get(a);v||$i.set(a,v=new Map);let _=v.get(g);_||v.set(g,_=Vi()),ir(_)}function er(){return De&&_e!==void 0}function ir(a,t){let g=!1;He<=qi?Zn(a)||(a.n|=le,g=!Qn(a)):g=!a.has(_e),g&&(a.add(_e),_e.deps.push(a))}function ee(a,t,g,v,_,C){const w=$i.get(a);if(!w)return;let h=[];if(t==="clear")h=[...w.values()];else if(g==="length"&&gt(a))w.forEach((r,l)=>{(l==="length"||l>=v)&&h.push(r)});else switch(g!==void 0&&h.push(w.get(g)),t){case"add":gt(a)?Ui(g)&&h.push(w.get("length")):(h.push(w.get(ye)),ke(a)&&h.push(w.get(Ki)));break;case"delete":gt(a)||(h.push(w.get(ye)),ke(a)&&h.push(w.get(Ki)));break;case"set":ke(a)&&h.push(w.get(ye));break}if(h.length===1)h[0]&&Zi(h[0]);else{const r=[];for(const l of h)l&&r.push(...l);Zi(Vi(r))}}function Zi(a,t){for(const g of gt(a)?a:[...a])(g!==_e||g.allowRecurse)&&(g.scheduler?g.scheduler():g.run())}const ao=Wi("__proto__,__v_isRef,__isVue"),nr=new Set(Object.getOwnPropertyNames(Symbol).map(a=>Symbol[a]).filter(Ni)),lo=tn(),co=tn(!1,!0),ho=tn(!0),rr=uo();function uo(){const a={};return["includes","indexOf","lastIndexOf"].forEach(t=>{a[t]=function(...g){const v=bt(this);for(let C=0,w=this.length;C<w;C++)Wt(v,"get",C+"");const _=v[t](...g);return _===-1||_===!1?v[t](...g.map(bt)):_}}),["push","pop","shift","unshift","splice"].forEach(t=>{a[t]=function(...g){Me();const v=bt(this)[t].apply(this,g);return Ce(),v}}),a}function tn(a=!1,t=!1){return function(v,_,C){if(_==="__v_isReactive")return!a;if(_==="__v_isReadonly")return a;if(_==="__v_raw"&&C===(a?t?Eo:dr:t?fr:ur).get(v))return v;const w=gt(v);if(!a&&w&&Ct(rr,_))return Reflect.get(rr,_,C);const h=Reflect.get(v,_,C);return(Ni(_)?nr.has(_):ao(_))||(a||Wt(v,"get",_),t)?h:Dt(h)?!w||!Ui(_)?h.value:h:Tt(h)?a?rn(h):yi(h):h}}const fo=sr(),go=sr(!0);function sr(a=!1){return function(g,v,_,C){let w=g[v];if(!a&&(_=bt(_),w=bt(w),!gt(g)&&Dt(w)&&!Dt(_)))return w.value=_,!0;const h=gt(g)&&Ui(v)?Number(v)<g.length:Ct(g,v),r=Reflect.set(g,v,_,C);return g===bt(C)&&(h?Ye(_,w)&&ee(g,"set",v,_):ee(g,"add",v,_)),r}}function po(a,t){const g=Ct(a,t);a[t];const v=Reflect.deleteProperty(a,t);return v&&g&&ee(a,"delete",t,void 0),v}function mo(a,t){const g=Reflect.has(a,t);return(!Ni(t)||!nr.has(t))&&Wt(a,"has",t),g}function vo(a){return Wt(a,"iterate",gt(a)?"length":ye),Reflect.ownKeys(a)}const or={get:lo,set:fo,deleteProperty:po,has:mo,ownKeys:vo},_o={get:ho,set(a,t){return!0},deleteProperty(a,t){return!0}},yo=It({},or,{get:co,set:go}),en=a=>a,di=a=>Reflect.getPrototypeOf(a);function gi(a,t,g=!1,v=!1){a=a.__v_raw;const _=bt(a),C=bt(t);t!==C&&!g&&Wt(_,"get",t),!g&&Wt(_,"get",C);const{has:w}=di(_),h=v?en:g?on:ze;if(w.call(_,t))return h(a.get(t));if(w.call(_,C))return h(a.get(C));a!==_&&a.get(t)}function pi(a,t=!1){const g=this.__v_raw,v=bt(g),_=bt(a);return a!==_&&!t&&Wt(v,"has",a),!t&&Wt(v,"has",_),a===_?g.has(a):g.has(a)||g.has(_)}function mi(a,t=!1){return a=a.__v_raw,!t&&Wt(bt(a),"iterate",ye),Reflect.get(a,"size",a)}function ar(a){a=bt(a);const t=bt(this);return di(t).has.call(t,a)||(t.add(a),ee(t,"add",a,a)),this}function lr(a,t){t=bt(t);const g=bt(this),{has:v,get:_}=di(g);let C=v.call(g,a);C||(a=bt(a),C=v.call(g,a));const w=_.call(g,a);return g.set(a,t),C?Ye(t,w)&&ee(g,"set",a,t):ee(g,"add",a,t),this}function cr(a){const t=bt(this),{has:g,get:v}=di(t);let _=g.call(t,a);_||(a=bt(a),_=g.call(t,a)),v&&v.call(t,a);const C=t.delete(a);return _&&ee(t,"delete",a,void 0),C}function hr(){const a=bt(this),t=a.size!==0,g=a.clear();return t&&ee(a,"clear",void 0,void 0),g}function vi(a,t){return function(v,_){const C=this,w=C.__v_raw,h=bt(w),r=t?en:a?on:ze;return!a&&Wt(h,"iterate",ye),w.forEach((l,c)=>v.call(_,r(l),r(c),C))}}function _i(a,t,g){return function(...v){const _=this.__v_raw,C=bt(_),w=ke(C),h=a==="entries"||a===Symbol.iterator&&w,r=a==="keys"&&w,l=_[a](...v),c=g?en:t?on:ze;return!t&&Wt(C,"iterate",r?Ki:ye),{next(){const{value:i,done:n}=l.next();return n?{value:i,done:n}:{value:h?[c(i[0]),c(i[1])]:c(i),done:n}},[Symbol.iterator](){return this}}}}function ce(a){return function(...t){return a==="delete"?!1:this}}function Co(){const a={get(C){return gi(this,C)},get size(){return mi(this)},has:pi,add:ar,set:lr,delete:cr,clear:hr,forEach:vi(!1,!1)},t={get(C){return gi(this,C,!1,!0)},get size(){return mi(this)},has:pi,add:ar,set:lr,delete:cr,clear:hr,forEach:vi(!1,!0)},g={get(C){return gi(this,C,!0)},get size(){return mi(this,!0)},has(C){return pi.call(this,C,!0)},add:ce("add"),set:ce("set"),delete:ce("delete"),clear:ce("clear"),forEach:vi(!0,!1)},v={get(C){return gi(this,C,!0,!0)},get size(){return mi(this,!0)},has(C){return pi.call(this,C,!0)},add:ce("add"),set:ce("set"),delete:ce("delete"),clear:ce("clear"),forEach:vi(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(C=>{a[C]=_i(C,!1,!1),g[C]=_i(C,!0,!1),t[C]=_i(C,!1,!0),v[C]=_i(C,!0,!0)}),[a,g,t,v]}const[bo,xo,So,wo]=Co();function nn(a,t){const g=t?a?wo:So:a?xo:bo;return(v,_,C)=>_==="__v_isReactive"?!a:_==="__v_isReadonly"?a:_==="__v_raw"?v:Reflect.get(Ct(g,_)&&_ in v?g:v,_,C)}const To={get:nn(!1,!1)},Oo={get:nn(!1,!0)},Po={get:nn(!0,!1)},ur=new WeakMap,fr=new WeakMap,dr=new WeakMap,Eo=new WeakMap;function ko(a){switch(a){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ao(a){return a.__v_skip||!Object.isExtensible(a)?0:ko(Js(a))}function yi(a){return a&&a.__v_isReadonly?a:sn(a,!1,or,To,ur)}function Do(a){return sn(a,!1,yo,Oo,fr)}function rn(a){return sn(a,!0,_o,Po,dr)}function sn(a,t,g,v,_){if(!Tt(a)||a.__v_raw&&!(t&&a.__v_isReactive))return a;const C=_.get(a);if(C)return C;const w=Ao(a);if(w===0)return a;const h=new Proxy(a,w===2?v:g);return _.set(a,h),h}function Fe(a){return gr(a)?Fe(a.__v_raw):!!(a&&a.__v_isReactive)}function gr(a){return!!(a&&a.__v_isReadonly)}function pr(a){return Fe(a)||gr(a)}function bt(a){const t=a&&a.__v_raw;return t?bt(t):a}function Ue(a){return ui(a,"__v_skip",!0),a}const ze=a=>Tt(a)?yi(a):a,on=a=>Tt(a)?rn(a):a;function mr(a){er()&&(a=bt(a),a.dep||(a.dep=Vi()),ir(a.dep))}function vr(a,t){a=bt(a),a.dep&&Zi(a.dep)}function Dt(a){return Boolean(a&&a.__v_isRef===!0)}function he(a){return _r(a,!1)}function Mo(a){return _r(a,!0)}function _r(a,t){return Dt(a)?a:new Fo(a,t)}class Fo{constructor(t,g){this._shallow=g,this.dep=void 0,this.__v_isRef=!0,this._rawValue=g?t:bt(t),this._value=g?t:ze(t)}get value(){return mr(this),this._value}set value(t){t=this._shallow?t:bt(t),Ye(t,this._rawValue)&&(this._rawValue=t,this._value=this._shallow?t:ze(t),vr(this))}}function ht(a){return Dt(a)?a.value:a}const Lo={get:(a,t,g)=>ht(Reflect.get(a,t,g)),set:(a,t,g,v)=>{const _=a[t];return Dt(_)&&!Dt(g)?(_.value=g,!0):Reflect.set(a,t,g,v)}};function yr(a){return Fe(a)?a:new Proxy(a,Lo)}function Cr(a){const t=gt(a)?new Array(a.length):{};for(const g in a)t[g]=Ro(a,g);return t}class Io{constructor(t,g){this._object=t,this._key=g,this.__v_isRef=!0}get value(){return this._object[this._key]}set value(t){this._object[this._key]=t}}function Ro(a,t){const g=a[t];return Dt(g)?g:new Io(a,t)}class jo{constructor(t,g,v){this._setter=g,this.dep=void 0,this._dirty=!0,this.__v_isRef=!0,this.effect=new Ji(t,()=>{this._dirty||(this._dirty=!0,vr(this))}),this.__v_isReadonly=v}get value(){const t=bt(this);return mr(t),t._dirty&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function xt(a,t){let g,v;const _=vt(a);return _?(g=a,v=Vt):(g=a.get,v=a.set),new jo(g,v,_||!v)}Promise.resolve();function Bo(a,t,...g){const v=a.vnode.props||St;let _=g;const C=t.startsWith("update:"),w=C&&t.slice(7);if(w&&w in v){const c=`${w==="modelValue"?"model":w}Modifiers`,{number:i,trim:n}=v[c]||St;n?_=g.map(e=>e.trim()):i&&(_=g.map(to))}let h,r=v[h=zi(t)]||v[h=zi(Zt(t))];!r&&C&&(r=v[h=zi(Ae(t))]),r&&Kt(r,a,6,_);const l=v[h+"Once"];if(l){if(!a.emitted)a.emitted={};else if(a.emitted[h])return;a.emitted[h]=!0,Kt(l,a,6,_)}}function br(a,t,g=!1){const v=t.emitsCache,_=v.get(a);if(_!==void 0)return _;const C=a.emits;let w={},h=!1;if(!vt(a)){const r=l=>{const c=br(l,t,!0);c&&(h=!0,It(w,c))};!g&&t.mixins.length&&t.mixins.forEach(r),a.extends&&r(a.extends),a.mixins&&a.mixins.forEach(r)}return!C&&!h?(v.set(a,null),null):(gt(C)?C.forEach(r=>w[r]=null):It(w,C),v.set(a,w),w)}function an(a,t){return!a||!Xe(t)?!1:(t=t.slice(2).replace(/Once$/,""),Ct(a,t[0].toLowerCase()+t.slice(1))||Ct(a,Ae(t))||Ct(a,t))}let $t=null,Ci=null;function bi(a){const t=$t;return $t=a,Ci=a&&a.type.__scopeId||null,t}function xr(a){Ci=a}function Sr(){Ci=null}function ie(a,t=$t,g){if(!t||a._n)return a;const v=(..._)=>{v._d&&zr(-1);const C=bi(t),w=a(..._);return bi(C),v._d&&zr(1),w};return v._n=!0,v._c=!0,v._d=!0,v}function ln(a){const{type:t,vnode:g,proxy:v,withProxy:_,props:C,propsOptions:[w],slots:h,attrs:r,emit:l,render:c,renderCache:i,data:n,setupState:e,ctx:o,inheritAttrs:u}=a;let s,f;const d=bi(a);try{if(g.shapeFlag&4){const m=_||v;s=qt(c.call(m,m,i,C,e,n,o)),f=r}else{const m=t;s=qt(m.length>1?m(C,{attrs:r,slots:h,emit:l}):m(C,null)),f=t.props?r:Xo(r)}}catch(m){Ke.length=0,ei(m,a,1),s=pt(re)}let p=s;if(f&&u!==!1){const m=Object.keys(f),{shapeFlag:y}=p;m.length&&y&(1|6)&&(w&&m.some(Hi)&&(f=Wo(f,w)),p=Qe(p,f))}return g.dirs&&(p.dirs=p.dirs?p.dirs.concat(g.dirs):g.dirs),g.transition&&(p.transition=g.transition),s=p,bi(d),s}const Xo=a=>{let t;for(const g in a)(g==="class"||g==="style"||Xe(g))&&((t||(t={}))[g]=a[g]);return t},Wo=(a,t)=>{const g={};for(const v in a)(!Hi(v)||!(v.slice(9)in t))&&(g[v]=a[v]);return g};function Yo(a,t,g){const{props:v,children:_,component:C}=a,{props:w,children:h,patchFlag:r}=t,l=C.emitsOptions;if(t.dirs||t.transition)return!0;if(g&&r>=0){if(r&1024)return!0;if(r&16)return v?wr(v,w,l):!!w;if(r&8){const c=t.dynamicProps;for(let i=0;i<c.length;i++){const n=c[i];if(w[n]!==v[n]&&!an(l,n))return!0}}}else return(_||h)&&(!h||!h.$stable)?!0:v===w?!1:v?w?wr(v,w,l):!0:!!w;return!1}function wr(a,t,g){const v=Object.keys(t);if(v.length!==Object.keys(a).length)return!0;for(let _=0;_<v.length;_++){const C=v[_];if(t[C]!==a[C]&&!an(g,C))return!0}return!1}function Ho({vnode:a,parent:t},g){for(;t&&t.subTree===a;)(a=t.vnode).el=g,t=t.parent}const No=a=>a.__isSuspense;function Tr(a,t){t&&t.pendingBranch?gt(a)?t.effects.push(...a):t.effects.push(a):Ba(a)}function Uo(a,t){if(kt){let g=kt.provides;const v=kt.parent&&kt.parent.provides;v===g&&(g=kt.provides=Object.create(v)),g[a]=t}}function Ge(a,t,g=!1){const v=kt||$t;if(v){const _=v.parent==null?v.vnode.appContext&&v.vnode.appContext.provides:v.parent.provides;if(_&&a in _)return _[a];if(arguments.length>1)return g&&vt(t)?t.call(v.proxy):t}}function Pt(a){return vt(a)?{setup:a,name:a.name}:a}const xi=a=>!!a.type.__asyncLoader;function zo(a){vt(a)&&(a={loader:a});const{loader:t,loadingComponent:g,errorComponent:v,delay:_=200,timeout:C,suspensible:w=!0,onError:h}=a;let r=null,l,c=0;const i=()=>(c++,r=null,n()),n=()=>{let e;return r||(e=r=t().catch(o=>{if(o=o instanceof Error?o:new Error(String(o)),h)return new Promise((u,s)=>{h(o,()=>u(i()),()=>s(o),c+1)});throw o}).then(o=>e!==r&&r?r:(o&&(o.__esModule||o[Symbol.toStringTag]==="Module")&&(o=o.default),l=o,o)))};return Pt({name:"AsyncComponentWrapper",__asyncLoader:n,get __asyncResolved(){return l},setup(){const e=kt;if(l)return()=>cn(l,e);const o=d=>{r=null,ei(d,e,13,!v)};if(w&&e.suspense||ti)return n().then(d=>()=>cn(d,e)).catch(d=>(o(d),()=>v?pt(v,{error:d}):null));const u=he(!1),s=he(),f=he(!!_);return _&&setTimeout(()=>{f.value=!1},_),C!=null&&setTimeout(()=>{if(!u.value&&!s.value){const d=new Error(`Async component timed out after ${C}ms.`);o(d),s.value=d}},C),n().then(()=>{u.value=!0,e.parent&&hn(e.parent.vnode)&&Tn(e.parent.update)}).catch(d=>{o(d),s.value=d}),()=>{if(u.value&&l)return cn(l,e);if(s.value&&v)return pt(v,{error:s.value});if(g&&!f.value)return pt(g)}}})}function cn(a,{vnode:{ref:t,props:g,children:v}}){const _=pt(a,g,v);return _.ref=t,_}const hn=a=>a.type.__isKeepAlive;function Go(a,t){Or(a,"a",t)}function Vo(a,t){Or(a,"da",t)}function Or(a,t,g=kt){const v=a.__wdc||(a.__wdc=()=>{let _=g;for(;_;){if(_.isDeactivated)return;_=_.parent}a()});if(Si(t,v,g),g){let _=g.parent;for(;_&&_.parent;)hn(_.parent.vnode)&&$o(v,t,g,_),_=_.parent}}function $o(a,t,g,v){const _=Si(t,a,v,!0);Ve(()=>{Gn(v[t],_)},g)}function Si(a,t,g=kt,v=!1){if(g){const _=g[a]||(g[a]=[]),C=t.__weh||(t.__weh=(...w)=>{if(g.isUnmounted)return;Me(),Le(g);const h=Kt(t,g,a,w);return we(),Ce(),h});return v?_.unshift(C):_.push(C),C}}const ne=a=>(t,g=kt)=>(!ti||a==="sp")&&Si(a,t,g),qo=ne("bm"),be=ne("m"),Ko=ne("bu"),Pr=ne("u"),Jo=ne("bum"),Ve=ne("um"),Qo=ne("sp"),Zo=ne("rtg"),ta=ne("rtc");function ea(a,t=kt){Si("ec",a,t)}let un=!0;function ia(a){const t=Ar(a),g=a.proxy,v=a.ctx;un=!1,t.beforeCreate&&Er(t.beforeCreate,a,"bc");const{data:_,computed:C,methods:w,watch:h,provide:r,inject:l,created:c,beforeMount:i,mounted:n,beforeUpdate:e,updated:o,activated:u,deactivated:s,beforeDestroy:f,beforeUnmount:d,destroyed:p,unmounted:m,render:y,renderTracked:S,renderTriggered:O,errorCaptured:R,serverPrefetch:Y,expose:q,inheritAttrs:tt,components:Z,directives:it,filters:et}=t;if(l&&na(l,v,null,a.appContext.config.unwrapInjectedRef),w)for(const st in w){const nt=w[st];vt(nt)&&(v[st]=nt.bind(g))}if(_){const st=_.call(g,g);Tt(st)&&(a.data=yi(st))}if(un=!0,C)for(const st in C){const nt=C[st],D=vt(nt)?nt.bind(g,g):vt(nt.get)?nt.get.bind(g,g):Vt,G=!vt(nt)&&vt(nt.set)?nt.set.bind(g):Vt,F=xt({get:D,set:G});Object.defineProperty(v,st,{enumerable:!0,configurable:!0,get:()=>F.value,set:j=>F.value=j})}if(h)for(const st in h)kr(h[st],v,g,st);if(r){const st=vt(r)?r.call(g):r;Reflect.ownKeys(st).forEach(nt=>{Uo(nt,st[nt])})}c&&Er(c,a,"c");function at(st,nt){gt(nt)?nt.forEach(D=>st(D.bind(g))):nt&&st(nt.bind(g))}if(at(qo,i),at(be,n),at(Ko,e),at(Pr,o),at(Go,u),at(Vo,s),at(ea,R),at(ta,S),at(Zo,O),at(Jo,d),at(Ve,m),at(Qo,Y),gt(q))if(q.length){const st=a.exposed||(a.exposed={});q.forEach(nt=>{Object.defineProperty(st,nt,{get:()=>g[nt],set:D=>g[nt]=D})})}else a.exposed||(a.exposed={});y&&a.render===Vt&&(a.render=y),tt!=null&&(a.inheritAttrs=tt),Z&&(a.components=Z),it&&(a.directives=it)}function na(a,t,g=Vt,v=!1){gt(a)&&(a=fn(a));for(const _ in a){const C=a[_];let w;Tt(C)?"default"in C?w=Ge(C.from||_,C.default,!0):w=Ge(C.from||_):w=Ge(C),Dt(w)&&v?Object.defineProperty(t,_,{enumerable:!0,configurable:!0,get:()=>w.value,set:h=>w.value=h}):t[_]=w}}function Er(a,t,g){Kt(gt(a)?a.map(v=>v.bind(t.proxy)):a.bind(t.proxy),t,g)}function kr(a,t,g,v){const _=v.includes(".")?ss(g,v):()=>g[v];if(At(a)){const C=t[a];vt(C)&&Te(_,C)}else if(vt(a))Te(_,a.bind(g));else if(Tt(a))if(gt(a))a.forEach(C=>kr(C,t,g,v));else{const C=vt(a.handler)?a.handler.bind(g):t[a.handler];vt(C)&&Te(_,C,a)}}function Ar(a){const t=a.type,{mixins:g,extends:v}=t,{mixins:_,optionsCache:C,config:{optionMergeStrategies:w}}=a.appContext,h=C.get(t);let r;return h?r=h:!_.length&&!g&&!v?r=t:(r={},_.length&&_.forEach(l=>wi(r,l,w,!0)),wi(r,t,w)),C.set(t,r),r}function wi(a,t,g,v=!1){const{mixins:_,extends:C}=t;C&&wi(a,C,g,!0),_&&_.forEach(w=>wi(a,w,g,!0));for(const w in t)if(!(v&&w==="expose")){const h=ra[w]||g&&g[w];a[w]=h?h(a[w],t[w]):t[w]}return a}const ra={data:Dr,props:xe,emits:xe,methods:xe,computed:xe,beforeCreate:Rt,created:Rt,beforeMount:Rt,mounted:Rt,beforeUpdate:Rt,updated:Rt,beforeDestroy:Rt,beforeUnmount:Rt,destroyed:Rt,unmounted:Rt,activated:Rt,deactivated:Rt,errorCaptured:Rt,serverPrefetch:Rt,components:xe,directives:xe,watch:oa,provide:Dr,inject:sa};function Dr(a,t){return t?a?function(){return It(vt(a)?a.call(this,this):a,vt(t)?t.call(this,this):t)}:t:a}function sa(a,t){return xe(fn(a),fn(t))}function fn(a){if(gt(a)){const t={};for(let g=0;g<a.length;g++)t[a[g]]=a[g];return t}return a}function Rt(a,t){return a?[...new Set([].concat(a,t))]:t}function xe(a,t){return a?It(It(Object.create(null),a),t):t}function oa(a,t){if(!a)return t;if(!t)return a;const g=It(Object.create(null),a);for(const v in t)g[v]=Rt(a[v],t[v]);return g}function aa(a,t,g,v=!1){const _={},C={};ui(C,ki,1),a.propsDefaults=Object.create(null),Mr(a,t,_,C);for(const w in a.propsOptions[0])w in _||(_[w]=void 0);g?a.props=v?_:Do(_):a.type.props?a.props=_:a.props=C,a.attrs=C}function la(a,t,g,v){const{props:_,attrs:C,vnode:{patchFlag:w}}=a,h=bt(_),[r]=a.propsOptions;let l=!1;if((v||w>0)&&!(w&16)){if(w&8){const c=a.vnode.dynamicProps;for(let i=0;i<c.length;i++){let n=c[i];const e=t[n];if(r)if(Ct(C,n))e!==C[n]&&(C[n]=e,l=!0);else{const o=Zt(n);_[o]=dn(r,h,o,e,a,!1)}else e!==C[n]&&(C[n]=e,l=!0)}}}else{Mr(a,t,_,C)&&(l=!0);let c;for(const i in h)(!t||!Ct(t,i)&&((c=Ae(i))===i||!Ct(t,c)))&&(r?g&&(g[i]!==void 0||g[c]!==void 0)&&(_[i]=dn(r,h,i,void 0,a,!0)):delete _[i]);if(C!==h)for(const i in C)(!t||!Ct(t,i))&&(delete C[i],l=!0)}l&&ee(a,"set","$attrs")}function Mr(a,t,g,v){const[_,C]=a.propsOptions;let w=!1,h;if(t)for(let r in t){if(We(r))continue;const l=t[r];let c;_&&Ct(_,c=Zt(r))?!C||!C.includes(c)?g[c]=l:(h||(h={}))[c]=l:an(a.emitsOptions,r)||l!==v[r]&&(v[r]=l,w=!0)}if(C){const r=bt(g),l=h||St;for(let c=0;c<C.length;c++){const i=C[c];g[i]=dn(_,r,i,l[i],a,!Ct(l,i))}}return w}function dn(a,t,g,v,_,C){const w=a[g];if(w!=null){const h=Ct(w,"default");if(h&&v===void 0){const r=w.default;if(w.type!==Function&&vt(r)){const{propsDefaults:l}=_;g in l?v=l[g]:(Le(_),v=l[g]=r.call(null,t),we())}else v=r}w[0]&&(C&&!h?v=!1:w[1]&&(v===""||v===Ae(g))&&(v=!0))}return v}function Fr(a,t,g=!1){const v=t.propsCache,_=v.get(a);if(_)return _;const C=a.props,w={},h=[];let r=!1;if(!vt(a)){const c=i=>{r=!0;const[n,e]=Fr(i,t,!0);It(w,n),e&&h.push(...e)};!g&&t.mixins.length&&t.mixins.forEach(c),a.extends&&c(a.extends),a.mixins&&a.mixins.forEach(c)}if(!C&&!r)return v.set(a,Ee),Ee;if(gt(C))for(let c=0;c<C.length;c++){const i=Zt(C[c]);Lr(i)&&(w[i]=St)}else if(C)for(const c in C){const i=Zt(c);if(Lr(i)){const n=C[c],e=w[i]=gt(n)||vt(n)?{type:n}:n;if(e){const o=jr(Boolean,e.type),u=jr(String,e.type);e[0]=o>-1,e[1]=u<0||o<u,(o>-1||Ct(e,"default"))&&h.push(i)}}}const l=[w,h];return v.set(a,l),l}function Lr(a){return a[0]!=="$"}function Ir(a){const t=a&&a.toString().match(/^\s*function (\w+)/);return t?t[1]:a===null?"null":""}function Rr(a,t){return Ir(a)===Ir(t)}function jr(a,t){return gt(t)?t.findIndex(g=>Rr(g,a)):vt(t)&&Rr(t,a)?0:-1}const Br=a=>a[0]==="_"||a==="$stable",gn=a=>gt(a)?a.map(qt):[qt(a)],ca=(a,t,g)=>{const v=ie((..._)=>gn(t(..._)),g);return v._c=!1,v},Xr=(a,t,g)=>{const v=a._ctx;for(const _ in a){if(Br(_))continue;const C=a[_];if(vt(C))t[_]=ca(_,C,v);else if(C!=null){const w=gn(C);t[_]=()=>w}}},Wr=(a,t)=>{const g=gn(t);a.slots.default=()=>g},ha=(a,t)=>{if(a.vnode.shapeFlag&32){const g=t._;g?(a.slots=bt(t),ui(t,"_",g)):Xr(t,a.slots={})}else a.slots={},t&&Wr(a,t);ui(a.slots,ki,1)},ua=(a,t,g)=>{const{vnode:v,slots:_}=a;let C=!0,w=St;if(v.shapeFlag&32){const h=t._;h?g&&h===1?C=!1:(It(_,t),!g&&h===1&&delete _._):(C=!t.$stable,Xr(t,_)),w=t}else t&&(Wr(a,t),w={default:1});if(C)for(const h in _)!Br(h)&&!(h in w)&&delete _[h]};function te(a,t,g,v){const _=a.dirs,C=t&&t.dirs;for(let w=0;w<_.length;w++){const h=_[w];C&&(h.oldValue=C[w].value);let r=h.dir[v];r&&(Me(),Kt(r,g,8,[a.el,h,a,t]),Ce())}}function Yr(){return{app:null,config:{isNativeTag:$s,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let fa=0;function da(a,t){return function(v,_=null){_!=null&&!Tt(_)&&(_=null);const C=Yr(),w=new Set;let h=!1;const r=C.app={_uid:fa++,_component:v,_props:_,_container:null,_context:C,_instance:null,version:Ya,get config(){return C.config},set config(l){},use(l,...c){return w.has(l)||(l&&vt(l.install)?(w.add(l),l.install(r,...c)):vt(l)&&(w.add(l),l(r,...c))),r},mixin(l){return C.mixins.includes(l)||C.mixins.push(l),r},component(l,c){return c?(C.components[l]=c,r):C.components[l]},directive(l,c){return c?(C.directives[l]=c,r):C.directives[l]},mount(l,c,i){if(!h){const n=pt(v,_);return n.appContext=C,c&&t?t(n,l):a(n,l,i),h=!0,r._container=l,l.__vue_app__=r,bn(n.component)||n.component.proxy}},unmount(){h&&(a(null,r._container),delete r._container.__vue_app__)},provide(l,c){return C.provides[l]=c,r}};return r}}let ue=!1;const Ti=a=>/svg/.test(a.namespaceURI)&&a.tagName!=="foreignObject",pn=a=>a.nodeType===8;function ga(a){const{mt:t,p:g,o:{patchProp:v,nextSibling:_,parentNode:C,remove:w,insert:h,createComment:r}}=a,l=(s,f)=>{if(!f.hasChildNodes()){g(null,s,f),Fi();return}ue=!1,c(f.firstChild,s,null,null,null),Fi(),ue&&console.error("Hydration completed but contains mismatches.")},c=(s,f,d,p,m,y=!1)=>{const S=pn(s)&&s.data==="[",O=()=>o(s,f,d,p,m,S),{type:R,ref:Y,shapeFlag:q}=f,tt=s.nodeType;f.el=s;let Z=null;switch(R){case $e:tt!==3?Z=O():(s.data!==f.children&&(ue=!0,s.data=f.children),Z=_(s));break;case re:tt!==8||S?Z=O():Z=_(s);break;case qe:if(tt!==1)Z=O();else{Z=s;const it=!f.children.length;for(let et=0;et<f.staticCount;et++)it&&(f.children+=Z.outerHTML),et===f.staticCount-1&&(f.anchor=Z),Z=_(Z);return Z}break;case Et:S?Z=e(s,f,d,p,m,y):Z=O();break;default:if(q&1)tt!==1||f.type.toLowerCase()!==s.tagName.toLowerCase()?Z=O():Z=i(s,f,d,p,m,y);else if(q&6){f.slotScopeIds=m;const it=C(s);if(t(f,it,null,d,p,Ti(it),y),Z=S?u(s):_(s),xi(f)){let et;S?(et=pt(Et),et.anchor=Z?Z.previousSibling:it.lastChild):et=s.nodeType===3?Ze(""):pt("div"),et.el=s,f.component.subTree=et}}else q&64?tt!==8?Z=O():Z=f.type.hydrate(s,f,d,p,m,y,a,n):q&128&&(Z=f.type.hydrate(s,f,d,p,Ti(C(s)),m,y,a,c))}return Y!=null&&Oi(Y,null,p,f),Z},i=(s,f,d,p,m,y)=>{y=y||!!f.dynamicChildren;const{type:S,props:O,patchFlag:R,shapeFlag:Y,dirs:q}=f,tt=S==="input"&&q||S==="option";if(tt||R!==-1){if(q&&te(f,null,d,"created"),O)if(tt||!y||R&(16|32))for(const it in O)(tt&&it.endsWith("value")||Xe(it)&&!We(it))&&v(s,it,null,O[it],!1,void 0,d);else O.onClick&&v(s,"onClick",null,O.onClick,!1,void 0,d);let Z;if((Z=O&&O.onVnodeBeforeMount)&&Nt(Z,d,f),q&&te(f,null,d,"beforeMount"),((Z=O&&O.onVnodeMounted)||q)&&Tr(()=>{Z&&Nt(Z,d,f),q&&te(f,null,d,"mounted")},p),Y&16&&!(O&&(O.innerHTML||O.textContent))){let it=n(s.firstChild,f,s,d,p,m,y);for(;it;){ue=!0;const et=it;it=it.nextSibling,w(et)}}else Y&8&&s.textContent!==f.children&&(ue=!0,s.textContent=f.children)}return s.nextSibling},n=(s,f,d,p,m,y,S)=>{S=S||!!f.dynamicChildren;const O=f.children,R=O.length;for(let Y=0;Y<R;Y++){const q=S?O[Y]:O[Y]=qt(O[Y]);if(s)s=c(s,q,p,m,y,S);else{if(q.type===$e&&!q.children)continue;ue=!0,g(null,q,d,null,p,m,Ti(d),y)}}return s},e=(s,f,d,p,m,y)=>{const{slotScopeIds:S}=f;S&&(m=m?m.concat(S):S);const O=C(s),R=n(_(s),f,O,d,p,m,y);return R&&pn(R)&&R.data==="]"?_(f.anchor=R):(ue=!0,h(f.anchor=r("]"),O,R),R)},o=(s,f,d,p,m,y)=>{if(ue=!0,f.el=null,y){const R=u(s);for(;;){const Y=_(s);if(Y&&Y!==R)w(Y);else break}}const S=_(s),O=C(s);return w(s),g(null,f,O,S,d,p,Ti(O),m),S},u=s=>{let f=0;for(;s;)if(s=_(s),s&&pn(s)&&(s.data==="["&&f++,s.data==="]")){if(f===0)return _(s);f--}return s};return[l,c]}const jt=Tr;function pa(a){return ma(a,ga)}function ma(a,t){const g=eo();g.__VUE__=!0;const{insert:v,remove:_,patchProp:C,createElement:w,createText:h,createComment:r,setText:l,setElementText:c,parentNode:i,nextSibling:n,setScopeId:e=Vt,cloneNode:o,insertStaticContent:u}=a,s=(b,x,E,M=null,A=null,B=null,X=!1,U=null,N=!!x.dynamicChildren)=>{if(b===x)return;b&&!Je(b,x)&&(M=z(b),W(b,A,B,!0),b=null),x.patchFlag===-2&&(N=!1,x.dynamicChildren=null);const{type:I,ref:K,shapeFlag:J}=x;switch(I){case $e:f(b,x,E,M);break;case re:d(b,x,E,M);break;case qe:b==null&&p(x,E,M,X);break;case Et:it(b,x,E,M,A,B,X,U,N);break;default:J&1?S(b,x,E,M,A,B,X,U,N):J&6?et(b,x,E,M,A,B,X,U,N):(J&64||J&128)&&I.process(b,x,E,M,A,B,X,U,N,V)}K!=null&&A&&Oi(K,b&&b.ref,B,x||b,!x)},f=(b,x,E,M)=>{if(b==null)v(x.el=h(x.children),E,M);else{const A=x.el=b.el;x.children!==b.children&&l(A,x.children)}},d=(b,x,E,M)=>{b==null?v(x.el=r(x.children||""),E,M):x.el=b.el},p=(b,x,E,M)=>{[b.el,b.anchor]=u(b.children,x,E,M)},m=({el:b,anchor:x},E,M)=>{let A;for(;b&&b!==x;)A=n(b),v(b,E,M),b=A;v(x,E,M)},y=({el:b,anchor:x})=>{let E;for(;b&&b!==x;)E=n(b),_(b),b=E;_(x)},S=(b,x,E,M,A,B,X,U,N)=>{X=X||x.type==="svg",b==null?O(x,E,M,A,B,X,U,N):q(b,x,A,B,X,U,N)},O=(b,x,E,M,A,B,X,U)=>{let N,I;const{type:K,props:J,shapeFlag:rt,transition:lt,patchFlag:ut,dirs:dt}=b;if(b.el&&o!==void 0&&ut===-1)N=b.el=o(b.el);else{if(N=b.el=w(b.type,B,J&&J.is,J),rt&8?c(N,b.children):rt&16&&Y(b.children,N,null,M,A,B&&K!=="foreignObject",X,U),dt&&te(b,null,M,"created"),J){for(const mt in J)mt!=="value"&&!We(mt)&&C(N,mt,null,J[mt],B,b.children,M,A,k);"value"in J&&C(N,"value",null,J.value),(I=J.onVnodeBeforeMount)&&Nt(I,M,b)}R(N,b,b.scopeId,X,M)}dt&&te(b,null,M,"beforeMount");const ct=(!A||A&&!A.pendingBranch)&&lt&&!lt.persisted;ct&&lt.beforeEnter(N),v(N,x,E),((I=J&&J.onVnodeMounted)||ct||dt)&&jt(()=>{I&&Nt(I,M,b),ct&&lt.enter(N),dt&&te(b,null,M,"mounted")},A)},R=(b,x,E,M,A)=>{if(E&&e(b,E),M)for(let B=0;B<M.length;B++)e(b,M[B]);if(A){let B=A.subTree;if(x===B){const X=A.vnode;R(b,X,X.scopeId,X.slotScopeIds,A.parent)}}},Y=(b,x,E,M,A,B,X,U,N=0)=>{for(let I=N;I<b.length;I++){const K=b[I]=U?fe(b[I]):qt(b[I]);s(null,K,x,E,M,A,B,X,U)}},q=(b,x,E,M,A,B,X)=>{const U=x.el=b.el;let{patchFlag:N,dynamicChildren:I,dirs:K}=x;N|=b.patchFlag&16;const J=b.props||St,rt=x.props||St;let lt;(lt=rt.onVnodeBeforeUpdate)&&Nt(lt,E,x,b),K&&te(x,b,E,"beforeUpdate");const ut=A&&x.type!=="foreignObject";if(I?tt(b.dynamicChildren,I,U,E,M,ut,B):X||D(b,x,U,null,E,M,ut,B,!1),N>0){if(N&16)Z(U,x,J,rt,E,M,A);else if(N&2&&J.class!==rt.class&&C(U,"class",null,rt.class,A),N&4&&C(U,"style",J.style,rt.style,A),N&8){const dt=x.dynamicProps;for(let ct=0;ct<dt.length;ct++){const mt=dt[ct],wt=J[mt],Xt=rt[mt];(Xt!==wt||mt==="value")&&C(U,mt,wt,Xt,A,b.children,E,M,k)}}N&1&&b.children!==x.children&&c(U,x.children)}else!X&&I==null&&Z(U,x,J,rt,E,M,A);((lt=rt.onVnodeUpdated)||K)&&jt(()=>{lt&&Nt(lt,E,x,b),K&&te(x,b,E,"updated")},M)},tt=(b,x,E,M,A,B,X)=>{for(let U=0;U<x.length;U++){const N=b[U],I=x[U],K=N.el&&(N.type===Et||!Je(N,I)||N.shapeFlag&(6|64))?i(N.el):E;s(N,I,K,null,M,A,B,X,!0)}},Z=(b,x,E,M,A,B,X)=>{if(E!==M){for(const U in M){if(We(U))continue;const N=M[U],I=E[U];N!==I&&U!=="value"&&C(b,U,I,N,X,x.children,A,B,k)}if(E!==St)for(const U in E)!We(U)&&!(U in M)&&C(b,U,E[U],null,X,x.children,A,B,k);"value"in M&&C(b,"value",E.value,M.value)}},it=(b,x,E,M,A,B,X,U,N)=>{const I=x.el=b?b.el:h(""),K=x.anchor=b?b.anchor:h("");let{patchFlag:J,dynamicChildren:rt,slotScopeIds:lt}=x;lt&&(U=U?U.concat(lt):lt),b==null?(v(I,E,M),v(K,E,M),Y(x.children,E,K,A,B,X,U,N)):J>0&&J&64&&rt&&b.dynamicChildren?(tt(b.dynamicChildren,rt,E,A,B,X,U),(x.key!=null||A&&x===A.subTree)&&Hr(b,x,!0)):D(b,x,E,K,A,B,X,U,N)},et=(b,x,E,M,A,B,X,U,N)=>{x.slotScopeIds=U,b==null?x.shapeFlag&512?A.ctx.activate(x,E,M,X,N):ot(x,E,M,A,B,X,N):at(b,x,N)},ot=(b,x,E,M,A,B,X)=>{const U=b.component=Pa(b,M,A);if(hn(b)&&(U.ctx.renderer=V),Ea(U),U.asyncDep){if(A&&A.registerDep(U,st),!b.el){const N=U.subTree=pt(re);d(null,N,x,E)}return}st(U,b,x,E,A,B,X)},at=(b,x,E)=>{const M=x.component=b.component;if(Yo(b,x,E))if(M.asyncDep&&!M.asyncResolved){nt(M,x,E);return}else M.next=x,Ra(M.update),M.update();else x.component=b.component,x.el=b.el,M.vnode=x},st=(b,x,E,M,A,B,X)=>{const U=()=>{if(b.isMounted){let{next:K,bu:J,u:rt,parent:lt,vnode:ut}=b,dt=K,ct;N.allowRecurse=!1,K?(K.el=ut.el,nt(b,K,X)):K=ut,J&&Gi(J),(ct=K.props&&K.props.onVnodeBeforeUpdate)&&Nt(ct,lt,K,ut),N.allowRecurse=!0;const mt=ln(b),wt=b.subTree;b.subTree=mt,s(wt,mt,i(wt.el),z(wt),b,A,B),K.el=mt.el,dt===null&&Ho(b,mt.el),rt&&jt(rt,A),(ct=K.props&&K.props.onVnodeUpdated)&&jt(()=>Nt(ct,lt,K,ut),A)}else{let K;const{el:J,props:rt}=x,{bm:lt,m:ut,parent:dt}=b,ct=xi(x);if(N.allowRecurse=!1,lt&&Gi(lt),!ct&&(K=rt&&rt.onVnodeBeforeMount)&&Nt(K,dt,x),N.allowRecurse=!0,J&&Q){const mt=()=>{b.subTree=ln(b),Q(J,b.subTree,b,A,null)};ct?x.type.__asyncLoader().then(()=>!b.isUnmounted&&mt()):mt()}else{const mt=b.subTree=ln(b);s(null,mt,E,M,b,A,B),x.el=mt.el}if(ut&&jt(ut,A),!ct&&(K=rt&&rt.onVnodeMounted)){const mt=x;jt(()=>Nt(K,dt,mt),A)}x.shapeFlag&256&&b.a&&jt(b.a,A),b.isMounted=!0,x=E=M=null}},N=new Ji(U,()=>Tn(b.update),b.scope),I=b.update=N.run.bind(N);I.id=b.uid,N.allowRecurse=I.allowRecurse=!0,I()},nt=(b,x,E)=>{x.component=b;const M=b.vnode.props;b.vnode=x,b.next=null,la(b,x.props,M,E),ua(b,x.children,E),Me(),On(void 0,b.update),Ce()},D=(b,x,E,M,A,B,X,U,N=!1)=>{const I=b&&b.children,K=b?b.shapeFlag:0,J=x.children,{patchFlag:rt,shapeFlag:lt}=x;if(rt>0){if(rt&128){F(I,J,E,M,A,B,X,U,N);return}else if(rt&256){G(I,J,E,M,A,B,X,U,N);return}}lt&8?(K&16&&k(I,A,B),J!==I&&c(E,J)):K&16?lt&16?F(I,J,E,M,A,B,X,U,N):k(I,A,B,!0):(K&8&&c(E,""),lt&16&&Y(J,E,M,A,B,X,U,N))},G=(b,x,E,M,A,B,X,U,N)=>{b=b||Ee,x=x||Ee;const I=b.length,K=x.length,J=Math.min(I,K);let rt;for(rt=0;rt<J;rt++){const lt=x[rt]=N?fe(x[rt]):qt(x[rt]);s(b[rt],lt,E,null,A,B,X,U,N)}I>K?k(b,A,B,!0,!1,J):Y(x,E,M,A,B,X,U,N,J)},F=(b,x,E,M,A,B,X,U,N)=>{let I=0;const K=x.length;let J=b.length-1,rt=K-1;for(;I<=J&&I<=rt;){const lt=b[I],ut=x[I]=N?fe(x[I]):qt(x[I]);if(Je(lt,ut))s(lt,ut,E,null,A,B,X,U,N);else break;I++}for(;I<=J&&I<=rt;){const lt=b[J],ut=x[rt]=N?fe(x[rt]):qt(x[rt]);if(Je(lt,ut))s(lt,ut,E,null,A,B,X,U,N);else break;J--,rt--}if(I>J){if(I<=rt){const lt=rt+1,ut=lt<K?x[lt].el:M;for(;I<=rt;)s(null,x[I]=N?fe(x[I]):qt(x[I]),E,ut,A,B,X,U,N),I++}}else if(I>rt)for(;I<=J;)W(b[I],A,B,!0),I++;else{const lt=I,ut=I,dt=new Map;for(I=ut;I<=rt;I++){const Lt=x[I]=N?fe(x[I]):qt(x[I]);Lt.key!=null&&dt.set(Lt.key,I)}let ct,mt=0;const wt=rt-ut+1;let Xt=!1,ae=0;const Bt=new Array(wt);for(I=0;I<wt;I++)Bt[I]=0;for(I=lt;I<=J;I++){const Lt=b[I];if(mt>=wt){W(Lt,A,B,!0);continue}let Jt;if(Lt.key!=null)Jt=dt.get(Lt.key);else for(ct=ut;ct<=rt;ct++)if(Bt[ct-ut]===0&&Je(Lt,x[ct])){Jt=ct;break}Jt===void 0?W(Lt,A,B,!0):(Bt[Jt-ut]=I+1,Jt>=ae?ae=Jt:Xt=!0,s(Lt,x[Jt],E,null,A,B,X,U,N),mt++)}const ai=Xt?va(Bt):Ee;for(ct=ai.length-1,I=wt-1;I>=0;I--){const Lt=ut+I,Jt=x[Lt],Yn=Lt+1<K?x[Lt+1].el:M;Bt[I]===0?s(null,Jt,E,Yn,A,B,X,U,N):Xt&&(ct<0||I!==ai[ct]?j(Jt,E,Yn,2):ct--)}}},j=(b,x,E,M,A=null)=>{const{el:B,type:X,transition:U,children:N,shapeFlag:I}=b;if(I&6){j(b.component.subTree,x,E,M);return}if(I&128){b.suspense.move(x,E,M);return}if(I&64){X.move(b,x,E,V);return}if(X===Et){v(B,x,E);for(let J=0;J<N.length;J++)j(N[J],x,E,M);v(b.anchor,x,E);return}if(X===qe){m(b,x,E);return}if(M!==2&&I&1&&U)if(M===0)U.beforeEnter(B),v(B,x,E),jt(()=>U.enter(B),A);else{const{leave:J,delayLeave:rt,afterLeave:lt}=U,ut=()=>v(B,x,E),dt=()=>{J(B,()=>{ut(),lt&&lt()})};rt?rt(B,ut,dt):dt()}else v(B,x,E)},W=(b,x,E,M=!1,A=!1)=>{const{type:B,props:X,ref:U,children:N,dynamicChildren:I,shapeFlag:K,patchFlag:J,dirs:rt}=b;if(U!=null&&Oi(U,null,E,b,!0),K&256){x.ctx.deactivate(b);return}const lt=K&1&&rt,ut=!xi(b);let dt;if(ut&&(dt=X&&X.onVnodeBeforeUnmount)&&Nt(dt,x,b),K&6)L(b.component,E,M);else{if(K&128){b.suspense.unmount(E,M);return}lt&&te(b,null,x,"beforeUnmount"),K&64?b.type.remove(b,x,E,A,V,M):I&&(B!==Et||J>0&&J&64)?k(I,x,E,!1,!0):(B===Et&&J&(128|256)||!A&&K&16)&&k(N,x,E),M&&T(b)}(ut&&(dt=X&&X.onVnodeUnmounted)||lt)&&jt(()=>{dt&&Nt(dt,x,b),lt&&te(b,null,x,"unmounted")},E)},T=b=>{const{type:x,el:E,anchor:M,transition:A}=b;if(x===Et){P(E,M);return}if(x===qe){y(b);return}const B=()=>{_(E),A&&!A.persisted&&A.afterLeave&&A.afterLeave()};if(b.shapeFlag&1&&A&&!A.persisted){const{leave:X,delayLeave:U}=A,N=()=>X(E,B);U?U(b.el,B,N):N()}else B()},P=(b,x)=>{let E;for(;b!==x;)E=n(b),_(b),b=E;_(x)},L=(b,x,E)=>{const{bum:M,scope:A,update:B,subTree:X,um:U}=b;M&&Gi(M),A.stop(),B&&(B.active=!1,W(X,b,x,E)),U&&jt(U,x),jt(()=>{b.isUnmounted=!0},x),x&&x.pendingBranch&&!x.isUnmounted&&b.asyncDep&&!b.asyncResolved&&b.suspenseId===x.pendingId&&(x.deps--,x.deps===0&&x.resolve())},k=(b,x,E,M=!1,A=!1,B=0)=>{for(let X=B;X<b.length;X++)W(b[X],x,E,M,A)},z=b=>b.shapeFlag&6?z(b.component.subTree):b.shapeFlag&128?b.suspense.next():n(b.anchor||b.el),H=(b,x,E)=>{b==null?x._vnode&&W(x._vnode,null,null,!0):s(x._vnode||null,b,x,null,null,null,E),Fi(),x._vnode=b},V={p:s,um:W,m:j,r:T,mt:ot,mc:Y,pc:D,pbc:tt,n:z,o:a};let $,Q;return t&&([$,Q]=t(V)),{render:H,hydrate:$,createApp:da(H,$)}}function Oi(a,t,g,v,_=!1){if(gt(a)){a.forEach((n,e)=>Oi(n,t&&(gt(t)?t[e]:t),g,v,_));return}if(xi(v)&&!_)return;const C=v.shapeFlag&4?bn(v.component)||v.component.proxy:v.el,w=_?null:C,{i:h,r}=a,l=t&&t.r,c=h.refs===St?h.refs={}:h.refs,i=h.setupState;if(l!=null&&l!==r&&(At(l)?(c[l]=null,Ct(i,l)&&(i[l]=null)):Dt(l)&&(l.value=null)),At(r)){const n=()=>{c[r]=w,Ct(i,r)&&(i[r]=w)};w?(n.id=-1,jt(n,g)):n()}else if(Dt(r)){const n=()=>{r.value=w};w?(n.id=-1,jt(n,g)):n()}else vt(r)&&de(r,h,12,[w,c])}function Nt(a,t,g,v=null){Kt(a,t,7,[g,v])}function Hr(a,t,g=!1){const v=a.children,_=t.children;if(gt(v)&&gt(_))for(let C=0;C<v.length;C++){const w=v[C];let h=_[C];h.shapeFlag&1&&!h.dynamicChildren&&((h.patchFlag<=0||h.patchFlag===32)&&(h=_[C]=fe(_[C]),h.el=w.el),g||Hr(w,h))}}function va(a){const t=a.slice(),g=[0];let v,_,C,w,h;const r=a.length;for(v=0;v<r;v++){const l=a[v];if(l!==0){if(_=g[g.length-1],a[_]<l){t[v]=_,g.push(v);continue}for(C=0,w=g.length-1;C<w;)h=C+w>>1,a[g[h]]<l?C=h+1:w=h;l<a[g[C]]&&(C>0&&(t[v]=g[C-1]),g[C]=v)}}for(C=g.length,w=g[C-1];C-- >0;)g[C]=w,w=t[w];return g}const _a=a=>a.__isTeleport,Nr="components";function mn(a,t){return Ca(Nr,a,!0,t)||a}const ya=Symbol();function Ca(a,t,g=!0,v=!1){const _=$t||kt;if(_){const C=_.type;if(a===Nr){const h=Ma(C);if(h&&(h===t||h===Zt(t)||h===hi(Zt(t))))return C}const w=Ur(_[a]||C[a],t)||Ur(_.appContext[a],t);return!w&&v?C:w}}function Ur(a,t){return a&&(a[t]||a[Zt(t)]||a[hi(Zt(t))])}const Et=Symbol(void 0),$e=Symbol(void 0),re=Symbol(void 0),qe=Symbol(void 0),Ke=[];let Se=null;function ft(a=!1){Ke.push(Se=a?null:[])}function ba(){Ke.pop(),Se=Ke[Ke.length-1]||null}let Pi=1;function zr(a){Pi+=a}function Gr(a){return a.dynamicChildren=Pi>0?Se||Ee:null,ba(),Pi>0&&Se&&Se.push(a),a}function yt(a,t,g,v,_,C){return Gr(_t(a,t,g,v,_,C,!0))}function Ut(a,t,g,v,_){return Gr(pt(a,t,g,v,_,!0))}function Ei(a){return a?a.__v_isVNode===!0:!1}function Je(a,t){return a.type===t.type&&a.key===t.key}const ki="__vInternal",Vr=({key:a})=>a!=null?a:null,Ai=({ref:a})=>a!=null?At(a)||Dt(a)||vt(a)?{i:$t,r:a}:a:null;function _t(a,t=null,g=null,v=0,_=null,C=a===Et?0:1,w=!1,h=!1){const r={__v_isVNode:!0,__v_skip:!0,type:a,props:t,key:t&&Vr(t),ref:t&&Ai(t),scopeId:Ci,slotScopeIds:null,children:g,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:C,patchFlag:v,dynamicProps:_,dynamicChildren:null,appContext:null};return h?(vn(r,g),C&128&&a.normalize(r)):g&&(r.shapeFlag|=At(g)?8:16),Pi>0&&!w&&Se&&(r.patchFlag>0||C&6)&&r.patchFlag!==32&&Se.push(r),r}const pt=xa;function xa(a,t=null,g=null,v=0,_=null,C=!1){if((!a||a===ya)&&(a=re),Ei(a)){const h=Qe(a,t,!0);return g&&vn(h,g),h}if(Fa(a)&&(a=a.__vccOpts),t){t=Sa(t);let{class:h,style:r}=t;h&&!At(h)&&(t.class=me(h)),Tt(r)&&(pr(r)&&!gt(r)&&(r=It({},r)),t.style=Yi(r))}const w=At(a)?1:No(a)?128:_a(a)?64:Tt(a)?4:vt(a)?2:0;return _t(a,t,g,v,_,w,C,!0)}function Sa(a){return a?pr(a)||ki in a?It({},a):a:null}function Qe(a,t,g=!1){const{props:v,ref:_,patchFlag:C,children:w}=a,h=t?_n(v||{},t):v;return{__v_isVNode:!0,__v_skip:!0,type:a.type,props:h,key:h&&Vr(h),ref:t&&t.ref?g&&_?gt(_)?_.concat(Ai(t)):[_,Ai(t)]:Ai(t):_,scopeId:a.scopeId,slotScopeIds:a.slotScopeIds,children:w,target:a.target,targetAnchor:a.targetAnchor,staticCount:a.staticCount,shapeFlag:a.shapeFlag,patchFlag:t&&a.type!==Et?C===-1?16:C|16:C,dynamicProps:a.dynamicProps,dynamicChildren:a.dynamicChildren,appContext:a.appContext,dirs:a.dirs,transition:a.transition,component:a.component,suspense:a.suspense,ssContent:a.ssContent&&Qe(a.ssContent),ssFallback:a.ssFallback&&Qe(a.ssFallback),el:a.el,anchor:a.anchor}}function Ze(a=" ",t=0){return pt($e,null,a,t)}function Zh(a,t){const g=pt(qe,null,a);return g.staticCount=t,g}function Ot(a="",t=!1){return t?(ft(),Ut(re,null,a)):pt(re,null,a)}function qt(a){return a==null||typeof a=="boolean"?pt(re):gt(a)?pt(Et,null,a.slice()):typeof a=="object"?fe(a):pt($e,null,String(a))}function fe(a){return a.el===null||a.memo?a:Qe(a)}function vn(a,t){let g=0;const{shapeFlag:v}=a;if(t==null)t=null;else if(gt(t))g=16;else if(typeof t=="object")if(v&(1|64)){const _=t.default;_&&(_._c&&(_._d=!1),vn(a,_()),_._c&&(_._d=!0));return}else{g=32;const _=t._;!_&&!(ki in t)?t._ctx=$t:_===3&&$t&&($t.slots._===1?t._=1:(t._=2,a.patchFlag|=1024))}else vt(t)?(t={default:t,_ctx:$t},g=32):(t=String(t),v&64?(g=16,t=[Ze(t)]):g=8);a.children=t,a.shapeFlag|=g}function _n(...a){const t={};for(let g=0;g<a.length;g++){const v=a[g];for(const _ in v)if(_==="class")t.class!==v.class&&(t.class=me([t.class,v.class]));else if(_==="style")t.style=Yi([t.style,v.style]);else if(Xe(_)){const C=t[_],w=v[_];C!==w&&!(gt(C)&&C.includes(w))&&(t[_]=C?[].concat(C,w):w)}else _!==""&&(t[_]=v[_])}return t}function yn(a,t,g,v){let _;const C=g&&g[v];if(gt(a)||At(a)){_=new Array(a.length);for(let w=0,h=a.length;w<h;w++)_[w]=t(a[w],w,void 0,C&&C[w])}else if(typeof a=="number"){_=new Array(a);for(let w=0;w<a;w++)_[w]=t(w+1,w,void 0,C&&C[w])}else if(Tt(a))if(a[Symbol.iterator])_=Array.from(a,(w,h)=>t(w,h,void 0,C&&C[h]));else{const w=Object.keys(a);_=new Array(w.length);for(let h=0,r=w.length;h<r;h++){const l=w[h];_[h]=t(a[l],l,h,C&&C[h])}}else _=[];return g&&(g[v]=_),_}function Mt(a,t,g={},v,_){if($t.isCE)return pt("slot",t==="default"?null:{name:t},v&&v());let C=a[t];C&&C._c&&(C._d=!1),ft();const w=C&&$r(C(g)),h=Ut(Et,{key:g.key||`_${t}`},w||(v?v():[]),w&&a._===1?64:-2);return!_&&h.scopeId&&(h.slotScopeIds=[h.scopeId+"-s"]),C&&C._c&&(C._d=!0),h}function $r(a){return a.some(t=>Ei(t)?!(t.type===re||t.type===Et&&!$r(t.children)):!0)?a:null}const Cn=a=>a?qr(a)?bn(a)||a.proxy:Cn(a.parent):null,Di=It(Object.create(null),{$:a=>a,$el:a=>a.vnode.el,$data:a=>a.data,$props:a=>a.props,$attrs:a=>a.attrs,$slots:a=>a.slots,$refs:a=>a.refs,$parent:a=>Cn(a.parent),$root:a=>Cn(a.root),$emit:a=>a.emit,$options:a=>Ar(a),$forceUpdate:a=>()=>Tn(a.update),$nextTick:a=>ts.bind(a.proxy),$watch:a=>Wa.bind(a)}),wa={get({_:a},t){const{ctx:g,setupState:v,data:_,props:C,accessCache:w,type:h,appContext:r}=a;let l;if(t[0]!=="$"){const e=w[t];if(e!==void 0)switch(e){case 0:return v[t];case 1:return _[t];case 3:return g[t];case 2:return C[t]}else{if(v!==St&&Ct(v,t))return w[t]=0,v[t];if(_!==St&&Ct(_,t))return w[t]=1,_[t];if((l=a.propsOptions[0])&&Ct(l,t))return w[t]=2,C[t];if(g!==St&&Ct(g,t))return w[t]=3,g[t];un&&(w[t]=4)}}const c=Di[t];let i,n;if(c)return t==="$attrs"&&Wt(a,"get",t),c(a);if((i=h.__cssModules)&&(i=i[t]))return i;if(g!==St&&Ct(g,t))return w[t]=3,g[t];if(n=r.config.globalProperties,Ct(n,t))return n[t]},set({_:a},t,g){const{data:v,setupState:_,ctx:C}=a;if(_!==St&&Ct(_,t))_[t]=g;else if(v!==St&&Ct(v,t))v[t]=g;else if(Ct(a.props,t))return!1;return t[0]==="$"&&t.slice(1)in a?!1:(C[t]=g,!0)},has({_:{data:a,setupState:t,accessCache:g,ctx:v,appContext:_,propsOptions:C}},w){let h;return g[w]!==void 0||a!==St&&Ct(a,w)||t!==St&&Ct(t,w)||(h=C[0])&&Ct(h,w)||Ct(v,w)||Ct(Di,w)||Ct(_.config.globalProperties,w)}},Ta=Yr();let Oa=0;function Pa(a,t,g){const v=a.type,_=(t?t.appContext:a.appContext)||Ta,C={uid:Oa++,vnode:a,type:v,parent:t,appContext:_,root:null,next:null,subTree:null,update:null,scope:new io(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(_.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Fr(v,_),emitsOptions:br(v,_),emit:null,emitted:null,propsDefaults:St,inheritAttrs:v.inheritAttrs,ctx:St,data:St,props:St,attrs:St,slots:St,refs:St,setupState:St,setupContext:null,suspense:g,suspenseId:g?g.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return C.ctx={_:C},C.root=t?t.root:C,C.emit=Bo.bind(null,C),a.ce&&a.ce(C),C}let kt=null;const Le=a=>{kt=a,a.scope.on()},we=()=>{kt&&kt.scope.off(),kt=null};function qr(a){return a.vnode.shapeFlag&4}let ti=!1;function Ea(a,t=!1){ti=t;const{props:g,children:v}=a.vnode,_=qr(a);aa(a,g,_,t),ha(a,v);const C=_?ka(a,t):void 0;return ti=!1,C}function ka(a,t){const g=a.type;a.accessCache=Object.create(null),a.proxy=Ue(new Proxy(a.ctx,wa));const{setup:v}=g;if(v){const _=a.setupContext=v.length>1?Da(a):null;Le(a),Me();const C=de(v,a,0,[a.props,_]);if(Ce(),we(),$n(C)){if(C.then(we,we),t)return C.then(w=>{Kr(a,w,t)}).catch(w=>{ei(w,a,0)});a.asyncDep=C}else Kr(a,C,t)}else Qr(a,t)}function Kr(a,t,g){vt(t)?a.type.__ssrInlineRender?a.ssrRender=t:a.render=t:Tt(t)&&(a.setupState=yr(t)),Qr(a,g)}let Jr;function Qr(a,t,g){const v=a.type;if(!a.render){if(!t&&Jr&&!v.render){const _=v.template;if(_){const{isCustomElement:C,compilerOptions:w}=a.appContext.config,{delimiters:h,compilerOptions:r}=v,l=It(It({isCustomElement:C,delimiters:h},w),r);v.render=Jr(_,l)}}a.render=v.render||Vt}Le(a),Me(),ia(a),Ce(),we()}function Aa(a){return new Proxy(a.attrs,{get(t,g){return Wt(a,"get","$attrs"),t[g]}})}function Da(a){const t=v=>{a.exposed=v||{}};let g;return{get attrs(){return g||(g=Aa(a))},slots:a.slots,emit:a.emit,expose:t}}function bn(a){if(a.exposed)return a.exposeProxy||(a.exposeProxy=new Proxy(yr(Ue(a.exposed)),{get(t,g){if(g in t)return t[g];if(g in Di)return Di[g](a)}}))}function Ma(a){return vt(a)&&a.displayName||a.name}function Fa(a){return vt(a)&&"__vccOpts"in a}function de(a,t,g,v){let _;try{_=v?a(...v):a()}catch(C){ei(C,t,g)}return _}function Kt(a,t,g,v){if(vt(a)){const C=de(a,t,g,v);return C&&$n(C)&&C.catch(w=>{ei(w,t,g)}),C}const _=[];for(let C=0;C<a.length;C++)_.push(Kt(a[C],t,g,v));return _}function ei(a,t,g,v=!0){const _=t?t.vnode:null;if(t){let C=t.parent;const w=t.proxy,h=g;for(;C;){const l=C.ec;if(l){for(let c=0;c<l.length;c++)if(l[c](a,w,h)===!1)return}C=C.parent}const r=t.appContext.config.errorHandler;if(r){de(r,null,10,[a,w,h]);return}}La(a,g,_,v)}function La(a,t,g,v=!0){console.error(a)}let Mi=!1,xn=!1;const Yt=[];let se=0;const ii=[];let ni=null,Ie=0;const ri=[];let ge=null,Re=0;const Zr=Promise.resolve();let Sn=null,wn=null;function ts(a){const t=Sn||Zr;return a?t.then(this?a.bind(this):a):t}function Ia(a){let t=se+1,g=Yt.length;for(;t<g;){const v=t+g>>>1;si(Yt[v])<a?t=v+1:g=v}return t}function Tn(a){(!Yt.length||!Yt.includes(a,Mi&&a.allowRecurse?se+1:se))&&a!==wn&&(a.id==null?Yt.push(a):Yt.splice(Ia(a.id),0,a),es())}function es(){!Mi&&!xn&&(xn=!0,Sn=Zr.then(ns))}function Ra(a){const t=Yt.indexOf(a);t>se&&Yt.splice(t,1)}function is(a,t,g,v){gt(a)?g.push(...a):(!t||!t.includes(a,a.allowRecurse?v+1:v))&&g.push(a),es()}function ja(a){is(a,ni,ii,Ie)}function Ba(a){is(a,ge,ri,Re)}function On(a,t=null){if(ii.length){for(wn=t,ni=[...new Set(ii)],ii.length=0,Ie=0;Ie<ni.length;Ie++)ni[Ie]();ni=null,Ie=0,wn=null,On(a,t)}}function Fi(a){if(ri.length){const t=[...new Set(ri)];if(ri.length=0,ge){ge.push(...t);return}for(ge=t,ge.sort((g,v)=>si(g)-si(v)),Re=0;Re<ge.length;Re++)ge[Re]();ge=null,Re=0}}const si=a=>a.id==null?1/0:a.id;function ns(a){xn=!1,Mi=!0,On(a),Yt.sort((g,v)=>si(g)-si(v));const t=Vt;try{for(se=0;se<Yt.length;se++){const g=Yt[se];g&&g.active!==!1&&de(g,null,14)}}finally{se=0,Yt.length=0,Fi(),Mi=!1,Sn=null,(Yt.length||ii.length||ri.length)&&ns(a)}}function Xa(a,t){return Pn(a,null,t)}const rs={};function Te(a,t,g){return Pn(a,t,g)}function Pn(a,t,{immediate:g,deep:v,flush:_,onTrack:C,onTrigger:w}=St){const h=kt;let r,l=!1,c=!1;if(Dt(a)?(r=()=>a.value,l=!!a._shallow):Fe(a)?(r=()=>a,v=!0):gt(a)?(c=!0,l=a.some(Fe),r=()=>a.map(f=>{if(Dt(f))return f.value;if(Fe(f))return je(f);if(vt(f))return de(f,h,2)})):vt(a)?t?r=()=>de(a,h,2):r=()=>{if(!(h&&h.isUnmounted))return i&&i(),Kt(a,h,3,[n])}:r=Vt,t&&v){const f=r;r=()=>je(f())}let i,n=f=>{i=s.onStop=()=>{de(f,h,4)}};if(ti)return n=Vt,t?g&&Kt(t,h,3,[r(),c?[]:void 0,n]):r(),Vt;let e=c?[]:rs;const o=()=>{if(!!s.active)if(t){const f=s.run();(v||l||(c?f.some((d,p)=>Ye(d,e[p])):Ye(f,e)))&&(i&&i(),Kt(t,h,3,[f,e===rs?void 0:e,n]),e=f)}else s.run()};o.allowRecurse=!!t;let u;_==="sync"?u=o:_==="post"?u=()=>jt(o,h&&h.suspense):u=()=>{!h||h.isMounted?ja(o):o()};const s=new Ji(r,u);return t?g?o():e=s.run():_==="post"?jt(s.run.bind(s),h&&h.suspense):s.run(),()=>{s.stop(),h&&h.scope&&Gn(h.scope.effects,s)}}function Wa(a,t,g){const v=this.proxy,_=At(a)?a.includes(".")?ss(v,a):()=>v[a]:a.bind(v,v);let C;vt(t)?C=t:(C=t.handler,g=t);const w=kt;Le(this);const h=Pn(_,C.bind(v),g);return w?Le(w):we(),h}function ss(a,t){const g=t.split(".");return()=>{let v=a;for(let _=0;_<g.length&&v;_++)v=v[g[_]];return v}}function je(a,t){if(!Tt(a)||a.__v_skip||(t=t||new Set,t.has(a)))return a;if(t.add(a),Dt(a))je(a.value,t);else if(gt(a))for(let g=0;g<a.length;g++)je(a[g],t);else if(Vn(a)||ke(a))a.forEach(g=>{je(g,t)});else if(Kn(a))for(const g in a)je(a[g],t);return a}function Oe(a,t,g){const v=arguments.length;return v===2?Tt(t)&&!gt(t)?Ei(t)?pt(a,null,[t]):pt(a,t):pt(a,null,t):(v>3?g=Array.prototype.slice.call(arguments,2):v===3&&Ei(g)&&(g=[g]),pt(a,t,g))}const Ya="3.2.22",Ha="http://www.w3.org/2000/svg",Be=typeof document!="undefined"?document:null,os=new Map,Na={insert:(a,t,g)=>{t.insertBefore(a,g||null)},remove:a=>{const t=a.parentNode;t&&t.removeChild(a)},createElement:(a,t,g,v)=>{const _=t?Be.createElementNS(Ha,a):Be.createElement(a,g?{is:g}:void 0);return a==="select"&&v&&v.multiple!=null&&_.setAttribute("multiple",v.multiple),_},createText:a=>Be.createTextNode(a),createComment:a=>Be.createComment(a),setText:(a,t)=>{a.nodeValue=t},setElementText:(a,t)=>{a.textContent=t},parentNode:a=>a.parentNode,nextSibling:a=>a.nextSibling,querySelector:a=>Be.querySelector(a),setScopeId(a,t){a.setAttribute(t,"")},cloneNode(a){const t=a.cloneNode(!0);return"_value"in a&&(t._value=a._value),t},insertStaticContent(a,t,g,v){const _=g?g.previousSibling:t.lastChild;let C=os.get(a);if(!C){const w=Be.createElement("template");if(w.innerHTML=v?`<svg>${a}</svg>`:a,C=w.content,v){const h=C.firstChild;for(;h.firstChild;)C.appendChild(h.firstChild);C.removeChild(h)}os.set(a,C)}return t.insertBefore(C.cloneNode(!0),g),[_?_.nextSibling:t.firstChild,g?g.previousSibling:t.lastChild]}};function Ua(a,t,g){const v=a._vtc;v&&(t=(t?[t,...v]:[...v]).join(" ")),t==null?a.removeAttribute("class"):g?a.setAttribute("class",t):a.className=t}function za(a,t,g){const v=a.style,_=At(g);if(g&&!_){for(const C in g)En(v,C,g[C]);if(t&&!At(t))for(const C in t)g[C]==null&&En(v,C,"")}else{const C=v.display;_?t!==g&&(v.cssText=g):t&&a.removeAttribute("style"),"_vod"in a&&(v.display=C)}}const as=/\s*!important$/;function En(a,t,g){if(gt(g))g.forEach(v=>En(a,t,v));else if(t.startsWith("--"))a.setProperty(t,g);else{const v=Ga(a,t);as.test(g)?a.setProperty(Ae(v),g.replace(as,""),"important"):a[v]=g}}const ls=["Webkit","Moz","ms"],kn={};function Ga(a,t){const g=kn[t];if(g)return g;let v=Zt(t);if(v!=="filter"&&v in a)return kn[t]=v;v=hi(v);for(let _=0;_<ls.length;_++){const C=ls[_]+v;if(C in a)return kn[t]=C}return t}const cs="http://www.w3.org/1999/xlink";function Va(a,t,g,v,_){if(v&&t.startsWith("xlink:"))g==null?a.removeAttributeNS(cs,t.slice(6,t.length)):a.setAttributeNS(cs,t,g);else{const C=Us(t);g==null||C&&!Un(g)?a.removeAttribute(t):a.setAttribute(t,C?"":g)}}function $a(a,t,g,v,_,C,w){if(t==="innerHTML"||t==="textContent"){v&&w(v,_,C),a[t]=g==null?"":g;return}if(t==="value"&&a.tagName!=="PROGRESS"){a._value=g;const h=g==null?"":g;a.value!==h&&(a.value=h),g==null&&a.removeAttribute(t);return}if(g===""||g==null){const h=typeof a[t];if(h==="boolean"){a[t]=Un(g);return}else if(g==null&&h==="string"){a[t]="",a.removeAttribute(t);return}else if(h==="number"){try{a[t]=0}catch{}a.removeAttribute(t);return}}try{a[t]=g}catch{}}let Li=Date.now,hs=!1;if(typeof window!="undefined"){Li()>document.createEvent("Event").timeStamp&&(Li=()=>performance.now());const a=navigator.userAgent.match(/firefox\/(\d+)/i);hs=!!(a&&Number(a[1])<=53)}let An=0;const qa=Promise.resolve(),Ka=()=>{An=0},Ja=()=>An||(qa.then(Ka),An=Li());function Qa(a,t,g,v){a.addEventListener(t,g,v)}function Za(a,t,g,v){a.removeEventListener(t,g,v)}function tl(a,t,g,v,_=null){const C=a._vei||(a._vei={}),w=C[t];if(v&&w)w.value=v;else{const[h,r]=el(t);if(v){const l=C[t]=il(v,_);Qa(a,h,l,r)}else w&&(Za(a,h,w,r),C[t]=void 0)}}const us=/(?:Once|Passive|Capture)$/;function el(a){let t;if(us.test(a)){t={};let g;for(;g=a.match(us);)a=a.slice(0,a.length-g[0].length),t[g[0].toLowerCase()]=!0}return[Ae(a.slice(2)),t]}function il(a,t){const g=v=>{const _=v.timeStamp||Li();(hs||_>=g.attached-1)&&Kt(nl(v,g.value),t,5,[v])};return g.value=a,g.attached=Ja(),g}function nl(a,t){if(gt(t)){const g=a.stopImmediatePropagation;return a.stopImmediatePropagation=()=>{g.call(a),a._stopped=!0},t.map(v=>_=>!_._stopped&&v(_))}else return t}const fs=/^on[a-z]/,rl=(a,t,g,v,_=!1,C,w,h,r)=>{t==="class"?Ua(a,v,_):t==="style"?za(a,g,v):Xe(t)?Hi(t)||tl(a,t,g,v,w):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):sl(a,t,v,_))?$a(a,t,v,C,w,h,r):(t==="true-value"?a._trueValue=v:t==="false-value"&&(a._falseValue=v),Va(a,t,v,_))};function sl(a,t,g,v){return v?!!(t==="innerHTML"||t==="textContent"||t in a&&fs.test(t)&&vt(g)):t==="spellcheck"||t==="draggable"||t==="form"||t==="list"&&a.tagName==="INPUT"||t==="type"&&a.tagName==="TEXTAREA"||fs.test(t)&&At(g)?!1:t in a}const ol=It({patchProp:rl},Na);let Dn,ds=!1;function al(){return Dn=ds?Dn:pa(ol),ds=!0,Dn}const ll=(...a)=>{const t=al().createApp(...a),{mount:g}=t;return t.mount=v=>{const _=cl(v);if(_)return g(_,!0,_ instanceof SVGElement)},t};function cl(a){return At(a)?document.querySelector(a):a}var hl='{"lang":"en-US","title":"\u5927\u5723\u7F16\u7A0B\u8DEF\u7EBF\u56FE","description":"\u5B66\u7F16\u7A0B\u7684\u6700\u4F73\u5B9E\u8DF5.","base":"/","head":[],"themeConfig":{},"locales":{},"langs":{}}';const gs=/^https?:/i,zt=typeof window!="undefined";function ul(a,t){t.sort((g,v)=>{const _=v.split("/").length-g.split("/").length;return _!==0?_:v.length-g.length});for(const g of t)if(a.startsWith(g))return g}function ps(a,t){const g=ul(t,Object.keys(a));return g?a[g]:void 0}function fl(a){const{locales:t}=a.themeConfig||{},g=a.locales;return t&&g?Object.keys(t).reduce((v,_)=>(v[_]={label:t[_].label,lang:g[_].lang},v),{}):{}}function dl(a,t){t=gl(a,t);const g=ps(a.locales||{},t),v=ps(a.themeConfig.locales||{},t);return Object.assign({},a,g,{themeConfig:Object.assign({},a.themeConfig,v,{locales:{}}),lang:(g||a).lang,locales:{},langs:fl(a)})}function gl(a,t){if(!zt)return t;const g=a.base,v=g.endsWith("/")?g.slice(0,-1):g;return t.slice(v.length)}const ms=Symbol(),Mn=Mo(pl(hl));function pl(a){return rn(JSON.parse(a))}function ml(a){const t=xt(()=>dl(Mn.value,a.path));return{site:t,theme:xt(()=>t.value.themeConfig),page:xt(()=>a.data),frontmatter:xt(()=>a.data.frontmatter),lang:xt(()=>t.value.lang),localePath:xt(()=>{const{langs:g,lang:v}=t.value,_=Object.keys(g).find(C=>g[C].lang===v);return oi(_||"/")}),title:xt(()=>a.data.title?a.data.title+" | "+t.value.title:t.value.title),description:xt(()=>a.data.description||t.value.description)}}function Gt(){const a=Ge(ms);if(!a)throw new Error("vitepress data not properly injected in app");return a}function vl(a,t){return`${a}${t}`.replace(/\/+/g,"/")}function oi(a){return gs.test(a)?a:vl(Mn.value.base,a)}function vs(a){let t=a.replace(/\.html$/,"");if(t=decodeURIComponent(t),t.endsWith("/")&&(t+="index"),zt){const g="/";t=t.slice(g.length).replace(/\//g,"_")+".md";const v=__VP_HASH_MAP__[t.toLowerCase()];t=`${g}assets/${t}.${v}.js`}else t=`./${t.slice(1).replace(/\//g,"_")}.md.js`;return t}const _s=Symbol(),ys="http://a.com",_l=()=>({path:"/",component:null,data:null});function yl(a,t){const g=yi(_l());function v(w=zt?location.href:"/"){const h=new URL(w,ys);return!h.pathname.endsWith("/")&&!h.pathname.endsWith(".html")&&(h.pathname+=".html",w=h.pathname+h.search+h.hash),zt&&(history.replaceState({scrollPosition:window.scrollY},document.title),history.pushState(null,"",w)),C(w)}let _=null;async function C(w,h=0){const r=new URL(w,ys),l=_=r.pathname;try{let c=a(l);if("then"in c&&typeof c.then=="function"&&(c=await c),_===l){_=null;const{default:i,__pageData:n}=c;if(!i)throw new Error(`Invalid route component: ${i}`);g.path=l,g.component=Ue(i),g.data=Ue(JSON.parse(n)),zt&&ts(()=>{if(r.hash&&!h){let e=null;try{e=document.querySelector(decodeURIComponent(r.hash))}catch(o){console.warn(o)}if(e){Cs(e,r.hash);return}}window.scrollTo(0,h)})}}catch(c){c.message.match(/fetch/)||console.error(c),_===l&&(_=null,g.path=l,g.component=t?Ue(t):null)}}return zt&&(window.addEventListener("click",w=>{const h=w.target.closest("a");if(h){const{href:r,protocol:l,hostname:c,pathname:i,hash:n,target:e}=h,o=window.location,u=i.match(/\.\w+$/);!w.ctrlKey&&!w.shiftKey&&!w.altKey&&!w.metaKey&&e!=="_blank"&&l===o.protocol&&c===o.hostname&&!(u&&u[0]!==".html")&&(w.preventDefault(),i===o.pathname?n&&n!==o.hash&&(history.pushState(null,"",n),window.dispatchEvent(new Event("hashchange")),Cs(h,n,h.classList.contains("header-anchor"))):v(r))}},{capture:!0}),window.addEventListener("popstate",w=>{C(location.href,w.state&&w.state.scrollPosition||0)}),window.addEventListener("hashchange",w=>{w.preventDefault()})),{route:g,go:v}}function Cl(){const a=Ge(_s);if(!a)throw new Error("useRouter() is called without provider.");return a}function pe(){return Cl().route}function Cs(a,t,g=!1){let v=null;try{v=a.classList.contains(".header-anchor")?a:document.querySelector(decodeURIComponent(t))}catch(_){console.warn(_)}if(v){const _=v.offsetTop;!g||Math.abs(_-window.scrollY)>window.innerHeight?window.scrollTo(0,_):window.scrollTo({left:0,top:_,behavior:"smooth"})}}function bl(a,t){let g=[],v=!0;const _=C=>{if(v){v=!1;return}const w=[],h=Math.min(g.length,C.length);for(let r=0;r<h;r++){let l=g[r];const[c,i,n=""]=C[r];if(l.tagName.toLocaleLowerCase()===c){for(const e in i)l.getAttribute(e)!==i[e]&&l.setAttribute(e,i[e]);for(let e=0;e<l.attributes.length;e++){const o=l.attributes[e].name;o in i||l.removeAttribute(o)}l.innerHTML!==n&&(l.innerHTML=n)}else document.head.removeChild(l),l=bs(C[r]),document.head.append(l);w.push(l)}g.slice(h).forEach(r=>document.head.removeChild(r)),C.slice(h).forEach(r=>{const l=bs(r);document.head.appendChild(l),w.push(l)}),g=w};Xa(()=>{const C=a.data,w=t.value,h=C&&C.title,r=C&&C.description,l=C&&C.frontmatter.head;document.title=(h?h+" | ":"")+w.title,document.querySelector("meta[name=description]").setAttribute("content",r||w.description),_([...l?Sl(l):[]])})}function bs([a,t,g]){const v=document.createElement(a);for(const _ in t)v.setAttribute(_,t[_]);return g&&(v.innerHTML=g),v}function xl(a){return a[0]==="meta"&&a[1]&&a[1].name==="description"}function Sl(a){return a.filter(t=>!xl(t))}const wl=Pt({name:"VitePressContent",setup(){const a=pe();return()=>Oe("div",{style:{position:"relative"}},[a.component?Oe(a.component):null])}});var Ft=(a,t)=>{const g=a.__vccOpts||a;for(const[v,_]of t)g[v]=_;return g};const Tl=/#.*$/,Ol=/(index)?\.(md|html)$/,Ii=/\/$/,Pl=/^[a-z]+:/i;function Fn(a){return Array.isArray(a)}function Ln(a){return Pl.test(a)}function El(a,t){if(t===void 0)return!1;const g=xs(`/${a.data.relativePath}`),v=xs(t);return g===v}function xs(a){return decodeURI(a).replace(Tl,"").replace(Ol,"")}function kl(a,t){const g=a.endsWith("/"),v=t.startsWith("/");return g&&v?a.slice(0,-1)+t:!g&&!v?`${a}/${t}`:a+t}function In(a){return/^\//.test(a)?a:`/${a}`}function Ss(a){return a.replace(/(index)?(\.(md|html))?$/,"")||"/"}function Al(a){return a===!1||a==="auto"||Fn(a)}function Dl(a){return a.children!==void 0}function Ml(a){return Fn(a)?a.length===0:!a}function Rn(a,t){if(Al(a))return a;t=In(t);for(const g in a)if(t.startsWith(In(g)))return a[g];return"auto"}function ws(a){return a.reduce((t,g)=>(g.link&&t.push({text:g.text,link:Ss(g.link)}),Dl(g)&&(t=[...t,...ws(g.children)]),t),[])}const Fl=["href","aria-label"],Ll=["src"],Il=Pt({setup(a){const{site:t,theme:g,localePath:v}=Gt();return(_,C)=>(ft(),yt("a",{class:"nav-bar-title",href:ht(v),"aria-label":`${ht(t).title}, back to home`},[ht(g).logo?(ft(),yt("img",{key:0,class:"logo",src:ht(oi)(ht(g).logo),alt:"Logo"},null,8,Ll)):Ot("v-if",!0),Ze(" "+Qt(ht(t).title),1)],8,Fl))}});var Rl=Ft(Il,[["__scopeId","data-v-3335baca"]]);function jl(){const{site:a,localePath:t,theme:g}=Gt();return xt(()=>{const v=a.value.langs,_=Object.keys(v);if(_.length<2)return null;const w=pe().path.replace(t.value,""),h=_.map(l=>({text:v[l].label,link:`${l}${w}`}));return{text:g.value.selectText||"Languages",items:h}})}const Bl=["GitHub","GitLab","Bitbucket"].map(a=>[a,new RegExp(a,"i")]);function Xl(){const{site:a}=Gt();return xt(()=>{const t=a.value.themeConfig,g=t.docsRepo||t.repo;if(!g)return null;const v=Wl(g);return{text:Yl(v,t.repoLabel),link:v}})}function Wl(a){return gs.test(a)?a:`https://github.com/${a}`}function Yl(a,t){if(t)return t;const g=a.match(/^https?:\/\/[^/]+/);if(!g)return"Source";const v=Bl.find(([_,C])=>C.test(g[0]));return v&&v[0]?v[0]:"Source"}function Ts(a){const t=pe(),g=Ln(a.value.link);return{props:xt(()=>{const _=Os(`/${t.data.relativePath}`);let C=!1;if(a.value.activeMatch)C=new RegExp(a.value.activeMatch).test(_);else{const w=Os(a.value.link);C=w==="/"?w===_:_.startsWith(w)}return{class:{active:C,isExternal:g},href:g?a.value.link:oi(a.value.link),target:a.value.target||(g?"_blank":null),rel:a.value.rel||(g?"noopener noreferrer":null),"aria-label":a.value.ariaLabel}}),isExternal:g}}function Os(a){return a.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\.(html|md)$/,"").replace(/\/index$/,"/")}const Hl={},Nl={class:"icon outbound",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15"},Ul=_t("path",{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"},null,-1),zl=_t("polygon",{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"},null,-1),Gl=[Ul,zl];function Vl(a,t){return ft(),yt("svg",Nl,Gl)}var jn=Ft(Hl,[["render",Vl]]);const $l={class:"nav-link"},ql=Pt({props:{item:null},setup(a){const g=Cr(a),{props:v,isExternal:_}=Ts(g.item);return(C,w)=>(ft(),yt("div",$l,[_t("a",_n({class:"item"},ht(v)),[Ze(Qt(a.item.text)+" ",1),ht(_)?(ft(),Ut(jn,{key:0})):Ot("v-if",!0)],16)]))}});var Ps=Ft(ql,[["__scopeId","data-v-167efc1e"]]);const Kl=a=>(xr("data-v-00e678af"),a=a(),Sr(),a),Jl={class:"nav-dropdown-link-item"},Ql=Kl(()=>_t("span",{class:"arrow"},null,-1)),Zl={class:"text"},tc={class:"icon"},ec=Pt({props:{item:null},setup(a){const g=Cr(a),{props:v,isExternal:_}=Ts(g.item);return(C,w)=>(ft(),yt("div",Jl,[_t("a",_n({class:"item"},ht(v)),[Ql,_t("span",Zl,Qt(a.item.text),1),_t("span",tc,[ht(_)?(ft(),Ut(jn,{key:0})):Ot("v-if",!0)])],16)]))}});var ic=Ft(ec,[["__scopeId","data-v-00e678af"]]);const nc=["aria-label"],rc={class:"button-text"},sc={class:"dialog"},oc=Pt({props:{item:null},setup(a){const t=pe(),g=he(!1);Te(()=>t.path,()=>{g.value=!1});function v(){g.value=!g.value}return(_,C)=>(ft(),yt("div",{class:me(["nav-dropdown-link",{open:g.value}])},[_t("button",{class:"button","aria-label":a.item.ariaLabel,onClick:v},[_t("span",rc,Qt(a.item.text),1),_t("span",{class:me(["button-arrow",g.value?"down":"right"])},null,2)],8,nc),_t("ul",sc,[(ft(!0),yt(Et,null,yn(a.item.items,w=>(ft(),yt("li",{key:w.text,class:"dialog-item"},[pt(ic,{item:w},null,8,["item"])]))),128))])],2))}});var Es=Ft(oc,[["__scopeId","data-v-930d3f94"]]);const ac={key:0,class:"nav-links"},lc={key:1,class:"item"},cc={key:2,class:"item"},hc=Pt({setup(a){const{theme:t}=Gt(),g=jl(),v=Xl(),_=xt(()=>t.value.nav||v.value||g.value);return(C,w)=>ht(_)?(ft(),yt("nav",ac,[ht(t).nav?(ft(!0),yt(Et,{key:0},yn(ht(t).nav,h=>(ft(),yt("div",{key:h.text,class:"item"},[h.items?(ft(),Ut(Es,{key:0,item:h},null,8,["item"])):(ft(),Ut(Ps,{key:1,item:h},null,8,["item"]))]))),128)):Ot("v-if",!0),ht(g)?(ft(),yt("div",lc,[pt(Es,{item:ht(g)},null,8,["item"])])):Ot("v-if",!0),ht(v)?(ft(),yt("div",cc,[pt(Ps,{item:ht(v)},null,8,["item"])])):Ot("v-if",!0)])):Ot("v-if",!0)}});var ks=Ft(hc,[["__scopeId","data-v-6c4f31ac"]]);const uc={emits:["toggle"]},fc=_t("svg",{class:"icon",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",role:"img",viewBox:"0 0 448 512"},[_t("path",{fill:"currentColor",d:"M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z",class:""})],-1),dc=[fc];function gc(a,t,g,v,_,C){return ft(),yt("div",{class:"sidebar-button",onClick:t[0]||(t[0]=w=>a.$emit("toggle"))},dc)}var pc=Ft(uc,[["render",gc]]);const mc=a=>(xr("data-v-426d61cc"),a=a(),Sr(),a),vc={class:"nav-bar"},_c=mc(()=>_t("div",{class:"flex-grow"},null,-1)),yc={class:"nav"},Cc=Pt({emits:["toggle"],setup(a){return(t,g)=>(ft(),yt("header",vc,[pt(pc,{onToggle:g[0]||(g[0]=v=>t.$emit("toggle"))}),pt(Rl),_c,_t("div",yc,[pt(ks)]),Mt(t.$slots,"search",{},void 0,!0)]))}});var bc=Ft(Cc,[["__scopeId","data-v-426d61cc"]]);function xc(){let a=null,t=null;const g=Pc(v,300);function v(){const w=Sc(),h=wc(w);for(let r=0;r<h.length;r++){const l=h[r],c=h[r+1],[i,n]=Oc(r,l,c);if(i){history.replaceState(null,document.title,n||" "),_(n);return}}}function _(w){if(C(t),C(a),t=document.querySelector(`.sidebar a[href="${w}"]`),!t)return;t.classList.add("active");const h=t.closest(".sidebar-links > ul > li");h&&h!==t.parentElement?(a=h.querySelector("a"),a&&a.classList.add("active")):a=null}function C(w){w&&w.classList.remove("active")}be(()=>{v(),window.addEventListener("scroll",g)}),Pr(()=>{_(decodeURIComponent(location.hash))}),Ve(()=>{window.removeEventListener("scroll",g)})}function Sc(){return[].slice.call(document.querySelectorAll(".sidebar a.sidebar-link-item"))}function wc(a){return[].slice.call(document.querySelectorAll(".header-anchor")).filter(t=>a.some(g=>g.hash===t.hash))}function Tc(){return document.querySelector(".nav-bar").offsetHeight}function As(a){const t=Tc();return a.parentElement.offsetTop-t-15}function Oc(a,t,g){const v=window.scrollY;return a===0&&v===0?[!0,null]:v<As(t)?[!1,null]:!g||v<As(g)?[!0,decodeURIComponent(t.hash)]:[!1,null]}function Pc(a,t){let g,v=!1;return()=>{g&&clearTimeout(g),v?g=setTimeout(a,t):(a(),v=!0,setTimeout(()=>{v=!1},t))}}function Ec(){const a=pe(),{site:t}=Gt();return xc(),xt(()=>{const g=a.data.headers,v=a.data.frontmatter.sidebar,_=a.data.frontmatter.sidebarDepth;if(v===!1)return[];if(v==="auto")return Ds(g,_);const C=Rn(t.value.themeConfig.sidebar,a.data.relativePath);return C===!1?[]:C==="auto"?Ds(g,_):C})}function Ds(a,t){const g=[];if(a===void 0)return[];let v;return a.forEach(({level:_,title:C,slug:w})=>{if(_-1>t)return;const h={text:C,link:`#${w}`};_===2?(v=h,g.push(h)):v&&(v.children||(v.children=[])).push(h)}),g}const Ms=a=>{const t=pe(),{site:g,frontmatter:v}=Gt(),_=a.depth||1,C=v.value.sidebarDepth||1/0,w=t.data.headers,h=a.item.text,r=kc(g.value.base,a.item.link),l=a.item.children,c=El(t,a.item.link),i=_<C?Fs(c,l,w,_+1):null;return Oe("li",{class:"sidebar-link"},[Oe(r?"a":"p",{class:{"sidebar-link-item":!0,active:c},href:r},h),i])};function kc(a,t){return t===void 0||t.startsWith("#")?t:kl(a,t)}function Fs(a,t,g,v=1){return t&&t.length>0?Oe("ul",{class:"sidebar-links"},t.map(_=>Oe(Ms,{item:_,depth:v}))):a&&g?Fs(!1,Ac(g),void 0,v):null}function Ac(a){return Ls(Dc(a))}function Dc(a){a=a.map(g=>Object.assign({},g));let t;return a.forEach(g=>{g.level===2?t=g:t&&(t.children||(t.children=[])).push(g)}),a.filter(g=>g.level===2)}function Ls(a){return a.map(t=>({text:t.title,link:`#${t.slug}`,children:t.children?Ls(t.children):void 0}))}const Mc={key:0,class:"sidebar-links"},Fc=Pt({setup(a){const t=Ec();return(g,v)=>ht(t).length>0?(ft(),yt("ul",Mc,[(ft(!0),yt(Et,null,yn(ht(t),_=>(ft(),Ut(ht(Ms),{item:_},null,8,["item"]))),256))])):Ot("v-if",!0)}});const Lc=Pt({props:{open:{type:Boolean}},setup(a){return(t,g)=>(ft(),yt("aside",{class:me(["sidebar",{open:a.open}])},[pt(ks,{class:"nav"}),Mt(t.$slots,"sidebar-top",{},void 0,!0),pt(Fc),Mt(t.$slots,"sidebar-bottom",{},void 0,!0)],2))}});var Ic=Ft(Lc,[["__scopeId","data-v-c979c3fa"]]);const Rc=/bitbucket.org/;function jc(){const{page:a,theme:t,frontmatter:g}=Gt(),v=xt(()=>{const{repo:C,docsDir:w="",docsBranch:h="master",docsRepo:r=C,editLinks:l}=t.value,c=g.value.editLink!=null?g.value.editLink:l,{relativePath:i}=a.value;return!c||!i||!C?null:Bc(C,r,w,h,i)}),_=xt(()=>t.value.editLinkText||"Edit this page");return{url:v,text:_}}function Bc(a,t,g,v,_){return Rc.test(a)?Wc(a,t,g,v,_):Xc(a,t,g,v,_)}function Xc(a,t,g,v,_){return(Ln(t)?t:`https://github.com/${t}`).replace(Ii,"")+`/edit/${v}/`+(g?g.replace(Ii,"")+"/":"")+_}function Wc(a,t,g,v,_){return(Ln(t)?t:a).replace(Ii,"")+`/src/${v}/`+(g?g.replace(Ii,"")+"/":"")+_+`?mode=edit&spa=0&at=${v}&fileviewer=file-view-default`}const Yc={class:"edit-link"},Hc=["href"],Nc=Pt({setup(a){const{url:t,text:g}=jc();return(v,_)=>(ft(),yt("div",Yc,[ht(t)?(ft(),yt("a",{key:0,class:"link",href:ht(t),target:"_blank",rel:"noopener noreferrer"},[Ze(Qt(ht(g))+" ",1),pt(jn,{class:"icon"})],8,Hc)):Ot("v-if",!0)]))}});var Uc=Ft(Nc,[["__scopeId","data-v-12d5008c"]]);const zc={key:0,class:"last-updated"},Gc={class:"prefix"},Vc={class:"datetime"},$c=Pt({setup(a){const{theme:t,page:g}=Gt(),v=xt(()=>{const w=t.value.lastUpdated;return w!==void 0&&w!==!1}),_=xt(()=>{const w=t.value.lastUpdated;return w===!0?"Last Updated":w}),C=he("");return be(()=>{C.value=new Date(g.value.lastUpdated).toLocaleString("en-US")}),(w,h)=>ht(v)?(ft(),yt("p",zc,[_t("span",Gc,Qt(ht(_))+":",1),_t("span",Vc,Qt(C.value),1)])):Ot("v-if",!0)}});var qc=Ft($c,[["__scopeId","data-v-267a3060"]]);const Kc={class:"page-footer"},Jc={class:"edit"},Qc={class:"updated"},Zc=Pt({setup(a){return(t,g)=>(ft(),yt("footer",Kc,[_t("div",Jc,[pt(Uc)]),_t("div",Qc,[pt(qc)])]))}});var th=Ft(Zc,[["__scopeId","data-v-d4d18758"]]);function eh(){const{page:a,theme:t}=Gt(),g=xt(()=>Ss(In(a.value.relativePath))),v=xt(()=>{const r=Rn(t.value.sidebar,g.value);return Fn(r)?ws(r):[]}),_=xt(()=>v.value.findIndex(r=>r.link===g.value)),C=xt(()=>{if(t.value.nextLinks!==!1&&_.value>-1&&_.value<v.value.length-1)return v.value[_.value+1]}),w=xt(()=>{if(t.value.prevLinks!==!1&&_.value>0)return v.value[_.value-1]}),h=xt(()=>!!C.value||!!w.value);return{next:C,prev:w,hasLinks:h}}const ih={},nh={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},rh=_t("path",{d:"M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"},null,-1),sh=[rh];function oh(a,t){return ft(),yt("svg",nh,sh)}var ah=Ft(ih,[["render",oh]]);const lh={},ch={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},hh=_t("path",{d:"M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"},null,-1),uh=[hh];function fh(a,t){return ft(),yt("svg",ch,uh)}var dh=Ft(lh,[["render",fh]]);const gh={key:0,class:"next-and-prev-link"},ph={class:"container"},mh={class:"prev"},vh=["href"],_h={class:"text"},yh={class:"next"},Ch=["href"],bh={class:"text"},xh=Pt({setup(a){const{hasLinks:t,prev:g,next:v}=eh();return(_,C)=>ht(t)?(ft(),yt("div",gh,[_t("div",ph,[_t("div",mh,[ht(g)?(ft(),yt("a",{key:0,class:"link",href:ht(oi)(ht(g).link)},[pt(ah,{class:"icon icon-prev"}),_t("span",_h,Qt(ht(g).text),1)],8,vh)):Ot("v-if",!0)]),_t("div",yh,[ht(v)?(ft(),yt("a",{key:0,class:"link",href:ht(oi)(ht(v).link)},[_t("span",bh,Qt(ht(v).text),1),pt(dh,{class:"icon icon-next"})],8,Ch)):Ot("v-if",!0)])])])):Ot("v-if",!0)}});var Sh=Ft(xh,[["__scopeId","data-v-7dc8ff08"]]);const wh={class:"page"},Th={class:"container"},Oh=Pt({setup(a){return(t,g)=>{const v=mn("Content");return ft(),yt("main",wh,[_t("div",Th,[Mt(t.$slots,"top",{},void 0,!0),pt(v,{class:"content"}),pt(th),pt(Sh),Mt(t.$slots,"bottom",{},void 0,!0)])])}}});var Ph=Ft(Oh,[["__scopeId","data-v-43528a8a"]]);const Eh={key:0,id:"ads-container"},kh=Pt({setup(a){const t=zo(()=>import("./Home.b300854e.js")),g=()=>null,v=g,_=g,C=g,w=pe(),{site:h,page:r,theme:l,frontmatter:c}=Gt(),i=xt(()=>!!c.value.customLayout),n=xt(()=>!!c.value.home),e=xt(()=>Object.keys(h.value.langs).length>1),o=xt(()=>{const m=l.value;return c.value.navbar===!1||m.navbar===!1?!1:h.value.title||m.logo||m.repo||m.nav}),u=he(!1),s=xt(()=>c.value.home||c.value.sidebar===!1?!1:!Ml(Rn(l.value.sidebar,w.data.relativePath))),f=m=>{u.value=typeof m=="boolean"?m:!u.value},d=f.bind(null,!1);Te(w,d);const p=xt(()=>[{"no-navbar":!o.value,"sidebar-open":u.value,"no-sidebar":!s.value}]);return(m,y)=>{const S=mn("Content"),O=mn("Debug");return ft(),yt(Et,null,[_t("div",{class:me(["theme",ht(p)])},[ht(o)?(ft(),Ut(bc,{key:0,onToggle:f},{search:ie(()=>[Mt(m.$slots,"navbar-search",{},()=>[ht(l).algolia?(ft(),Ut(ht(C),{key:0,options:ht(l).algolia,multilang:ht(e)},null,8,["options","multilang"])):Ot("v-if",!0)])]),_:3})):Ot("v-if",!0),pt(Ic,{open:u.value},{"sidebar-top":ie(()=>[Mt(m.$slots,"sidebar-top")]),"sidebar-bottom":ie(()=>[Mt(m.$slots,"sidebar-bottom")]),_:3},8,["open"]),Ot(" TODO: make this button accessible "),_t("div",{class:"sidebar-mask",onClick:y[0]||(y[0]=R=>f(!1))}),ht(i)?(ft(),Ut(S,{key:1})):ht(n)?(ft(),yt(Et,{key:2},[Ot(" A slot for customizing the entire homepage easily "),Mt(m.$slots,"home",{},()=>[pt(ht(t),null,{hero:ie(()=>[Mt(m.$slots,"home-hero")]),features:ie(()=>[Mt(m.$slots,"home-features")]),footer:ie(()=>[Mt(m.$slots,"home-footer")]),_:3})])],2112)):(ft(),Ut(Ph,{key:3},{top:ie(()=>[Mt(m.$slots,"page-top-ads",{},()=>[ht(l).carbonAds&&ht(l).carbonAds.carbon?(ft(),yt("div",Eh,[pt(ht(v),{key:"carbon"+ht(r).relativePath,code:ht(l).carbonAds.carbon,placement:ht(l).carbonAds.placement},null,8,["code","placement"])])):Ot("v-if",!0)]),Mt(m.$slots,"page-top")]),bottom:ie(()=>[Mt(m.$slots,"page-bottom"),Mt(m.$slots,"page-bottom-ads",{},()=>[ht(l).carbonAds&&ht(l).carbonAds.custom?(ft(),Ut(ht(_),{key:"custom"+ht(r).relativePath,code:ht(l).carbonAds.custom,placement:ht(l).carbonAds.placement},null,8,["code","placement"])):Ot("v-if",!0)])]),_:3}))],2),pt(O)],64)}}}),Ah={class:"theme"},Dh=_t("h1",null,"404",-1),Mh=["href"],Fh=Pt({setup(a){const{site:t}=Gt(),g=["There's nothing here.","How did we get here?","That's a Four-Oh-Four.","Looks like we've got some broken links."];function v(){return g[Math.floor(Math.random()*g.length)]}return(_,C)=>(ft(),yt("div",Ah,[Dh,_t("blockquote",null,Qt(v()),1),_t("a",{href:ht(t).base,"aria-label":"go to home"},"Take me home.",8,Mh)]))}}),Lh={Layout:kh,NotFound:Fh};function Ih(a){if(a.__esModule)return a;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(a).forEach(function(g){var v=Object.getOwnPropertyDescriptor(a,g);Object.defineProperty(t,g,v.get?v:{enumerable:!0,get:function(){return a[g]}})}),t}var Pe={},Rh={},jh=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Rh}),Bn=Ih(jh);(function(a){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var t=t||{version:"4.6.0"};if(a.fabric=t,typeof document!="undefined"&&typeof window!="undefined")document instanceof(typeof HTMLDocument!="undefined"?HTMLDocument:Document)?t.document=document:t.document=document.implementation.createHTMLDocument(""),t.window=window;else{var g=Bn,v=new g.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;t.document=v.document,t.jsdomImplForWrapper=Bn.implForWrapper,t.nodeCanvas=Bn.Canvas,t.window=v,DOMParser=t.window.DOMParser}t.isTouchSupported="ontouchstart"in t.window||"ontouchstart"in t.document||t.window&&t.window.navigator&&t.window.navigator.maxTouchPoints>0,t.isLikelyNode=typeof Buffer!="undefined"&&typeof window=="undefined",t.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],t.DPI=96,t.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",t.commaWsp="(?:\\s+,?\\s*|,\\s*)",t.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,t.reNonWord=/[ \n\.,;!\?\-]/,t.fontPaths={},t.iMatrix=[1,0,0,1,0,0],t.svgNS="http://www.w3.org/2000/svg",t.perfLimitSizeTotal=2097152,t.maxCacheSideLimit=4096,t.minCacheSideLimit=256,t.charWidthsCache={},t.textureSize=2048,t.disableStyleCopyPaste=!1,t.enableGLFiltering=!0,t.devicePixelRatio=t.window.devicePixelRatio||t.window.webkitDevicePixelRatio||t.window.mozDevicePixelRatio||1,t.browserShadowBlurConstant=1,t.arcToSegmentsCache={},t.boundsOfCurveCache={},t.cachesBoundsOfCurve=!0,t.forceGLPutImageData=!1,t.initFilterBackend=function(){if(t.enableGLFiltering&&t.isWebglSupported&&t.isWebglSupported(t.textureSize))return console.log("max texture size: "+t.maxTextureSize),new t.WebglFilterBackend({tileSize:t.textureSize});if(t.Canvas2dFilterBackend)return new t.Canvas2dFilterBackend},typeof document!="undefined"&&typeof window!="undefined"&&(window.fabric=t),function(){function h(e,o){if(!!this.__eventListeners[e]){var u=this.__eventListeners[e];o?u[u.indexOf(o)]=!1:t.util.array.fill(u,!1)}}function r(e,o){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var u in e)this.on(u,e[u]);else this.__eventListeners[e]||(this.__eventListeners[e]=[]),this.__eventListeners[e].push(o);return this}function l(e,o){var u=function(){o.apply(this,arguments),this.off(e,u)}.bind(this);this.on(e,u)}function c(e,o){if(arguments.length===1)for(var u in e)l.call(this,u,e[u]);else l.call(this,e,o);return this}function i(e,o){if(!this.__eventListeners)return this;if(arguments.length===0)for(e in this.__eventListeners)h.call(this,e);else if(arguments.length===1&&typeof arguments[0]=="object")for(var u in e)h.call(this,u,e[u]);else h.call(this,e,o);return this}function n(e,o){if(!this.__eventListeners)return this;var u=this.__eventListeners[e];if(!u)return this;for(var s=0,f=u.length;s<f;s++)u[s]&&u[s].call(this,o||{});return this.__eventListeners[e]=u.filter(function(d){return d!==!1}),this}t.Observable={fire:n,on:r,once:c,off:i}}(),t.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var h=0,r=arguments.length;h<r;h++)this._onObjectAdded(arguments[h]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(h,r,l){var c=this._objects;return l?c[r]=h:c.splice(r,0,h),this._onObjectAdded&&this._onObjectAdded(h),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var h=this._objects,r,l=!1,c=0,i=arguments.length;c<i;c++)r=h.indexOf(arguments[c]),r!==-1&&(l=!0,h.splice(r,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[c]));return this.renderOnAddRemove&&l&&this.requestRenderAll(),this},forEachObject:function(h,r){for(var l=this.getObjects(),c=0,i=l.length;c<i;c++)h.call(r,l[c],c,l);return this},getObjects:function(h){return typeof h=="undefined"?this._objects.concat():this._objects.filter(function(r){return r.type===h})},item:function(h){return this._objects[h]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(h,r){return this._objects.indexOf(h)>-1?!0:r?this._objects.some(function(l){return typeof l.contains=="function"&&l.contains(h,!0)}):!1},complexity:function(){return this._objects.reduce(function(h,r){return h+=r.complexity?r.complexity():0,h},0)}},t.CommonMethods={_setOptions:function(h){for(var r in h)this.set(r,h[r])},_initGradient:function(h,r){h&&h.colorStops&&!(h instanceof t.Gradient)&&this.set(r,new t.Gradient(h))},_initPattern:function(h,r,l){h&&h.source&&!(h instanceof t.Pattern)?this.set(r,new t.Pattern(h,l)):l&&l()},_setObject:function(h){for(var r in h)this._set(r,h[r])},set:function(h,r){return typeof h=="object"?this._setObject(h):this._set(h,r),this},_set:function(h,r){this[h]=r},toggle:function(h){var r=this.get(h);return typeof r=="boolean"&&this.set(h,!r),this},get:function(h){return this[h]}},function(h){var r=Math.sqrt,l=Math.atan2,c=Math.pow,i=Math.PI/180,n=Math.PI/2;t.util={cos:function(e){if(e===0)return 1;e<0&&(e=-e);var o=e/n;switch(o){case 1:case 3:return 0;case 2:return-1}return Math.cos(e)},sin:function(e){if(e===0)return 0;var o=e/n,u=1;switch(e<0&&(u=-1),o){case 1:return u;case 2:return 0;case 3:return-u}return Math.sin(e)},removeFromArray:function(e,o){var u=e.indexOf(o);return u!==-1&&e.splice(u,1),e},getRandomInt:function(e,o){return Math.floor(Math.random()*(o-e+1))+e},degreesToRadians:function(e){return e*i},radiansToDegrees:function(e){return e/i},rotatePoint:function(e,o,u){var s=new t.Point(e.x-o.x,e.y-o.y),f=t.util.rotateVector(s,u);return new t.Point(f.x,f.y).addEquals(o)},rotateVector:function(e,o){var u=t.util.sin(o),s=t.util.cos(o),f=e.x*s-e.y*u,d=e.x*u+e.y*s;return{x:f,y:d}},transformPoint:function(e,o,u){return u?new t.Point(o[0]*e.x+o[2]*e.y,o[1]*e.x+o[3]*e.y):new t.Point(o[0]*e.x+o[2]*e.y+o[4],o[1]*e.x+o[3]*e.y+o[5])},makeBoundingBoxFromPoints:function(e,o){if(o)for(var u=0;u<e.length;u++)e[u]=t.util.transformPoint(e[u],o);var s=[e[0].x,e[1].x,e[2].x,e[3].x],f=t.util.array.min(s),d=t.util.array.max(s),p=d-f,m=[e[0].y,e[1].y,e[2].y,e[3].y],y=t.util.array.min(m),S=t.util.array.max(m),O=S-y;return{left:f,top:y,width:p,height:O}},invertTransform:function(e){var o=1/(e[0]*e[3]-e[1]*e[2]),u=[o*e[3],-o*e[1],-o*e[2],o*e[0]],s=t.util.transformPoint({x:e[4],y:e[5]},u,!0);return u[4]=-s.x,u[5]=-s.y,u},toFixed:function(e,o){return parseFloat(Number(e).toFixed(o))},parseUnit:function(e,o){var u=/\D{0,2}$/.exec(e),s=parseFloat(e);switch(o||(o=t.Text.DEFAULT_SVG_FONT_SIZE),u[0]){case"mm":return s*t.DPI/25.4;case"cm":return s*t.DPI/2.54;case"in":return s*t.DPI;case"pt":return s*t.DPI/72;case"pc":return s*t.DPI/72*12;case"em":return s*o;default:return s}},falseFunction:function(){return!1},getKlass:function(e,o){return e=t.util.string.camelize(e.charAt(0).toUpperCase()+e.slice(1)),t.util.resolveNamespace(o)[e]},getSvgAttributes:function(e){var o=["instantiated_by_use","style","id","class"];switch(e){case"linearGradient":o=o.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":o=o.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":o=o.concat(["offset","stop-color","stop-opacity"]);break}return o},resolveNamespace:function(e){if(!e)return t;var o=e.split("."),u=o.length,s,f=h||t.window;for(s=0;s<u;++s)f=f[o[s]];return f},loadImage:function(e,o,u,s){if(!e){o&&o.call(u,e);return}var f=t.util.createImage(),d=function(){o&&o.call(u,f,!1),f=f.onload=f.onerror=null};f.onload=d,f.onerror=function(){t.log("Error loading "+f.src),o&&o.call(u,null,!0),f=f.onload=f.onerror=null},e.indexOf("data")!==0&&s!==void 0&&s!==null&&(f.crossOrigin=s),e.substring(0,14)==="data:image/svg"&&(f.onload=null,t.util.loadImageInDom(f,d)),f.src=e},loadImageInDom:function(e,o){var u=t.document.createElement("div");u.style.width=u.style.height="1px",u.style.left=u.style.top="-100%",u.style.position="absolute",u.appendChild(e),t.document.querySelector("body").appendChild(u),e.onload=function(){o(),u.parentNode.removeChild(u),u=null}},enlivenObjects:function(e,o,u,s){e=e||[];var f=[],d=0,p=e.length;function m(){++d===p&&o&&o(f.filter(function(y){return y}))}if(!p){o&&o(f);return}e.forEach(function(y,S){if(!y||!y.type){m();return}var O=t.util.getKlass(y.type,u);O.fromObject(y,function(R,Y){Y||(f[S]=R),s&&s(y,R,Y),m()})})},enlivenPatterns:function(e,o){e=e||[];function u(){++f===d&&o&&o(s)}var s=[],f=0,d=e.length;if(!d){o&&o(s);return}e.forEach(function(p,m){p&&p.source?new t.Pattern(p,function(y){s[m]=y,u()}):(s[m]=p,u())})},groupSVGElements:function(e,o,u){var s;return e&&e.length===1?e[0]:(o&&(o.width&&o.height?o.centerPoint={x:o.width/2,y:o.height/2}:(delete o.width,delete o.height)),s=new t.Group(e,o),typeof u!="undefined"&&(s.sourcePath=u),s)},populateWithProperties:function(e,o,u){if(u&&Object.prototype.toString.call(u)==="[object Array]")for(var s=0,f=u.length;s<f;s++)u[s]in e&&(o[u[s]]=e[u[s]])},drawDashedLine:function(e,o,u,s,f,d){var p=s-o,m=f-u,y=r(p*p+m*m),S=l(m,p),O=d.length,R=0,Y=!0;for(e.save(),e.translate(o,u),e.moveTo(0,0),e.rotate(S),o=0;y>o;)o+=d[R++%O],o>y&&(o=y),e[Y?"lineTo":"moveTo"](o,0),Y=!Y;e.restore()},createCanvasElement:function(){return t.document.createElement("canvas")},copyCanvasElement:function(e){var o=t.util.createCanvasElement();return o.width=e.width,o.height=e.height,o.getContext("2d").drawImage(e,0,0),o},toDataURL:function(e,o,u){return e.toDataURL("image/"+o,u)},createImage:function(){return t.document.createElement("img")},multiplyTransformMatrices:function(e,o,u){return[e[0]*o[0]+e[2]*o[1],e[1]*o[0]+e[3]*o[1],e[0]*o[2]+e[2]*o[3],e[1]*o[2]+e[3]*o[3],u?0:e[0]*o[4]+e[2]*o[5]+e[4],u?0:e[1]*o[4]+e[3]*o[5]+e[5]]},qrDecompose:function(e){var o=l(e[1],e[0]),u=c(e[0],2)+c(e[1],2),s=r(u),f=(e[0]*e[3]-e[2]*e[1])/s,d=l(e[0]*e[2]+e[1]*e[3],u);return{angle:o/i,scaleX:s,scaleY:f,skewX:d/i,skewY:0,translateX:e[4],translateY:e[5]}},calcRotateMatrix:function(e){if(!e.angle)return t.iMatrix.concat();var o=t.util.degreesToRadians(e.angle),u=t.util.cos(o),s=t.util.sin(o);return[u,s,-s,u,0,0]},calcDimensionsMatrix:function(e){var o=typeof e.scaleX=="undefined"?1:e.scaleX,u=typeof e.scaleY=="undefined"?1:e.scaleY,s=[e.flipX?-o:o,0,0,e.flipY?-u:u,0,0],f=t.util.multiplyTransformMatrices,d=t.util.degreesToRadians;return e.skewX&&(s=f(s,[1,0,Math.tan(d(e.skewX)),1],!0)),e.skewY&&(s=f(s,[1,Math.tan(d(e.skewY)),0,1],!0)),s},composeMatrix:function(e){var o=[1,0,0,1,e.translateX||0,e.translateY||0],u=t.util.multiplyTransformMatrices;return e.angle&&(o=u(o,t.util.calcRotateMatrix(e))),(e.scaleX!==1||e.scaleY!==1||e.skewX||e.skewY||e.flipX||e.flipY)&&(o=u(o,t.util.calcDimensionsMatrix(e))),o},resetObjectTransform:function(e){e.scaleX=1,e.scaleY=1,e.skewX=0,e.skewY=0,e.flipX=!1,e.flipY=!1,e.rotate(0)},saveObjectTransform:function(e){return{scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,angle:e.angle,left:e.left,flipX:e.flipX,flipY:e.flipY,top:e.top}},isTransparent:function(e,o,u,s){s>0&&(o>s?o-=s:o=0,u>s?u-=s:u=0);var f=!0,d,p,m=e.getImageData(o,u,s*2||1,s*2||1),y=m.data.length;for(d=3;d<y&&(p=m.data[d],f=p<=0,f!==!1);d+=4);return m=null,f},parsePreserveAspectRatioAttribute:function(e){var o="meet",u="Mid",s="Mid",f=e.split(" "),d;return f&&f.length&&(o=f.pop(),o!=="meet"&&o!=="slice"?(d=o,o="meet"):f.length&&(d=f.pop())),u=d!=="none"?d.slice(1,4):"none",s=d!=="none"?d.slice(5,8):"none",{meetOrSlice:o,alignX:u,alignY:s}},clearFabricFontCache:function(e){e=(e||"").toLowerCase(),e?t.charWidthsCache[e]&&delete t.charWidthsCache[e]:t.charWidthsCache={}},limitDimsByArea:function(e,o){var u=Math.sqrt(o*e),s=Math.floor(o/u);return{x:Math.floor(u),y:s}},capValue:function(e,o,u){return Math.max(e,Math.min(o,u))},findScaleToFit:function(e,o){return Math.min(o.width/e.width,o.height/e.height)},findScaleToCover:function(e,o){return Math.max(o.width/e.width,o.height/e.height)},matrixToSVG:function(e){return"matrix("+e.map(function(o){return t.util.toFixed(o,t.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(e,o){var u=t.util.invertTransform(o),s=t.util.multiplyTransformMatrices(u,e.calcOwnMatrix());t.util.applyTransformToObject(e,s)},addTransformToObject:function(e,o){t.util.applyTransformToObject(e,t.util.multiplyTransformMatrices(o,e.calcOwnMatrix()))},applyTransformToObject:function(e,o){var u=t.util.qrDecompose(o),s=new t.Point(u.translateX,u.translateY);e.flipX=!1,e.flipY=!1,e.set("scaleX",u.scaleX),e.set("scaleY",u.scaleY),e.skewX=u.skewX,e.skewY=u.skewY,e.angle=u.angle,e.setPositionByOrigin(s,"center","center")},sizeAfterTransform:function(e,o,u){var s=e/2,f=o/2,d=[{x:-s,y:-f},{x:s,y:-f},{x:-s,y:f},{x:s,y:f}],p=t.util.calcDimensionsMatrix(u),m=t.util.makeBoundingBoxFromPoints(d,p);return{x:m.width,y:m.height}}}}(a),function(){var h=Array.prototype.join,r={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},l={m:"l",M:"L"};function c(F,j,W,T,P,L,k,z,H,V,$){var Q=t.util.cos(F),b=t.util.sin(F),x=t.util.cos(j),E=t.util.sin(j),M=W*P*x-T*L*E+k,A=T*P*x+W*L*E+z,B=V+H*(-W*P*b-T*L*Q),X=$+H*(-T*P*b+W*L*Q),U=M+H*(W*P*E+T*L*x),N=A+H*(T*P*E-W*L*x);return["C",B,X,U,N,M,A]}function i(F,j,W,T,P,L,k){var z=Math.PI,H=k*z/180,V=t.util.sin(H),$=t.util.cos(H),Q=0,b=0;W=Math.abs(W),T=Math.abs(T);var x=-$*F*.5-V*j*.5,E=-$*j*.5+V*F*.5,M=W*W,A=T*T,B=E*E,X=x*x,U=M*A-M*B-A*X,N=0;if(U<0){var I=Math.sqrt(1-U/(M*A));W*=I,T*=I}else N=(P===L?-1:1)*Math.sqrt(U/(M*B+A*X));var K=N*W*E/T,J=-N*T*x/W,rt=$*K-V*J+F*.5,lt=V*K+$*J+j*.5,ut=n(1,0,(x-K)/W,(E-J)/T),dt=n((x-K)/W,(E-J)/T,(-x-K)/W,(-E-J)/T);L===0&&dt>0?dt-=2*z:L===1&&dt<0&&(dt+=2*z);for(var ct=Math.ceil(Math.abs(dt/z*2)),mt=[],wt=dt/ct,Xt=8/3*Math.sin(wt/4)*Math.sin(wt/4)/Math.sin(wt/2),ae=ut+wt,Bt=0;Bt<ct;Bt++)mt[Bt]=c(ut,ae,$,V,W,T,rt,lt,Xt,Q,b),Q=mt[Bt][5],b=mt[Bt][6],ut=ae,ae+=wt;return mt}function n(F,j,W,T){var P=Math.atan2(j,F),L=Math.atan2(T,W);return L>=P?L-P:2*Math.PI-(P-L)}function e(F,j,W,T,P,L,k,z){var H;if(t.cachesBoundsOfCurve&&(H=h.call(arguments),t.boundsOfCurveCache[H]))return t.boundsOfCurveCache[H];var V=Math.sqrt,$=Math.min,Q=Math.max,b=Math.abs,x=[],E=[[],[]],M,A,B,X,U,N,I,K;A=6*F-12*W+6*P,M=-3*F+9*W-9*P+3*k,B=3*W-3*F;for(var J=0;J<2;++J){if(J>0&&(A=6*j-12*T+6*L,M=-3*j+9*T-9*L+3*z,B=3*T-3*j),b(M)<1e-12){if(b(A)<1e-12)continue;X=-B/A,0<X&&X<1&&x.push(X);continue}I=A*A-4*B*M,!(I<0)&&(K=V(I),U=(-A+K)/(2*M),0<U&&U<1&&x.push(U),N=(-A-K)/(2*M),0<N&&N<1&&x.push(N))}for(var rt,lt,ut=x.length,dt=ut,ct;ut--;)X=x[ut],ct=1-X,rt=ct*ct*ct*F+3*ct*ct*X*W+3*ct*X*X*P+X*X*X*k,E[0][ut]=rt,lt=ct*ct*ct*j+3*ct*ct*X*T+3*ct*X*X*L+X*X*X*z,E[1][ut]=lt;E[0][dt]=F,E[1][dt]=j,E[0][dt+1]=k,E[1][dt+1]=z;var mt=[{x:$.apply(null,E[0]),y:$.apply(null,E[1])},{x:Q.apply(null,E[0]),y:Q.apply(null,E[1])}];return t.cachesBoundsOfCurve&&(t.boundsOfCurveCache[H]=mt),mt}function o(F,j,W){for(var T=W[1],P=W[2],L=W[3],k=W[4],z=W[5],H=W[6],V=W[7],$=i(H-F,V-j,T,P,k,z,L),Q=0,b=$.length;Q<b;Q++)$[Q][1]+=F,$[Q][2]+=j,$[Q][3]+=F,$[Q][4]+=j,$[Q][5]+=F,$[Q][6]+=j;return $}function u(F){var j=0,W=0,T=F.length,P=0,L=0,k,z,H,V=[],$,Q,b;for(z=0;z<T;++z){switch(H=!1,k=F[z].slice(0),k[0]){case"l":k[0]="L",k[1]+=j,k[2]+=W;case"L":j=k[1],W=k[2];break;case"h":k[1]+=j;case"H":k[0]="L",k[2]=W,j=k[1];break;case"v":k[1]+=W;case"V":k[0]="L",W=k[1],k[1]=j,k[2]=W;break;case"m":k[0]="M",k[1]+=j,k[2]+=W;case"M":j=k[1],W=k[2],P=k[1],L=k[2];break;case"c":k[0]="C",k[1]+=j,k[2]+=W,k[3]+=j,k[4]+=W,k[5]+=j,k[6]+=W;case"C":Q=k[3],b=k[4],j=k[5],W=k[6];break;case"s":k[0]="S",k[1]+=j,k[2]+=W,k[3]+=j,k[4]+=W;case"S":$==="C"?(Q=2*j-Q,b=2*W-b):(Q=j,b=W),j=k[3],W=k[4],k[0]="C",k[5]=k[3],k[6]=k[4],k[3]=k[1],k[4]=k[2],k[1]=Q,k[2]=b,Q=k[3],b=k[4];break;case"q":k[0]="Q",k[1]+=j,k[2]+=W,k[3]+=j,k[4]+=W;case"Q":Q=k[1],b=k[2],j=k[3],W=k[4];break;case"t":k[0]="T",k[1]+=j,k[2]+=W;case"T":$==="Q"?(Q=2*j-Q,b=2*W-b):(Q=j,b=W),k[0]="Q",j=k[1],W=k[2],k[1]=Q,k[2]=b,k[3]=j,k[4]=W;break;case"a":k[0]="A",k[6]+=j,k[7]+=W;case"A":H=!0,V=V.concat(o(j,W,k)),j=k[6],W=k[7];break;case"z":case"Z":j=P,W=L;break}H||V.push(k),$=k[0]}return V}function s(F,j,W,T){return Math.sqrt((W-F)*(W-F)+(T-j)*(T-j))}function f(F){return F*F*F}function d(F){return 3*F*F*(1-F)}function p(F){return 3*F*(1-F)*(1-F)}function m(F){return(1-F)*(1-F)*(1-F)}function y(F,j,W,T,P,L,k,z){return function(H){var V=f(H),$=d(H),Q=p(H),b=m(H);return{x:k*V+P*$+W*Q+F*b,y:z*V+L*$+T*Q+j*b}}}function S(F,j,W,T,P,L,k,z){return function(H){var V=1-H,$=3*V*V*(W-F)+6*V*H*(P-W)+3*H*H*(k-P),Q=3*V*V*(T-j)+6*V*H*(L-T)+3*H*H*(z-L);return Math.atan2(Q,$)}}function O(F){return F*F}function R(F){return 2*F*(1-F)}function Y(F){return(1-F)*(1-F)}function q(F,j,W,T,P,L){return function(k){var z=O(k),H=R(k),V=Y(k);return{x:P*z+W*H+F*V,y:L*z+T*H+j*V}}}function tt(F,j,W,T,P,L){return function(k){var z=1-k,H=2*z*(W-F)+2*k*(P-W),V=2*z*(T-j)+2*k*(L-T);return Math.atan2(V,H)}}function Z(F,j,W){var T={x:j,y:W},P,L=0,k;for(k=1;k<=100;k+=1)P=F(k/100),L+=s(T.x,T.y,P.x,P.y),T=P;return L}function it(F,j){for(var W=0,T=0,P=F.iterator,L={x:F.x,y:F.y},k,z,H=.01,V=F.angleFinder,$;T<j&&W<=1&&H>1e-4;)k=P(W),$=W,z=s(L.x,L.y,k.x,k.y),z+T>j?(H/=2,W-=H):(L=k,W+=H,T+=z);return k.angle=V($),k}function et(F){for(var j=0,W=F.length,T,P=0,L=0,k=0,z=0,H=[],V,$,Q,b=0;b<W;b++){switch(T=F[b],$={x:P,y:L,command:T[0]},T[0]){case"M":$.length=0,k=P=T[1],z=L=T[2];break;case"L":$.length=s(P,L,T[1],T[2]),P=T[1],L=T[2];break;case"C":V=y(P,L,T[1],T[2],T[3],T[4],T[5],T[6]),Q=S(P,L,T[1],T[2],T[3],T[4],T[5],T[6]),$.iterator=V,$.angleFinder=Q,$.length=Z(V,P,L),P=T[5],L=T[6];break;case"Q":V=q(P,L,T[1],T[2],T[3],T[4]),Q=tt(P,L,T[1],T[2],T[3],T[4]),$.iterator=V,$.angleFinder=Q,$.length=Z(V,P,L),P=T[3],L=T[4];break;case"Z":case"z":$.destX=k,$.destY=z,$.length=s(P,L,k,z),P=k,L=z;break}j+=$.length,H.push($)}return H.push({length:j,x:P,y:L}),H}function ot(F,j,W){W||(W=et(F));for(var T=0;j-W[T].length>0&&T<W.length-2;)j-=W[T].length,T++;var P=W[T],L=j/P.length,k=P.command,z=F[T],H;switch(k){case"M":return{x:P.x,y:P.y,angle:0};case"Z":case"z":return H=new t.Point(P.x,P.y).lerp(new t.Point(P.destX,P.destY),L),H.angle=Math.atan2(P.destY-P.y,P.destX-P.x),H;case"L":return H=new t.Point(P.x,P.y).lerp(new t.Point(z[1],z[2]),L),H.angle=Math.atan2(z[2]-P.y,z[1]-P.x),H;case"C":return it(P,j);case"Q":return it(P,j)}}function at(F){var j=[],W=[],T,P,L=t.rePathCommand,k="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",z="("+k+")"+t.commaWsp,H="([01])"+t.commaWsp+"?",V=z+"?"+z+"?"+z+H+H+z+"?("+k+")",$=new RegExp(V,"g"),Q,b,x;if(!F||!F.match)return j;x=F.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var E=0,M,A=x.length;E<A;E++){T=x[E],b=T.slice(1).trim(),W.length=0;var B=T.charAt(0);if(M=[B],B.toLowerCase()==="a")for(var X;X=$.exec(b);)for(var U=1;U<X.length;U++)W.push(X[U]);else for(;Q=L.exec(b);)W.push(Q[0]);for(var U=0,N=W.length;U<N;U++)P=parseFloat(W[U]),isNaN(P)||M.push(P);var I=r[B.toLowerCase()],K=l[B]||B;if(M.length-1>I)for(var J=1,rt=M.length;J<rt;J+=I)j.push([B].concat(M.slice(J,J+I))),B=K;else j.push(M)}return j}function st(F,j){var W=[],T,P=new t.Point(F[0].x,F[0].y),L=new t.Point(F[1].x,F[1].y),k=F.length,z=1,H=0,V=k>2;for(j=j||0,V&&(z=F[2].x<L.x?-1:F[2].x===L.x?0:1,H=F[2].y<L.y?-1:F[2].y===L.y?0:1),W.push(["M",P.x-z*j,P.y-H*j]),T=1;T<k;T++){if(!P.eq(L)){var $=P.midPointFrom(L);W.push(["Q",P.x,P.y,$.x,$.y])}P=F[T],T+1<F.length&&(L=F[T+1])}return V&&(z=P.x>F[T-2].x?1:P.x===F[T-2].x?0:-1,H=P.y>F[T-2].y?1:P.y===F[T-2].y?0:-1),W.push(["L",P.x+z*j,P.y+H*j]),W}function nt(F,j,W){return W&&(j=t.util.multiplyTransformMatrices(j,[1,0,0,1,-W.x,-W.y])),F.map(function(T){for(var P=T.slice(0),L={},k=1;k<T.length-1;k+=2)L.x=T[k],L.y=T[k+1],L=t.util.transformPoint(L,j),P[k]=L.x,P[k+1]=L.y;return P})}function D(F,j,W,T,P,L,k,z,H){for(var V=0,$=0,Q,b=[],x=i(z-F,H-j,W,T,L,k,P),E=0,M=x.length;E<M;E++)Q=e(V,$,x[E][1],x[E][2],x[E][3],x[E][4],x[E][5],x[E][6]),b.push({x:Q[0].x+F,y:Q[0].y+j}),b.push({x:Q[1].x+F,y:Q[1].y+j}),V=x[E][5],$=x[E][6];return b}function G(F,j,W,T){T=T.slice(0).unshift("X");var P=o(j,W,T);P.forEach(function(L){F.bezierCurveTo.apply(F,L.slice(1))})}t.util.joinPath=function(F){return F.map(function(j){return j.join(" ")}).join(" ")},t.util.parsePath=at,t.util.makePathSimpler=u,t.util.getSmoothPathFromPoints=st,t.util.getPathSegmentsInfo=et,t.util.getBoundsOfCurve=e,t.util.getPointOnPath=ot,t.util.transformPath=nt,t.util.fromArcToBeizers=o,t.util.getBoundsOfArc=D,t.util.drawArc=G}(),function(){var h=Array.prototype.slice;function r(e,o){for(var u=h.call(arguments,2),s=[],f=0,d=e.length;f<d;f++)s[f]=u.length?e[f][o].apply(e[f],u):e[f][o].call(e[f]);return s}function l(e,o){return n(e,o,function(u,s){return u>=s})}function c(e,o){return n(e,o,function(u,s){return u<s})}function i(e,o){for(var u=e.length;u--;)e[u]=o;return e}function n(e,o,u){if(!(!e||e.length===0)){var s=e.length-1,f=o?e[s][o]:e[s];if(o)for(;s--;)u(e[s][o],f)&&(f=e[s][o]);else for(;s--;)u(e[s],f)&&(f=e[s]);return f}}t.util.array={fill:i,invoke:r,min:c,max:l}}(),function(){function h(l,c,i){if(i)if(!t.isLikelyNode&&c instanceof Element)l=c;else if(c instanceof Array){l=[];for(var n=0,e=c.length;n<e;n++)l[n]=h({},c[n],i)}else if(c&&typeof c=="object")for(var o in c)o==="canvas"||o==="group"?l[o]=null:c.hasOwnProperty(o)&&(l[o]=h({},c[o],i));else l=c;else for(var o in c)l[o]=c[o];return l}function r(l,c){return h({},l,c)}t.util.object={extend:h,clone:r},t.util.object.extend(t.util,t.Observable)}(),function(){function h(n){return n.replace(/-+(.)?/g,function(e,o){return o?o.toUpperCase():""})}function r(n,e){return n.charAt(0).toUpperCase()+(e?n.slice(1):n.slice(1).toLowerCase())}function l(n){return n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(n){var e=0,o,u=[];for(e=0,o;e<n.length;e++)(o=i(n,e))!==!1&&u.push(o);return u}function i(n,e){var o=n.charCodeAt(e);if(isNaN(o))return"";if(o<55296||o>57343)return n.charAt(e);if(55296<=o&&o<=56319){if(n.length<=e+1)throw"High surrogate without following low surrogate";var u=n.charCodeAt(e+1);if(56320>u||u>57343)throw"High surrogate without following low surrogate";return n.charAt(e)+n.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";var s=n.charCodeAt(e-1);if(55296>s||s>56319)throw"Low surrogate without preceding high surrogate";return!1}t.util.string={camelize:h,capitalize:r,escapeXml:l,graphemeSplit:c}}(),function(){var h=Array.prototype.slice,r=function(){},l=function(){for(var o in{toString:1})if(o==="toString")return!1;return!0}(),c=function(o,u,s){for(var f in u)f in o.prototype&&typeof o.prototype[f]=="function"&&(u[f]+"").indexOf("callSuper")>-1?o.prototype[f]=function(d){return function(){var p=this.constructor.superclass;this.constructor.superclass=s;var m=u[d].apply(this,arguments);if(this.constructor.superclass=p,d!=="initialize")return m}}(f):o.prototype[f]=u[f],l&&(u.toString!==Object.prototype.toString&&(o.prototype.toString=u.toString),u.valueOf!==Object.prototype.valueOf&&(o.prototype.valueOf=u.valueOf))};function i(){}function n(o){for(var u=null,s=this;s.constructor.superclass;){var f=s.constructor.superclass.prototype[o];if(s[o]!==f){u=f;break}s=s.constructor.superclass.prototype}return u?arguments.length>1?u.apply(this,h.call(arguments,1)):u.call(this):console.log("tried to callSuper "+o+", method not found in prototype chain",this)}function e(){var o=null,u=h.call(arguments,0);typeof u[0]=="function"&&(o=u.shift());function s(){this.initialize.apply(this,arguments)}s.superclass=o,s.subclasses=[],o&&(i.prototype=o.prototype,s.prototype=new i,o.subclasses.push(s));for(var f=0,d=u.length;f<d;f++)c(s,u[f],o);return s.prototype.initialize||(s.prototype.initialize=r),s.prototype.constructor=s,s.prototype.callSuper=n,s}t.util.createClass=e}(),function(){var h=!!t.document.createElement("div").attachEvent,r=["touchstart","touchmove","touchend"];t.util.addListener=function(c,i,n,e){c&&c.addEventListener(i,n,h?!1:e)},t.util.removeListener=function(c,i,n,e){c&&c.removeEventListener(i,n,h?!1:e)};function l(c){var i=c.changedTouches;return i&&i[0]?i[0]:c}t.util.getPointer=function(c){var i=c.target,n=t.util.getScrollLeftTop(i),e=l(c);return{x:e.clientX+n.left,y:e.clientY+n.top}},t.util.isTouchEvent=function(c){return r.indexOf(c.type)>-1||c.pointerType==="touch"}}(),function(){function h(e,o){var u=e.style;if(!u)return e;if(typeof o=="string")return e.style.cssText+=";"+o,o.indexOf("opacity")>-1?n(e,o.match(/opacity:\s*(\d?\.?\d*)/)[1]):e;for(var s in o)if(s==="opacity")n(e,o[s]);else{var f=s==="float"||s==="cssFloat"?typeof u.styleFloat=="undefined"?"cssFloat":"styleFloat":s;u[f]=o[s]}return e}var r=t.document.createElement("div"),l=typeof r.style.opacity=="string",c=typeof r.style.filter=="string",i=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,n=function(e){return e};l?n=function(e,o){return e.style.opacity=o,e}:c&&(n=function(e,o){var u=e.style;return e.currentStyle&&!e.currentStyle.hasLayout&&(u.zoom=1),i.test(u.filter)?(o=o>=.9999?"":"alpha(opacity="+o*100+")",u.filter=u.filter.replace(i,o)):u.filter+=" alpha(opacity="+o*100+")",e}),t.util.setStyle=h}(),function(){var h=Array.prototype.slice;function r(m){return typeof m=="string"?t.document.getElementById(m):m}var l,c=function(m){return h.call(m,0)};try{l=c(t.document.childNodes)instanceof Array}catch{}l||(c=function(m){for(var y=new Array(m.length),S=m.length;S--;)y[S]=m[S];return y});function i(m,y){var S=t.document.createElement(m);for(var O in y)O==="class"?S.className=y[O]:O==="for"?S.htmlFor=y[O]:S.setAttribute(O,y[O]);return S}function n(m,y){m&&(" "+m.className+" ").indexOf(" "+y+" ")===-1&&(m.className+=(m.className?" ":"")+y)}function e(m,y,S){return typeof y=="string"&&(y=i(y,S)),m.parentNode&&m.parentNode.replaceChild(y,m),y.appendChild(m),y}function o(m){for(var y=0,S=0,O=t.document.documentElement,R=t.document.body||{scrollLeft:0,scrollTop:0};m&&(m.parentNode||m.host)&&(m=m.parentNode||m.host,m===t.document?(y=R.scrollLeft||O.scrollLeft||0,S=R.scrollTop||O.scrollTop||0):(y+=m.scrollLeft||0,S+=m.scrollTop||0),!(m.nodeType===1&&m.style.position==="fixed")););return{left:y,top:S}}function u(m){var y,S=m&&m.ownerDocument,O={left:0,top:0},R={left:0,top:0},Y,q={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!S)return R;for(var tt in q)R[q[tt]]+=parseInt(s(m,tt),10)||0;return y=S.documentElement,typeof m.getBoundingClientRect!="undefined"&&(O=m.getBoundingClientRect()),Y=o(m),{left:O.left+Y.left-(y.clientLeft||0)+R.left,top:O.top+Y.top-(y.clientTop||0)+R.top}}var s;t.document.defaultView&&t.document.defaultView.getComputedStyle?s=function(m,y){var S=t.document.defaultView.getComputedStyle(m,null);return S?S[y]:void 0}:s=function(m,y){var S=m.style[y];return!S&&m.currentStyle&&(S=m.currentStyle[y]),S},function(){var m=t.document.documentElement.style,y="userSelect"in m?"userSelect":"MozUserSelect"in m?"MozUserSelect":"WebkitUserSelect"in m?"WebkitUserSelect":"KhtmlUserSelect"in m?"KhtmlUserSelect":"";function S(R){return typeof R.onselectstart!="undefined"&&(R.onselectstart=t.util.falseFunction),y?R.style[y]="none":typeof R.unselectable=="string"&&(R.unselectable="on"),R}function O(R){return typeof R.onselectstart!="undefined"&&(R.onselectstart=null),y?R.style[y]="":typeof R.unselectable=="string"&&(R.unselectable=""),R}t.util.makeElementUnselectable=S,t.util.makeElementSelectable=O}();function f(m){var y=t.jsdomImplForWrapper(m);return y._canvas||y._image}function d(m){if(!!t.isLikelyNode){var y=t.jsdomImplForWrapper(m);y&&(y._image=null,y._canvas=null,y._currentSrc=null,y._attributes=null,y._classList=null)}}function p(m,y){m.imageSmoothingEnabled=m.imageSmoothingEnabled||m.webkitImageSmoothingEnabled||m.mozImageSmoothingEnabled||m.msImageSmoothingEnabled||m.oImageSmoothingEnabled,m.imageSmoothingEnabled=y}t.util.setImageSmoothing=p,t.util.getById=r,t.util.toArray=c,t.util.addClass=n,t.util.makeElement=i,t.util.wrapElement=e,t.util.getScrollLeftTop=o,t.util.getElementOffset=u,t.util.getNodeCanvas=f,t.util.cleanUpJsdomNode=d}(),function(){function h(c,i){return c+(/\?/.test(c)?"&":"?")+i}function r(){}function l(c,i){i||(i={});var n=i.method?i.method.toUpperCase():"GET",e=i.onComplete||function(){},o=new t.window.XMLHttpRequest,u=i.body||i.parameters;return o.onreadystatechange=function(){o.readyState===4&&(e(o),o.onreadystatechange=r)},n==="GET"&&(u=null,typeof i.parameters=="string"&&(c=h(c,i.parameters))),o.open(n,c,!0),(n==="POST"||n==="PUT")&&o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(u),o}t.util.request=l}(),t.log=console.log,t.warn=console.warn,function(){function h(){return!1}function r(o,u,s,f){return-s*Math.cos(o/f*(Math.PI/2))+s+u}function l(o){var u=!1;return n(function(s){o||(o={});var f=s||+new Date,d=o.duration||500,p=f+d,m,y=o.onChange||h,S=o.abort||h,O=o.onComplete||h,R=o.easing||r,Y="startValue"in o?o.startValue:0,q="endValue"in o?o.endValue:100,tt=o.byValue||q-Y;o.onStart&&o.onStart(),function Z(it){m=it||+new Date;var et=m>p?d:m-f,ot=et/d,at=R(et,Y,tt,d),st=Math.abs((at-Y)/tt);if(!u){if(S(at,st,ot)){O(q,1,1);return}if(m>p){y(q,1,1),O(q,1,1);return}else y(at,st,ot),n(Z)}}(f)}),function(){u=!0}}var c=t.window.requestAnimationFrame||t.window.webkitRequestAnimationFrame||t.window.mozRequestAnimationFrame||t.window.oRequestAnimationFrame||t.window.msRequestAnimationFrame||function(o){return t.window.setTimeout(o,1e3/60)},i=t.window.cancelAnimationFrame||t.window.clearTimeout;function n(){return c.apply(t.window,arguments)}function e(){return i.apply(t.window,arguments)}t.util.animate=l,t.util.requestAnimFrame=n,t.util.cancelAnimFrame=e}(),function(){function h(l,c,i){var n="rgba("+parseInt(l[0]+i*(c[0]-l[0]),10)+","+parseInt(l[1]+i*(c[1]-l[1]),10)+","+parseInt(l[2]+i*(c[2]-l[2]),10);return n+=","+(l&&c?parseFloat(l[3]+i*(c[3]-l[3])):1),n+=")",n}function r(l,c,i,n){var e=new t.Color(l).getSource(),o=new t.Color(c).getSource(),u=n.onComplete,s=n.onChange;return n=n||{},t.util.animate(t.util.object.extend(n,{duration:i||500,startValue:e,endValue:o,byValue:o,easing:function(f,d,p,m){var y=n.colorEasing?n.colorEasing(f,m):1-Math.cos(f/m*(Math.PI/2));return h(d,p,y)},onComplete:function(f,d,p){if(u)return u(h(o,o,0),d,p)},onChange:function(f,d,p){if(s){if(Array.isArray(f))return s(h(f,f,0),d,p);s(f,d,p)}}}))}t.util.animateColor=r}(),function(){function h(D,G,F,j){return D<Math.abs(G)?(D=G,j=F/4):G===0&&D===0?j=F/(2*Math.PI)*Math.asin(1):j=F/(2*Math.PI)*Math.asin(G/D),{a:D,c:G,p:F,s:j}}function r(D,G,F){return D.a*Math.pow(2,10*(G-=1))*Math.sin((G*F-D.s)*(2*Math.PI)/D.p)}function l(D,G,F,j){return F*((D=D/j-1)*D*D+1)+G}function c(D,G,F,j){return D/=j/2,D<1?F/2*D*D*D+G:F/2*((D-=2)*D*D+2)+G}function i(D,G,F,j){return F*(D/=j)*D*D*D+G}function n(D,G,F,j){return-F*((D=D/j-1)*D*D*D-1)+G}function e(D,G,F,j){return D/=j/2,D<1?F/2*D*D*D*D+G:-F/2*((D-=2)*D*D*D-2)+G}function o(D,G,F,j){return F*(D/=j)*D*D*D*D+G}function u(D,G,F,j){return F*((D=D/j-1)*D*D*D*D+1)+G}function s(D,G,F,j){return D/=j/2,D<1?F/2*D*D*D*D*D+G:F/2*((D-=2)*D*D*D*D+2)+G}function f(D,G,F,j){return-F*Math.cos(D/j*(Math.PI/2))+F+G}function d(D,G,F,j){return F*Math.sin(D/j*(Math.PI/2))+G}function p(D,G,F,j){return-F/2*(Math.cos(Math.PI*D/j)-1)+G}function m(D,G,F,j){return D===0?G:F*Math.pow(2,10*(D/j-1))+G}function y(D,G,F,j){return D===j?G+F:F*(-Math.pow(2,-10*D/j)+1)+G}function S(D,G,F,j){return D===0?G:D===j?G+F:(D/=j/2,D<1?F/2*Math.pow(2,10*(D-1))+G:F/2*(-Math.pow(2,-10*--D)+2)+G)}function O(D,G,F,j){return-F*(Math.sqrt(1-(D/=j)*D)-1)+G}function R(D,G,F,j){return F*Math.sqrt(1-(D=D/j-1)*D)+G}function Y(D,G,F,j){return D/=j/2,D<1?-F/2*(Math.sqrt(1-D*D)-1)+G:F/2*(Math.sqrt(1-(D-=2)*D)+1)+G}function q(D,G,F,j){var W=1.70158,T=0,P=F;if(D===0)return G;if(D/=j,D===1)return G+F;T||(T=j*.3);var L=h(P,F,T,W);return-r(L,D,j)+G}function tt(D,G,F,j){var W=1.70158,T=0,P=F;if(D===0)return G;if(D/=j,D===1)return G+F;T||(T=j*.3);var L=h(P,F,T,W);return L.a*Math.pow(2,-10*D)*Math.sin((D*j-L.s)*(2*Math.PI)/L.p)+L.c+G}function Z(D,G,F,j){var W=1.70158,T=0,P=F;if(D===0)return G;if(D/=j/2,D===2)return G+F;T||(T=j*(.3*1.5));var L=h(P,F,T,W);return D<1?-.5*r(L,D,j)+G:L.a*Math.pow(2,-10*(D-=1))*Math.sin((D*j-L.s)*(2*Math.PI)/L.p)*.5+L.c+G}function it(D,G,F,j,W){return W===void 0&&(W=1.70158),F*(D/=j)*D*((W+1)*D-W)+G}function et(D,G,F,j,W){return W===void 0&&(W=1.70158),F*((D=D/j-1)*D*((W+1)*D+W)+1)+G}function ot(D,G,F,j,W){return W===void 0&&(W=1.70158),D/=j/2,D<1?F/2*(D*D*(((W*=1.525)+1)*D-W))+G:F/2*((D-=2)*D*(((W*=1.525)+1)*D+W)+2)+G}function at(D,G,F,j){return F-st(j-D,0,F,j)+G}function st(D,G,F,j){return(D/=j)<1/2.75?F*(7.5625*D*D)+G:D<2/2.75?F*(7.5625*(D-=1.5/2.75)*D+.75)+G:D<2.5/2.75?F*(7.5625*(D-=2.25/2.75)*D+.9375)+G:F*(7.5625*(D-=2.625/2.75)*D+.984375)+G}function nt(D,G,F,j){return D<j/2?at(D*2,0,F,j)*.5+G:st(D*2-j,0,F,j)*.5+F*.5+G}t.util.ease={easeInQuad:function(D,G,F,j){return F*(D/=j)*D+G},easeOutQuad:function(D,G,F,j){return-F*(D/=j)*(D-2)+G},easeInOutQuad:function(D,G,F,j){return D/=j/2,D<1?F/2*D*D+G:-F/2*(--D*(D-2)-1)+G},easeInCubic:function(D,G,F,j){return F*(D/=j)*D*D+G},easeOutCubic:l,easeInOutCubic:c,easeInQuart:i,easeOutQuart:n,easeInOutQuart:e,easeInQuint:o,easeOutQuint:u,easeInOutQuint:s,easeInSine:f,easeOutSine:d,easeInOutSine:p,easeInExpo:m,easeOutExpo:y,easeInOutExpo:S,easeInCirc:O,easeOutCirc:R,easeInOutCirc:Y,easeInElastic:q,easeOutElastic:tt,easeInOutElastic:Z,easeInBack:it,easeOutBack:et,easeInOutBack:ot,easeInBounce:at,easeOutBounce:st,easeInOutBounce:nt}}(),function(h){var r=h.fabric||(h.fabric={}),l=r.util.object.extend,c=r.util.object.clone,i=r.util.toFixed,n=r.util.parseUnit,e=r.util.multiplyTransformMatrices,o=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],u=["symbol","image","marker","pattern","view","svg"],s=["pattern","defs","symbol","metadata","clipPath","mask","desc"],f=["symbol","g","a","svg","clipPath","defs"],d={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},p={stroke:"strokeOpacity",fill:"fillOpacity"},m="font-size",y="clip-path";r.svgValidTagNamesRegEx=R(o),r.svgViewBoxElementsRegEx=R(u),r.svgInvalidAncestorsRegEx=R(s),r.svgValidParentsRegEx=R(f),r.cssRules={},r.gradientDefs={},r.clipPaths={};function S(T){return T in d?d[T]:T}function O(T,P,L,k){var z=Object.prototype.toString.call(P)==="[object Array]",H;if((T==="fill"||T==="stroke")&&P==="none")P="";else{if(T==="strokeUniform")return P==="non-scaling-stroke";if(T==="strokeDashArray")P==="none"?P=null:P=P.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(T==="transformMatrix")L&&L.transformMatrix?P=e(L.transformMatrix,r.parseTransformAttribute(P)):P=r.parseTransformAttribute(P);else if(T==="visible")P=P!=="none"&&P!=="hidden",L&&L.visible===!1&&(P=!1);else if(T==="opacity")P=parseFloat(P),L&&typeof L.opacity!="undefined"&&(P*=L.opacity);else if(T==="textAnchor")P=P==="start"?"left":P==="end"?"right":"center";else if(T==="charSpacing")H=n(P,k)/k*1e3;else if(T==="paintFirst"){var V=P.indexOf("fill"),$=P.indexOf("stroke"),P="fill";(V>-1&&$>-1&&$<V||V===-1&&$>-1)&&(P="stroke")}else{if(T==="href"||T==="xlink:href"||T==="font")return P;if(T==="imageSmoothing")return P==="optimizeQuality";H=z?P.map(n):n(P,k)}}return!z&&isNaN(H)?P:H}function R(T){return new RegExp("^("+T.join("|")+")\\b","i")}function Y(T){for(var P in p)if(!(typeof T[p[P]]=="undefined"||T[P]==="")){if(typeof T[P]=="undefined"){if(!r.Object.prototype[P])continue;T[P]=r.Object.prototype[P]}if(T[P].indexOf("url(")!==0){var L=new r.Color(T[P]);T[P]=L.setAlpha(i(L.getAlpha()*T[p[P]],2)).toRgba()}}return T}function q(T,P){var L,k=[],z,H,V;for(H=0,V=P.length;H<V;H++)L=P[H],z=T.getElementsByTagName(L),k=k.concat(Array.prototype.slice.call(z));return k}r.parseTransformAttribute=function(){function T(I,K){var J=r.util.cos(K[0]),rt=r.util.sin(K[0]),lt=0,ut=0;K.length===3&&(lt=K[1],ut=K[2]),I[0]=J,I[1]=rt,I[2]=-rt,I[3]=J,I[4]=lt-(J*lt-rt*ut),I[5]=ut-(rt*lt+J*ut)}function P(I,K){var J=K[0],rt=K.length===2?K[1]:K[0];I[0]=J,I[3]=rt}function L(I,K,J){I[J]=Math.tan(r.util.degreesToRadians(K[0]))}function k(I,K){I[4]=K[0],K.length===2&&(I[5]=K[1])}var z=r.iMatrix,H=r.reNum,V=r.commaWsp,$="(?:(skewX)\\s*\\(\\s*("+H+")\\s*\\))",Q="(?:(skewY)\\s*\\(\\s*("+H+")\\s*\\))",b="(?:(rotate)\\s*\\(\\s*("+H+")(?:"+V+"("+H+")"+V+"("+H+"))?\\s*\\))",x="(?:(scale)\\s*\\(\\s*("+H+")(?:"+V+"("+H+"))?\\s*\\))",E="(?:(translate)\\s*\\(\\s*("+H+")(?:"+V+"("+H+"))?\\s*\\))",M="(?:(matrix)\\s*\\(\\s*("+H+")"+V+"("+H+")"+V+"("+H+")"+V+"("+H+")"+V+"("+H+")"+V+"("+H+")\\s*\\))",A="(?:"+M+"|"+E+"|"+x+"|"+b+"|"+$+"|"+Q+")",B="(?:"+A+"(?:"+V+"*"+A+")*)",X="^\\s*(?:"+B+"?)\\s*$",U=new RegExp(X),N=new RegExp(A,"g");return function(I){var K=z.concat(),J=[];if(!I||I&&!U.test(I))return K;I.replace(N,function(lt){var ut=new RegExp(A).exec(lt).filter(function(mt){return!!mt}),dt=ut[1],ct=ut.slice(2).map(parseFloat);switch(dt){case"translate":k(K,ct);break;case"rotate":ct[0]=r.util.degreesToRadians(ct[0]),T(K,ct);break;case"scale":P(K,ct);break;case"skewX":L(K,ct,2);break;case"skewY":L(K,ct,1);break;case"matrix":K=ct;break}J.push(K.concat()),K=z.concat()});for(var rt=J[0];J.length>1;)J.shift(),rt=r.util.multiplyTransformMatrices(rt,J[0]);return rt}}();function tt(T,P){var L,k;T.replace(/;\s*$/,"").split(";").forEach(function(z){var H=z.split(":");L=H[0].trim().toLowerCase(),k=H[1].trim(),P[L]=k})}function Z(T,P){var L,k;for(var z in T)typeof T[z]!="undefined"&&(L=z.toLowerCase(),k=T[z],P[L]=k)}function it(T,P){var L={};for(var k in r.cssRules[P])if(et(T,k.split(" ")))for(var z in r.cssRules[P][k])L[z]=r.cssRules[P][k][z];return L}function et(T,P){var L,k=!0;return L=at(T,P.pop()),L&&P.length&&(k=ot(T,P)),L&&k&&P.length===0}function ot(T,P){for(var L,k=!0;T.parentNode&&T.parentNode.nodeType===1&&P.length;)k&&(L=P.pop()),T=T.parentNode,k=at(T,L);return P.length===0}function at(T,P){var L=T.nodeName,k=T.getAttribute("class"),z=T.getAttribute("id"),H,V;if(H=new RegExp("^"+L,"i"),P=P.replace(H,""),z&&P.length&&(H=new RegExp("#"+z+"(?![a-zA-Z\\-]+)","i"),P=P.replace(H,"")),k&&P.length)for(k=k.split(" "),V=k.length;V--;)H=new RegExp("\\."+k[V]+"(?![a-zA-Z\\-]+)","i"),P=P.replace(H,"");return P.length===0}function st(T,P){var L;if(T.getElementById&&(L=T.getElementById(P)),L)return L;var k,z,H,V=T.getElementsByTagName("*");for(z=0,H=V.length;z<H;z++)if(k=V[z],P===k.getAttribute("id"))return k}function nt(T){for(var P=q(T,["use","svg:use"]),L=0;P.length&&L<P.length;){var k=P[L],z=k.getAttribute("xlink:href")||k.getAttribute("href");if(z===null)return;var H=z.substr(1),V=k.getAttribute("x")||0,$=k.getAttribute("y")||0,Q=st(T,H).cloneNode(!0),b=(Q.getAttribute("transform")||"")+" translate("+V+", "+$+")",x,E=P.length,M,A,B,X,U=r.svgNS;if(G(Q),/^svg$/i.test(Q.nodeName)){var N=Q.ownerDocument.createElementNS(U,"g");for(A=0,B=Q.attributes,X=B.length;A<X;A++)M=B.item(A),N.setAttributeNS(U,M.nodeName,M.nodeValue);for(;Q.firstChild;)N.appendChild(Q.firstChild);Q=N}for(A=0,B=k.attributes,X=B.length;A<X;A++)M=B.item(A),!(M.nodeName==="x"||M.nodeName==="y"||M.nodeName==="xlink:href"||M.nodeName==="href")&&(M.nodeName==="transform"?b=M.nodeValue+" "+b:Q.setAttribute(M.nodeName,M.nodeValue));Q.setAttribute("transform",b),Q.setAttribute("instantiated_by_use","1"),Q.removeAttribute("id"),x=k.parentNode,x.replaceChild(Q,k),P.length===E&&L++}}var D=new RegExp("^\\s*("+r.reNum+"+)\\s*,?\\s*("+r.reNum+"+)\\s*,?\\s*("+r.reNum+"+)\\s*,?\\s*("+r.reNum+"+)\\s*$");function G(T){if(!r.svgViewBoxElementsRegEx.test(T.nodeName))return{};var P=T.getAttribute("viewBox"),L=1,k=1,z=0,H=0,V,$,Q,b,x=T.getAttribute("width"),E=T.getAttribute("height"),M=T.getAttribute("x")||0,A=T.getAttribute("y")||0,B=T.getAttribute("preserveAspectRatio")||"",X=!P||!(P=P.match(D)),U=!x||!E||x==="100%"||E==="100%",N=X&&U,I={},K="",J=0,rt=0;if(I.width=0,I.height=0,I.toBeParsed=N,X&&(M||A)&&T.parentNode&&T.parentNode.nodeName!=="#document"&&(K=" translate("+n(M)+" "+n(A)+") ",Q=(T.getAttribute("transform")||"")+K,T.setAttribute("transform",Q),T.removeAttribute("x"),T.removeAttribute("y")),N)return I;if(X)return I.width=n(x),I.height=n(E),I;if(z=-parseFloat(P[1]),H=-parseFloat(P[2]),V=parseFloat(P[3]),$=parseFloat(P[4]),I.minX=z,I.minY=H,I.viewBoxWidth=V,I.viewBoxHeight=$,U?(I.width=V,I.height=$):(I.width=n(x),I.height=n(E),L=I.width/V,k=I.height/$),B=r.util.parsePreserveAspectRatioAttribute(B),B.alignX!=="none"&&(B.meetOrSlice==="meet"&&(k=L=L>k?k:L),B.meetOrSlice==="slice"&&(k=L=L>k?L:k),J=I.width-V*L,rt=I.height-$*L,B.alignX==="Mid"&&(J/=2),B.alignY==="Mid"&&(rt/=2),B.alignX==="Min"&&(J=0),B.alignY==="Min"&&(rt=0)),L===1&&k===1&&z===0&&H===0&&M===0&&A===0)return I;if((M||A)&&T.parentNode.nodeName!=="#document"&&(K=" translate("+n(M)+" "+n(A)+") "),Q=K+" matrix("+L+" 0 0 "+k+" "+(z*L+J)+" "+(H*k+rt)+") ",T.nodeName==="svg"){for(b=T.ownerDocument.createElementNS(r.svgNS,"g");T.firstChild;)b.appendChild(T.firstChild);T.appendChild(b)}else b=T,b.removeAttribute("x"),b.removeAttribute("y"),Q=b.getAttribute("transform")+Q;return b.setAttribute("transform",Q),I}function F(T,P){for(;T&&(T=T.parentNode);)if(T.nodeName&&P.test(T.nodeName.replace("svg:",""))&&!T.getAttribute("instantiated_by_use"))return!0;return!1}r.parseSVGDocument=function(T,P,L,k){if(!!T){nt(T);var z=r.Object.__uid++,H,V,$=G(T),Q=r.util.toArray(T.getElementsByTagName("*"));if($.crossOrigin=k&&k.crossOrigin,$.svgUid=z,Q.length===0&&r.isLikelyNode){Q=T.selectNodes('//*[name(.)!="svg"]');var b=[];for(H=0,V=Q.length;H<V;H++)b[H]=Q[H];Q=b}var x=Q.filter(function(M){return G(M),r.svgValidTagNamesRegEx.test(M.nodeName.replace("svg:",""))&&!F(M,r.svgInvalidAncestorsRegEx)});if(!x||x&&!x.length){P&&P([],{});return}var E={};Q.filter(function(M){return M.nodeName.replace("svg:","")==="clipPath"}).forEach(function(M){var A=M.getAttribute("id");E[A]=r.util.toArray(M.getElementsByTagName("*")).filter(function(B){return r.svgValidTagNamesRegEx.test(B.nodeName.replace("svg:",""))})}),r.gradientDefs[z]=r.getGradientDefs(T),r.cssRules[z]=r.getCSSRules(T),r.clipPaths[z]=E,r.parseElements(x,function(M,A){P&&(P(M,$,A,Q),delete r.gradientDefs[z],delete r.cssRules[z],delete r.clipPaths[z])},c($),L,k)}};function j(T,P){var L=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],k="xlink:href",z=P.getAttribute(k).substr(1),H=st(T,z);if(H&&H.getAttribute(k)&&j(T,H),L.forEach(function($){H&&!P.hasAttribute($)&&H.hasAttribute($)&&P.setAttribute($,H.getAttribute($))}),!P.children.length)for(var V=H.cloneNode(!0);V.firstChild;)P.appendChild(V.firstChild);P.removeAttribute(k)}var W=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+r.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+r.reNum+"))?\\s+(.*)");l(r,{parseFontDeclaration:function(T,P){var L=T.match(W);if(!!L){var k=L[1],z=L[3],H=L[4],V=L[5],$=L[6];k&&(P.fontStyle=k),z&&(P.fontWeight=isNaN(parseFloat(z))?z:parseFloat(z)),H&&(P.fontSize=n(H)),$&&(P.fontFamily=$),V&&(P.lineHeight=V==="normal"?1:V)}},getGradientDefs:function(T){var P=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],L=q(T,P),k,z=0,H={};for(z=L.length;z--;)k=L[z],k.getAttribute("xlink:href")&&j(T,k),H[k.getAttribute("id")]=k;return H},parseAttributes:function(T,P,L){if(!!T){var k,z={},H,V;typeof L=="undefined"&&(L=T.getAttribute("svgUid")),T.parentNode&&r.svgValidParentsRegEx.test(T.parentNode.nodeName)&&(z=r.parseAttributes(T.parentNode,P,L));var $=P.reduce(function(B,X){return k=T.getAttribute(X),k&&(B[X]=k),B},{}),Q=l(it(T,L),r.parseStyleAttribute(T));$=l($,Q),Q[y]&&T.setAttribute(y,Q[y]),H=V=z.fontSize||r.Text.DEFAULT_SVG_FONT_SIZE,$[m]&&($[m]=H=n($[m],V));var b,x,E={};for(var M in $)b=S(M),x=O(b,$[M],z,H),E[b]=x;E&&E.font&&r.parseFontDeclaration(E.font,E);var A=l(z,E);return r.svgValidParentsRegEx.test(T.nodeName)?A:Y(A)}},parseElements:function(T,P,L,k,z){new r.ElementsParser(T,P,L,k,z).parse()},parseStyleAttribute:function(T){var P={},L=T.getAttribute("style");return L&&(typeof L=="string"?tt(L,P):Z(L,P)),P},parsePointsAttribute:function(T){if(!T)return null;T=T.replace(/,/g," ").trim(),T=T.split(/\s+/);var P=[],L,k;for(L=0,k=T.length;L<k;L+=2)P.push({x:parseFloat(T[L]),y:parseFloat(T[L+1])});return P},getCSSRules:function(T){var P=T.getElementsByTagName("style"),L,k,z={},H;for(L=0,k=P.length;L<k;L++){var V=P[L].textContent;V=V.replace(/\/\*[\s\S]*?\*\//g,""),V.trim()!==""&&(H=V.match(/[^{]*\{[\s\S]*?\}/g),H=H.map(function($){return $.trim()}),H.forEach(function($){var Q=$.match(/([\s\S]*?)\s*\{([^}]*)\}/),b={},x=Q[2].trim(),E=x.replace(/;$/,"").split(/\s*;\s*/);for(L=0,k=E.length;L<k;L++){var M=E[L].split(/\s*:\s*/),A=M[0],B=M[1];b[A]=B}$=Q[1],$.split(",").forEach(function(X){X=X.replace(/^svg/i,"").trim(),X!==""&&(z[X]?r.util.object.extend(z[X],b):z[X]=r.util.object.clone(b))})}))}return z},loadSVGFromURL:function(T,P,L,k){T=T.replace(/^\n\s*/,"").trim(),new r.util.request(T,{method:"get",onComplete:z});function z(H){var V=H.responseXML;if(!V||!V.documentElement)return P&&P(null),!1;r.parseSVGDocument(V.documentElement,function($,Q,b,x){P&&P($,Q,b,x)},L,k)}},loadSVGFromString:function(T,P,L,k){var z=new r.window.DOMParser,H=z.parseFromString(T.trim(),"text/xml");r.parseSVGDocument(H.documentElement,function(V,$,Q,b){P(V,$,Q,b)},L,k)}})}(a),t.ElementsParser=function(h,r,l,c,i,n){this.elements=h,this.callback=r,this.options=l,this.reviver=c,this.svgUid=l&&l.svgUid||0,this.parsingOptions=i,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=n},function(h){h.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},h.createObjects=function(){var r=this;this.elements.forEach(function(l,c){l.setAttribute("svgUid",r.svgUid),r.createObject(l,c)})},h.findTag=function(r){return t[t.util.string.capitalize(r.tagName.replace("svg:",""))]},h.createObject=function(r,l){var c=this.findTag(r);if(c&&c.fromElement)try{c.fromElement(r,this.createCallback(l,r),this.options)}catch(i){t.log(i)}else this.checkIfDone()},h.createCallback=function(r,l){var c=this;return function(i){var n;c.resolveGradient(i,l,"fill"),c.resolveGradient(i,l,"stroke"),i instanceof t.Image&&i._originalElement&&(n=i.parsePreserveAspectRatioAttribute(l)),i._removeTransformMatrix(n),c.resolveClipPath(i,l),c.reviver&&c.reviver(l,i),c.instances[r]=i,c.checkIfDone()}},h.extractPropertyDefinition=function(r,l,c){var i=r[l],n=this.regexUrl;if(!!n.test(i)){n.lastIndex=0;var e=n.exec(i)[1];return n.lastIndex=0,t[c][this.svgUid][e]}},h.resolveGradient=function(r,l,c){var i=this.extractPropertyDefinition(r,c,"gradientDefs");if(i){var n=l.getAttribute(c+"-opacity"),e=t.Gradient.fromElement(i,r,n,this.options);r.set(c,e)}},h.createClipPathCallback=function(r,l){return function(c){c._removeTransformMatrix(),c.fillRule=c.clipRule,l.push(c)}},h.resolveClipPath=function(r,l){var c=this.extractPropertyDefinition(r,"clipPath","clipPaths"),i,n,e,o,u,s;if(c){o=[],e=t.util.invertTransform(r.calcTransformMatrix());for(var f=c[0].parentNode,d=l;d.parentNode&&d.getAttribute("clip-path")!==r.clipPath;)d=d.parentNode;d.parentNode.appendChild(f);for(var p=0;p<c.length;p++)i=c[p],n=this.findTag(i),n.fromElement(i,this.createClipPathCallback(r,o),this.options);o.length===1?c=o[0]:c=new t.Group(o),u=t.util.multiplyTransformMatrices(e,c.calcTransformMatrix()),c.clipPath&&this.resolveClipPath(c,d);var s=t.util.qrDecompose(u);c.flipX=!1,c.flipY=!1,c.set("scaleX",s.scaleX),c.set("scaleY",s.scaleY),c.angle=s.angle,c.skewX=s.skewX,c.skewY=0,c.setPositionByOrigin({x:s.translateX,y:s.translateY},"center","center"),r.clipPath=c}else delete r.clipPath},h.checkIfDone=function(){--this.numElements==0&&(this.instances=this.instances.filter(function(r){return r!=null}),this.callback(this.instances,this.elements))}}(t.ElementsParser.prototype),function(h){var r=h.fabric||(h.fabric={});if(r.Point){r.warn("fabric.Point is already defined");return}r.Point=l;function l(c,i){this.x=c,this.y=i}l.prototype={type:"point",constructor:l,add:function(c){return new l(this.x+c.x,this.y+c.y)},addEquals:function(c){return this.x+=c.x,this.y+=c.y,this},scalarAdd:function(c){return new l(this.x+c,this.y+c)},scalarAddEquals:function(c){return this.x+=c,this.y+=c,this},subtract:function(c){return new l(this.x-c.x,this.y-c.y)},subtractEquals:function(c){return this.x-=c.x,this.y-=c.y,this},scalarSubtract:function(c){return new l(this.x-c,this.y-c)},scalarSubtractEquals:function(c){return this.x-=c,this.y-=c,this},multiply:function(c){return new l(this.x*c,this.y*c)},multiplyEquals:function(c){return this.x*=c,this.y*=c,this},divide:function(c){return new l(this.x/c,this.y/c)},divideEquals:function(c){return this.x/=c,this.y/=c,this},eq:function(c){return this.x===c.x&&this.y===c.y},lt:function(c){return this.x<c.x&&this.y<c.y},lte:function(c){return this.x<=c.x&&this.y<=c.y},gt:function(c){return this.x>c.x&&this.y>c.y},gte:function(c){return this.x>=c.x&&this.y>=c.y},lerp:function(c,i){return typeof i=="undefined"&&(i=.5),i=Math.max(Math.min(1,i),0),new l(this.x+(c.x-this.x)*i,this.y+(c.y-this.y)*i)},distanceFrom:function(c){var i=this.x-c.x,n=this.y-c.y;return Math.sqrt(i*i+n*n)},midPointFrom:function(c){return this.lerp(c)},min:function(c){return new l(Math.min(this.x,c.x),Math.min(this.y,c.y))},max:function(c){return new l(Math.max(this.x,c.x),Math.max(this.y,c.y))},toString:function(){return this.x+","+this.y},setXY:function(c,i){return this.x=c,this.y=i,this},setX:function(c){return this.x=c,this},setY:function(c){return this.y=c,this},setFromPoint:function(c){return this.x=c.x,this.y=c.y,this},swap:function(c){var i=this.x,n=this.y;this.x=c.x,this.y=c.y,c.x=i,c.y=n},clone:function(){return new l(this.x,this.y)}}}(a),function(h){var r=h.fabric||(h.fabric={});if(r.Intersection){r.warn("fabric.Intersection is already defined");return}function l(c){this.status=c,this.points=[]}r.Intersection=l,r.Intersection.prototype={constructor:l,appendPoint:function(c){return this.points.push(c),this},appendPoints:function(c){return this.points=this.points.concat(c),this}},r.Intersection.intersectLineLine=function(c,i,n,e){var o,u=(e.x-n.x)*(c.y-n.y)-(e.y-n.y)*(c.x-n.x),s=(i.x-c.x)*(c.y-n.y)-(i.y-c.y)*(c.x-n.x),f=(e.y-n.y)*(i.x-c.x)-(e.x-n.x)*(i.y-c.y);if(f!==0){var d=u/f,p=s/f;0<=d&&d<=1&&0<=p&&p<=1?(o=new l("Intersection"),o.appendPoint(new r.Point(c.x+d*(i.x-c.x),c.y+d*(i.y-c.y)))):o=new l}else u===0||s===0?o=new l("Coincident"):o=new l("Parallel");return o},r.Intersection.intersectLinePolygon=function(c,i,n){var e=new l,o=n.length,u,s,f,d;for(d=0;d<o;d++)u=n[d],s=n[(d+1)%o],f=l.intersectLineLine(c,i,u,s),e.appendPoints(f.points);return e.points.length>0&&(e.status="Intersection"),e},r.Intersection.intersectPolygonPolygon=function(c,i){var n=new l,e=c.length,o;for(o=0;o<e;o++){var u=c[o],s=c[(o+1)%e],f=l.intersectLinePolygon(u,s,i);n.appendPoints(f.points)}return n.points.length>0&&(n.status="Intersection"),n},r.Intersection.intersectPolygonRectangle=function(c,i,n){var e=i.min(n),o=i.max(n),u=new r.Point(o.x,e.y),s=new r.Point(e.x,o.y),f=l.intersectLinePolygon(e,u,c),d=l.intersectLinePolygon(u,o,c),p=l.intersectLinePolygon(o,s,c),m=l.intersectLinePolygon(s,e,c),y=new l;return y.appendPoints(f.points),y.appendPoints(d.points),y.appendPoints(p.points),y.appendPoints(m.points),y.points.length>0&&(y.status="Intersection"),y}}(a),function(h){var r=h.fabric||(h.fabric={});if(r.Color){r.warn("fabric.Color is already defined.");return}function l(i){i?this._tryParsingColor(i):this.setSource([0,0,0,1])}r.Color=l,r.Color.prototype={_tryParsingColor:function(i){var n;i in l.colorNameMap&&(i=l.colorNameMap[i]),i==="transparent"&&(n=[255,255,255,0]),n||(n=l.sourceFromHex(i)),n||(n=l.sourceFromRgb(i)),n||(n=l.sourceFromHsl(i)),n||(n=[0,0,0,1]),n&&this.setSource(n)},_rgbToHsl:function(i,n,e){i/=255,n/=255,e/=255;var o,u,s,f=r.util.array.max([i,n,e]),d=r.util.array.min([i,n,e]);if(s=(f+d)/2,f===d)o=u=0;else{var p=f-d;switch(u=s>.5?p/(2-f-d):p/(f+d),f){case i:o=(n-e)/p+(n<e?6:0);break;case n:o=(e-i)/p+2;break;case e:o=(i-n)/p+4;break}o/=6}return[Math.round(o*360),Math.round(u*100),Math.round(s*100)]},getSource:function(){return this._source},setSource:function(i){this._source=i},toRgb:function(){var i=this.getSource();return"rgb("+i[0]+","+i[1]+","+i[2]+")"},toRgba:function(){var i=this.getSource();return"rgba("+i[0]+","+i[1]+","+i[2]+","+i[3]+")"},toHsl:function(){var i=this.getSource(),n=this._rgbToHsl(i[0],i[1],i[2]);return"hsl("+n[0]+","+n[1]+"%,"+n[2]+"%)"},toHsla:function(){var i=this.getSource(),n=this._rgbToHsl(i[0],i[1],i[2]);return"hsla("+n[0]+","+n[1]+"%,"+n[2]+"%,"+i[3]+")"},toHex:function(){var i=this.getSource(),n,e,o;return n=i[0].toString(16),n=n.length===1?"0"+n:n,e=i[1].toString(16),e=e.length===1?"0"+e:e,o=i[2].toString(16),o=o.length===1?"0"+o:o,n.toUpperCase()+e.toUpperCase()+o.toUpperCase()},toHexa:function(){var i=this.getSource(),n;return n=Math.round(i[3]*255),n=n.toString(16),n=n.length===1?"0"+n:n,this.toHex()+n.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(i){var n=this.getSource();return n[3]=i,this.setSource(n),this},toGrayscale:function(){var i=this.getSource(),n=parseInt((i[0]*.3+i[1]*.59+i[2]*.11).toFixed(0),10),e=i[3];return this.setSource([n,n,n,e]),this},toBlackWhite:function(i){var n=this.getSource(),e=(n[0]*.3+n[1]*.59+n[2]*.11).toFixed(0),o=n[3];return i=i||127,e=Number(e)<Number(i)?0:255,this.setSource([e,e,e,o]),this},overlayWith:function(i){i instanceof l||(i=new l(i));var n=[],e=this.getAlpha(),o=.5,u=this.getSource(),s=i.getSource(),f;for(f=0;f<3;f++)n.push(Math.round(u[f]*(1-o)+s[f]*o));return n[3]=e,this.setSource(n),this}},r.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,r.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,r.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,r.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function c(i,n,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+(n-i)*6*e:e<1/2?n:e<2/3?i+(n-i)*(2/3-e)*6:i}r.Color.fromRgb=function(i){return l.fromSource(l.sourceFromRgb(i))},r.Color.sourceFromRgb=function(i){var n=i.match(l.reRGBa);if(n){var e=parseInt(n[1],10)/(/%$/.test(n[1])?100:1)*(/%$/.test(n[1])?255:1),o=parseInt(n[2],10)/(/%$/.test(n[2])?100:1)*(/%$/.test(n[2])?255:1),u=parseInt(n[3],10)/(/%$/.test(n[3])?100:1)*(/%$/.test(n[3])?255:1);return[parseInt(e,10),parseInt(o,10),parseInt(u,10),n[4]?parseFloat(n[4]):1]}},r.Color.fromRgba=l.fromRgb,r.Color.fromHsl=function(i){return l.fromSource(l.sourceFromHsl(i))},r.Color.sourceFromHsl=function(i){var n=i.match(l.reHSLa);if(!!n){var e=(parseFloat(n[1])%360+360)%360/360,o=parseFloat(n[2])/(/%$/.test(n[2])?100:1),u=parseFloat(n[3])/(/%$/.test(n[3])?100:1),s,f,d;if(o===0)s=f=d=u;else{var p=u<=.5?u*(o+1):u+o-u*o,m=u*2-p;s=c(m,p,e+1/3),f=c(m,p,e),d=c(m,p,e-1/3)}return[Math.round(s*255),Math.round(f*255),Math.round(d*255),n[4]?parseFloat(n[4]):1]}},r.Color.fromHsla=l.fromHsl,r.Color.fromHex=function(i){return l.fromSource(l.sourceFromHex(i))},r.Color.sourceFromHex=function(i){if(i.match(l.reHex)){var n=i.slice(i.indexOf("#")+1),e=n.length===3||n.length===4,o=n.length===8||n.length===4,u=e?n.charAt(0)+n.charAt(0):n.substring(0,2),s=e?n.charAt(1)+n.charAt(1):n.substring(2,4),f=e?n.charAt(2)+n.charAt(2):n.substring(4,6),d=o?e?n.charAt(3)+n.charAt(3):n.substring(6,8):"FF";return[parseInt(u,16),parseInt(s,16),parseInt(f,16),parseFloat((parseInt(d,16)/255).toFixed(2))]}},r.Color.fromSource=function(i){var n=new l;return n.setSource(i),n}}(a),function(h){var r=h.fabric||(h.fabric={}),l=["e","se","s","sw","w","nw","n","ne","e"],c=["ns","nesw","ew","nwse"],i={},n="left",e="top",o="right",u="bottom",s="center",f={top:u,bottom:e,left:o,right:n,center:s},d=r.util.radiansToDegrees,p=Math.sign||function(b){return(b>0)-(b<0)||+b};function m(b,x){var E=b.angle+d(Math.atan2(x.y,x.x))+360;return Math.round(E%360/45)}function y(b,x){var E=x.transform.target,M=E.canvas,A=r.util.object.clone(x);A.target=E,M&&M.fire("object:"+b,A),E.fire(b,x)}function S(b,x){var E=x.canvas,M=E.uniScaleKey,A=b[M];return E.uniformScaling&&!A||!E.uniformScaling&&A}function O(b){return b.originX===s&&b.originY===s}function R(b,x,E){var M=b.lockScalingX,A=b.lockScalingY;return!!(M&&A||!x&&(M||A)&&E||M&&x==="x"||A&&x==="y")}function Y(b,x,E){var M="not-allowed",A=S(b,E),B="";if(x.x!==0&&x.y===0?B="x":x.x===0&&x.y!==0&&(B="y"),R(E,B,A))return M;var X=m(E,x);return l[X]+"-resize"}function q(b,x,E){var M="not-allowed";if(x.x!==0&&E.lockSkewingY||x.y!==0&&E.lockSkewingX)return M;var A=m(E,x)%4;return c[A]+"-resize"}function tt(b,x,E){return b[E.canvas.altActionKey]?i.skewCursorStyleHandler(b,x,E):i.scaleCursorStyleHandler(b,x,E)}function Z(b,x,E){var M=b[E.canvas.altActionKey];if(x.x===0)return M?"skewX":"scaleY";if(x.y===0)return M?"skewY":"scaleX"}function it(b,x,E){return E.lockRotation?"not-allowed":x.cursorStyle}function et(b,x,E,M){return{e:b,transform:x,pointer:{x:E,y:M}}}function ot(b){return function(x,E,M,A){var B=E.target,X=B.getCenterPoint(),U=B.translateToOriginPoint(X,E.originX,E.originY),N=b(x,E,M,A);return B.setPositionByOrigin(U,E.originX,E.originY),N}}function at(b,x){return function(E,M,A,B){var X=x(E,M,A,B);return X&&y(b,et(E,M,A,B)),X}}function st(b,x,E,M,A){var B=b.target,X=B.controls[b.corner],U=B.canvas.getZoom(),N=B.padding/U,I=B.toLocalPoint(new r.Point(M,A),x,E);return I.x>=N&&(I.x-=N),I.x<=-N&&(I.x+=N),I.y>=N&&(I.y-=N),I.y<=N&&(I.y+=N),I.x-=X.offsetX,I.y-=X.offsetY,I}function nt(b){return b.flipX!==b.flipY}function D(b,x,E,M,A){if(b[x]!==0){var B=b._getTransformedDimensions()[M],X=A/B*b[E];b.set(E,X)}}function G(b,x,E,M){var A=x.target,B=A._getTransformedDimensions(0,A.skewY),X=st(x,x.originX,x.originY,E,M),U=Math.abs(X.x*2)-B.x,N=A.skewX,I;U<2?I=0:(I=d(Math.atan2(U/A.scaleX,B.y/A.scaleY)),x.originX===n&&x.originY===u&&(I=-I),x.originX===o&&x.originY===e&&(I=-I),nt(A)&&(I=-I));var K=N!==I;if(K){var J=A._getTransformedDimensions().y;A.set("skewX",I),D(A,"skewY","scaleY","y",J)}return K}function F(b,x,E,M){var A=x.target,B=A._getTransformedDimensions(A.skewX,0),X=st(x,x.originX,x.originY,E,M),U=Math.abs(X.y*2)-B.y,N=A.skewY,I;U<2?I=0:(I=d(Math.atan2(U/A.scaleY,B.x/A.scaleX)),x.originX===n&&x.originY===u&&(I=-I),x.originX===o&&x.originY===e&&(I=-I),nt(A)&&(I=-I));var K=N!==I;if(K){var J=A._getTransformedDimensions().x;A.set("skewY",I),D(A,"skewX","scaleX","x",J)}return K}function j(b,x,E,M){var A=x.target,B=A.skewX,X,U=x.originY;if(A.lockSkewingX)return!1;if(B===0){var N=st(x,s,s,E,M);N.x>0?X=n:X=o}else B>0&&(X=U===e?n:o),B<0&&(X=U===e?o:n),nt(A)&&(X=X===n?o:n);x.originX=X;var I=at("skewing",ot(G));return I(b,x,E,M)}function W(b,x,E,M){var A=x.target,B=A.skewY,X,U=x.originX;if(A.lockSkewingY)return!1;if(B===0){var N=st(x,s,s,E,M);N.y>0?X=e:X=u}else B>0&&(X=U===n?e:u),B<0&&(X=U===n?u:e),nt(A)&&(X=X===e?u:e);x.originY=X;var I=at("skewing",ot(F));return I(b,x,E,M)}function T(b,x,E,M){var A=x,B=A.target,X=B.translateToOriginPoint(B.getCenterPoint(),A.originX,A.originY);if(B.lockRotation)return!1;var U=Math.atan2(A.ey-X.y,A.ex-X.x),N=Math.atan2(M-X.y,E-X.x),I=d(N-U+A.theta),K=!0;if(B.snapAngle>0){var J=B.snapAngle,rt=B.snapThreshold||J,lt=Math.ceil(I/J)*J,ut=Math.floor(I/J)*J;Math.abs(I-ut)<rt?I=ut:Math.abs(I-lt)<rt&&(I=lt)}return I<0&&(I=360+I),I%=360,K=B.angle!==I,B.angle=I,K}function P(b,x,E,M,A){A=A||{};var B=x.target,X=B.lockScalingX,U=B.lockScalingY,N=A.by,I,K,J,rt,lt=S(b,B),ut=R(B,N,lt),dt,ct,mt=x.gestureScale;if(ut)return!1;if(mt)K=x.scaleX*mt,J=x.scaleY*mt;else{if(I=st(x,x.originX,x.originY,E,M),dt=N!=="y"?p(I.x):1,ct=N!=="x"?p(I.y):1,x.signX||(x.signX=dt),x.signY||(x.signY=ct),B.lockScalingFlip&&(x.signX!==dt||x.signY!==ct))return!1;if(rt=B._getTransformedDimensions(),lt&&!N){var wt=Math.abs(I.x)+Math.abs(I.y),Xt=x.original,ae=Math.abs(rt.x*Xt.scaleX/B.scaleX)+Math.abs(rt.y*Xt.scaleY/B.scaleY),Bt=wt/ae;K=Xt.scaleX*Bt,J=Xt.scaleY*Bt}else K=Math.abs(I.x*B.scaleX/rt.x),J=Math.abs(I.y*B.scaleY/rt.y);O(x)&&(K*=2,J*=2),x.signX!==dt&&N!=="y"&&(x.originX=f[x.originX],K*=-1,x.signX=dt),x.signY!==ct&&N!=="x"&&(x.originY=f[x.originY],J*=-1,x.signY=ct)}var ai=B.scaleX,Lt=B.scaleY;return N?(N==="x"&&B.set("scaleX",K),N==="y"&&B.set("scaleY",J)):(!X&&B.set("scaleX",K),!U&&B.set("scaleY",J)),ai!==B.scaleX||Lt!==B.scaleY}function L(b,x,E,M){return P(b,x,E,M)}function k(b,x,E,M){return P(b,x,E,M,{by:"x"})}function z(b,x,E,M){return P(b,x,E,M,{by:"y"})}function H(b,x,E,M){return b[x.target.canvas.altActionKey]?i.skewHandlerX(b,x,E,M):i.scalingY(b,x,E,M)}function V(b,x,E,M){return b[x.target.canvas.altActionKey]?i.skewHandlerY(b,x,E,M):i.scalingX(b,x,E,M)}function $(b,x,E,M){var A=x.target,B=st(x,x.originX,x.originY,E,M),X=A.strokeWidth/(A.strokeUniform?A.scaleX:1),U=O(x)?2:1,N=A.width,I=Math.abs(B.x*U/A.scaleX)-X;return A.set("width",Math.max(I,0)),N!==I}function Q(b,x,E,M){var A=x.target,B=E-x.offsetX,X=M-x.offsetY,U=!A.get("lockMovementX")&&A.left!==B,N=!A.get("lockMovementY")&&A.top!==X;return U&&A.set("left",B),N&&A.set("top",X),(U||N)&&y("moving",et(b,x,E,M)),U||N}i.scaleCursorStyleHandler=Y,i.skewCursorStyleHandler=q,i.scaleSkewCursorStyleHandler=tt,i.rotationWithSnapping=at("rotating",ot(T)),i.scalingEqually=at("scaling",ot(L)),i.scalingX=at("scaling",ot(k)),i.scalingY=at("scaling",ot(z)),i.scalingYOrSkewingX=H,i.scalingXOrSkewingY=V,i.changeWidth=at("resizing",ot($)),i.skewHandlerX=j,i.skewHandlerY=W,i.dragHandler=Q,i.scaleOrSkewActionName=Z,i.rotationStyleHandler=it,i.fireEvent=y,i.wrapWithFixedAnchor=ot,i.wrapWithFireEvent=at,i.getLocalPoint=st,r.controlsUtils=i}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.util.degreesToRadians,c=r.controlsUtils;function i(e,o,u,s,f){s=s||{};var d=this.sizeX||s.cornerSize||f.cornerSize,p=this.sizeY||s.cornerSize||f.cornerSize,m=typeof s.transparentCorners!="undefined"?s.transparentCorners:f.transparentCorners,y=m?"stroke":"fill",S=!m&&(s.cornerStrokeColor||f.cornerStrokeColor),O=o,R=u,Y;e.save(),e.fillStyle=s.cornerColor||f.cornerColor,e.strokeStyle=s.cornerStrokeColor||f.cornerStrokeColor,d>p?(Y=d,e.scale(1,p/d),R=u*d/p):p>d?(Y=p,e.scale(d/p,1),O=o*p/d):Y=d,e.lineWidth=1,e.beginPath(),e.arc(O,R,Y/2,0,2*Math.PI,!1),e[y](),S&&e.stroke(),e.restore()}function n(e,o,u,s,f){s=s||{};var d=this.sizeX||s.cornerSize||f.cornerSize,p=this.sizeY||s.cornerSize||f.cornerSize,m=typeof s.transparentCorners!="undefined"?s.transparentCorners:f.transparentCorners,y=m?"stroke":"fill",S=!m&&(s.cornerStrokeColor||f.cornerStrokeColor),O=d/2,R=p/2;e.save(),e.fillStyle=s.cornerColor||f.cornerColor,e.strokeStyle=s.cornerStrokeColor||f.cornerStrokeColor,e.lineWidth=1,e.translate(o,u),e.rotate(l(f.angle)),e[y+"Rect"](-O,-R,d,p),S&&e.strokeRect(-O,-R,d,p),e.restore()}c.renderCircleControl=i,c.renderSquareControl=n}(a),function(h){var r=h.fabric||(h.fabric={});function l(c){for(var i in c)this[i]=c[i]}r.Control=l,r.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(c,i){return i.cursorStyle},getActionName:function(c,i){return i.actionName},getVisibility:function(c,i){var n=c._controlsVisibility;return n&&typeof n[i]!="undefined"?n[i]:this.visible},setVisibility:function(c){this.visible=c},positionHandler:function(c,i){var n=r.util.transformPoint({x:this.x*c.x+this.offsetX,y:this.y*c.y+this.offsetY},i);return n},calcCornerCoords:function(c,i,n,e,o){var u,s,f,d,p=o?this.touchSizeX:this.sizeX,m=o?this.touchSizeY:this.sizeY;if(p&&m&&p!==m){var y=Math.atan2(m,p),S=Math.sqrt(p*p+m*m)/2,O=y-r.util.degreesToRadians(c),R=Math.PI/2-y-r.util.degreesToRadians(c);u=S*r.util.cos(O),s=S*r.util.sin(O),f=S*r.util.cos(R),d=S*r.util.sin(R)}else{var Y=p&&m?p:i;S=Y*.7071067812;var O=r.util.degreesToRadians(45-c);u=f=S*r.util.cos(O),s=d=S*r.util.sin(O)}return{tl:{x:n-d,y:e-f},tr:{x:n+u,y:e-s},bl:{x:n-u,y:e+s},br:{x:n+d,y:e+f}}},render:function(c,i,n,e,o){switch(e=e||{},e.cornerStyle||o.cornerStyle){case"circle":r.controlsUtils.renderCircleControl.call(this,c,i,n,e,o);break;default:r.controlsUtils.renderSquareControl.call(this,c,i,n,e,o)}}}}(a),function(){function h(n,e){var o=n.getAttribute("style"),u=n.getAttribute("offset")||0,s,f,d,p;if(u=parseFloat(u)/(/%$/.test(u)?100:1),u=u<0?0:u>1?1:u,o){var m=o.split(/\s*;\s*/);for(m[m.length-1]===""&&m.pop(),p=m.length;p--;){var y=m[p].split(/\s*:\s*/),S=y[0].trim(),O=y[1].trim();S==="stop-color"?s=O:S==="stop-opacity"&&(d=O)}}return s||(s=n.getAttribute("stop-color")||"rgb(0,0,0)"),d||(d=n.getAttribute("stop-opacity")),s=new t.Color(s),f=s.getAlpha(),d=isNaN(parseFloat(d))?1:parseFloat(d),d*=f*e,{offset:u,color:s.toRgb(),opacity:d}}function r(n){return{x1:n.getAttribute("x1")||0,y1:n.getAttribute("y1")||0,x2:n.getAttribute("x2")||"100%",y2:n.getAttribute("y2")||0}}function l(n){return{x1:n.getAttribute("fx")||n.getAttribute("cx")||"50%",y1:n.getAttribute("fy")||n.getAttribute("cy")||"50%",r1:0,x2:n.getAttribute("cx")||"50%",y2:n.getAttribute("cy")||"50%",r2:n.getAttribute("r")||"50%"}}var c=t.util.object.clone;t.Gradient=t.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(n){n||(n={}),n.coords||(n.coords={});var e,o=this;Object.keys(n).forEach(function(u){o[u]=n[u]}),this.id?this.id+="_"+t.Object.__uid++:this.id=t.Object.__uid++,e={x1:n.coords.x1||0,y1:n.coords.y1||0,x2:n.coords.x2||0,y2:n.coords.y2||0},this.type==="radial"&&(e.r1=n.coords.r1||0,e.r2=n.coords.r2||0),this.coords=e,this.colorStops=n.colorStops.slice()},addColorStop:function(n){for(var e in n){var o=new t.Color(n[e]);this.colorStops.push({offset:parseFloat(e),color:o.toRgb(),opacity:o.getAlpha()})}return this},toObject:function(n){var e={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return t.util.populateWithProperties(this,e,n),e},toSVG:function(n,e){var o=c(this.coords,!0),u,s,e=e||{},f,d,p=c(this.colorStops,!0),m=o.r1>o.r2,y=this.gradientTransform?this.gradientTransform.concat():t.iMatrix.concat(),S=-this.offsetX,O=-this.offsetY,R=!!e.additionalTransform,Y=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(p.sort(function(et,ot){return et.offset-ot.offset}),Y==="objectBoundingBox"?(S/=n.width,O/=n.height):(S+=n.width/2,O+=n.height/2),n.type==="path"&&this.gradientUnits!=="percentage"&&(S-=n.pathOffset.x,O-=n.pathOffset.y),y[4]-=S,y[5]-=O,d='id="SVGID_'+this.id+'" gradientUnits="'+Y+'"',d+=' gradientTransform="'+(R?e.additionalTransform+" ":"")+t.util.matrixToSVG(y)+'" ',this.type==="linear"?f=["<linearGradient ",d,' x1="',o.x1,'" y1="',o.y1,'" x2="',o.x2,'" y2="',o.y2,`">
`]:this.type==="radial"&&(f=["<radialGradient ",d,' cx="',m?o.x1:o.x2,'" cy="',m?o.y1:o.y2,'" r="',m?o.r1:o.r2,'" fx="',m?o.x2:o.x1,'" fy="',m?o.y2:o.y1,`">
`]),this.type==="radial"){if(m)for(p=p.concat(),p.reverse(),u=0,s=p.length;u<s;u++)p[u].offset=1-p[u].offset;var q=Math.min(o.r1,o.r2);if(q>0){var tt=Math.max(o.r1,o.r2),Z=q/tt;for(u=0,s=p.length;u<s;u++)p[u].offset+=Z*(1-p[u].offset)}}for(u=0,s=p.length;u<s;u++){var it=p[u];f.push("<stop ",'offset="',it.offset*100+"%",'" style="stop-color:',it.color,typeof it.opacity!="undefined"?";stop-opacity: "+it.opacity:";",`"/>
`)}return f.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),f.join("")},toLive:function(n){var e,o=t.util.object.clone(this.coords),u,s;if(!!this.type){for(this.type==="linear"?e=n.createLinearGradient(o.x1,o.y1,o.x2,o.y2):this.type==="radial"&&(e=n.createRadialGradient(o.x1,o.y1,o.r1,o.x2,o.y2,o.r2)),u=0,s=this.colorStops.length;u<s;u++){var f=this.colorStops[u].color,d=this.colorStops[u].opacity,p=this.colorStops[u].offset;typeof d!="undefined"&&(f=new t.Color(f).setAlpha(d).toRgba()),e.addColorStop(p,f)}return e}}}),t.util.object.extend(t.Gradient,{fromElement:function(n,e,o,u){var s=parseFloat(o)/(/%$/.test(o)?100:1);s=s<0?0:s>1?1:s,isNaN(s)&&(s=1);var f=n.getElementsByTagName("stop"),d,p=n.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",m=n.getAttribute("gradientTransform")||"",y=[],S,O,R=0,Y=0,q;for(n.nodeName==="linearGradient"||n.nodeName==="LINEARGRADIENT"?(d="linear",S=r(n)):(d="radial",S=l(n)),O=f.length;O--;)y.push(h(f[O],s));q=t.parseTransformAttribute(m),i(e,S,u,p),p==="pixels"&&(R=-e.left,Y=-e.top);var tt=new t.Gradient({id:n.getAttribute("id"),type:d,coords:S,colorStops:y,gradientUnits:p,gradientTransform:q,offsetX:R,offsetY:Y});return tt}});function i(n,e,o,u){var s,f;Object.keys(e).forEach(function(d){s=e[d],s==="Infinity"?f=1:s==="-Infinity"?f=0:(f=parseFloat(e[d],10),typeof s=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(s)&&(f*=.01,u==="pixels"&&((d==="x1"||d==="x2"||d==="r2")&&(f*=o.viewBoxWidth||o.width),(d==="y1"||d==="y2")&&(f*=o.viewBoxHeight||o.height)))),e[d]=f})}}(),function(){var h=t.util.toFixed;t.Pattern=t.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(r,l){if(r||(r={}),this.id=t.Object.__uid++,this.setOptions(r),!r.source||r.source&&typeof r.source!="string"){l&&l(this);return}else{var c=this;this.source=t.util.createImage(),t.util.loadImage(r.source,function(i,n){c.source=i,l&&l(c,n)},null,this.crossOrigin)}},toObject:function(r){var l=t.Object.NUM_FRACTION_DIGITS,c,i;return typeof this.source.src=="string"?c=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(c=this.source.toDataURL()),i={type:"pattern",source:c,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:h(this.offsetX,l),offsetY:h(this.offsetY,l),patternTransform:this.patternTransform?this.patternTransform.concat():null},t.util.populateWithProperties(this,i,r),i},toSVG:function(r){var l=typeof this.source=="function"?this.source():this.source,c=l.width/r.width,i=l.height/r.height,n=this.offsetX/r.width,e=this.offsetY/r.height,o="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(i=1,e&&(i+=Math.abs(e))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(c=1,n&&(c+=Math.abs(n))),l.src?o=l.src:l.toDataURL&&(o=l.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+n+'" y="'+e+'" width="'+c+'" height="'+i+`">
<image x="0" y="0" width="`+l.width+'" height="'+l.height+'" xlink:href="'+o+`"></image>
</pattern>
`},setOptions:function(r){for(var l in r)this[l]=r[l]},toLive:function(r){var l=this.source;return!l||typeof l.src!="undefined"&&(!l.complete||l.naturalWidth===0||l.naturalHeight===0)?"":r.createPattern(l,this.repeat)}})}(),function(h){var r=h.fabric||(h.fabric={}),l=r.util.toFixed;if(r.Shadow){r.warn("fabric.Shadow is already defined.");return}r.Shadow=r.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(c){typeof c=="string"&&(c=this._parseShadow(c));for(var i in c)this[i]=c[i];this.id=r.Object.__uid++},_parseShadow:function(c){var i=c.trim(),n=r.Shadow.reOffsetsAndBlur.exec(i)||[],e=i.replace(r.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:e.trim(),offsetX:parseFloat(n[1],10)||0,offsetY:parseFloat(n[2],10)||0,blur:parseFloat(n[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(c){var i=40,n=40,e=r.Object.NUM_FRACTION_DIGITS,o=r.util.rotateVector({x:this.offsetX,y:this.offsetY},r.util.degreesToRadians(-c.angle)),u=20,s=new r.Color(this.color);return c.width&&c.height&&(i=l((Math.abs(o.x)+this.blur)/c.width,e)*100+u,n=l((Math.abs(o.y)+this.blur)/c.height,e)*100+u),c.flipX&&(o.x*=-1),c.flipY&&(o.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+n+'%" height="'+(100+2*n)+'%" x="-'+i+'%" width="'+(100+2*i)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+l(this.blur?this.blur/2:0,e)+`"></feGaussianBlur>
	<feOffset dx="`+l(o.x,e)+'" dy="'+l(o.y,e)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+s.toRgb()+'" flood-opacity="'+s.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var c={},i=r.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(n){this[n]!==i[n]&&(c[n]=this[n])},this),c}}),r.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(a),function(){if(t.StaticCanvas){t.warn("fabric.StaticCanvas is already defined.");return}var h=t.util.object.extend,r=t.util.getElementOffset,l=t.util.removeFromArray,c=t.util.toFixed,i=t.util.transformPoint,n=t.util.invertTransform,e=t.util.getNodeCanvas,o=t.util.createCanvasElement,u=new Error("Could not initialize `canvas` element");t.StaticCanvas=t.util.createClass(t.CommonMethods,{initialize:function(s,f){f||(f={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(s,f)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:t.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(s,f){var d=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(s),this._initOptions(f),this.interactive||this._initRetinaScaling(),f.overlayImage&&this.setOverlayImage(f.overlayImage,d),f.backgroundImage&&this.setBackgroundImage(f.backgroundImage,d),f.backgroundColor&&this.setBackgroundColor(f.backgroundColor,d),f.overlayColor&&this.setOverlayColor(f.overlayColor,d),this.calcOffset()},_isRetinaScaling:function(){return t.devicePixelRatio!==1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?t.devicePixelRatio:1},_initRetinaScaling:function(){if(!!this._isRetinaScaling()){var s=t.devicePixelRatio;this.__initRetinaScaling(s,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(s,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(s,f,d){f.setAttribute("width",this.width*s),f.setAttribute("height",this.height*s),d.scale(s,s)},calcOffset:function(){return this._offset=r(this.lowerCanvasEl),this},setOverlayImage:function(s,f,d){return this.__setBgOverlayImage("overlayImage",s,f,d)},setBackgroundImage:function(s,f,d){return this.__setBgOverlayImage("backgroundImage",s,f,d)},setOverlayColor:function(s,f){return this.__setBgOverlayColor("overlayColor",s,f)},setBackgroundColor:function(s,f){return this.__setBgOverlayColor("backgroundColor",s,f)},__setBgOverlayImage:function(s,f,d,p){return typeof f=="string"?t.util.loadImage(f,function(m,y){if(m){var S=new t.Image(m,p);this[s]=S,S.canvas=this}d&&d(m,y)},this,p&&p.crossOrigin):(p&&f.setOptions(p),this[s]=f,f&&(f.canvas=this),d&&d(f,!1)),this},__setBgOverlayColor:function(s,f,d){return this[s]=f,this._initGradient(f,s),this._initPattern(f,s,d),this},_createCanvasElement:function(){var s=o();if(!s||(s.style||(s.style={}),typeof s.getContext=="undefined"))throw u;return s},_initOptions:function(s){var f=this.lowerCanvasEl;this._setOptions(s),this.width=this.width||parseInt(f.width,10)||0,this.height=this.height||parseInt(f.height,10)||0,!!this.lowerCanvasEl.style&&(f.width=this.width,f.height=this.height,f.style.width=this.width+"px",f.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(s){s&&s.getContext?this.lowerCanvasEl=s:this.lowerCanvasEl=t.util.getById(s)||this._createCanvasElement(),t.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(s,f){return this.setDimensions({width:s},f)},setHeight:function(s,f){return this.setDimensions({height:s},f)},setDimensions:function(s,f){var d;f=f||{};for(var p in s)d=s[p],f.cssOnly||(this._setBackstoreDimension(p,s[p]),d+="px",this.hasLostContext=!0),f.backstoreOnly||this._setCssDimension(p,d);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(),this._initRetinaScaling(),this.calcOffset(),f.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(s,f){return this.lowerCanvasEl[s]=f,this.upperCanvasEl&&(this.upperCanvasEl[s]=f),this.cacheCanvasEl&&(this.cacheCanvasEl[s]=f),this[s]=f,this},_setCssDimension:function(s,f){return this.lowerCanvasEl.style[s]=f,this.upperCanvasEl&&(this.upperCanvasEl.style[s]=f),this.wrapperEl&&(this.wrapperEl.style[s]=f),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(s){var f=this._activeObject,d=this.backgroundImage,p=this.overlayImage,m,y,S;for(this.viewportTransform=s,y=0,S=this._objects.length;y<S;y++)m=this._objects[y],m.group||m.setCoords(!0);return f&&f.setCoords(),d&&d.setCoords(!0),p&&p.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(s,f){var d=s,p=this.viewportTransform.slice(0);s=i(s,n(this.viewportTransform)),p[0]=f,p[3]=f;var m=i(s,p);return p[4]+=d.x-m.x,p[5]+=d.y-m.y,this.setViewportTransform(p)},setZoom:function(s){return this.zoomToPoint(new t.Point(0,0),s),this},absolutePan:function(s){var f=this.viewportTransform.slice(0);return f[4]=-s.x,f[5]=-s.y,this.setViewportTransform(f)},relativePan:function(s){return this.absolutePan(new t.Point(-s.x-this.viewportTransform[4],-s.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(s){this.stateful&&s.setupState(),s._set("canvas",this),s.setCoords(),this.fire("object:added",{target:s}),s.fire("added")},_onObjectRemoved:function(s){this.fire("object:removed",{target:s}),s.fire("removed"),delete s.canvas},clearContext:function(s){return s.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var s=this.contextContainer;return this.renderCanvas(s,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=t.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var s={},f=this.width,d=this.height,p=n(this.viewportTransform);return s.tl=i({x:0,y:0},p),s.br=i({x:f,y:d},p),s.tr=new t.Point(s.br.x,s.tl.y),s.bl=new t.Point(s.tl.x,s.br.y),this.vptCoords=s,s},cancelRequestedRender:function(){this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(s,f){var d=this.viewportTransform,p=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(s),t.util.setImageSmoothing(s,this.imageSmoothingEnabled),this.fire("before:render",{ctx:s}),this._renderBackground(s),s.save(),s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._renderObjects(s,f),s.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(s),p&&(p.canvas=this,p.shouldCache(),p._transformDone=!0,p.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(s)),this._renderOverlay(s),this.controlsAboveOverlay&&this.interactive&&this.drawControls(s),this.fire("after:render",{ctx:s})},drawClipPathOnCanvas:function(s){var f=this.viewportTransform,d=this.clipPath;s.save(),s.transform(f[0],f[1],f[2],f[3],f[4],f[5]),s.globalCompositeOperation="destination-in",d.transform(s),s.scale(1/d.zoomX,1/d.zoomY),s.drawImage(d._cacheCanvas,-d.cacheTranslationX,-d.cacheTranslationY),s.restore()},_renderObjects:function(s,f){var d,p;for(d=0,p=f.length;d<p;++d)f[d]&&f[d].render(s)},_renderBackgroundOrOverlay:function(s,f){var d=this[f+"Color"],p=this[f+"Image"],m=this.viewportTransform,y=this[f+"Vpt"];if(!(!d&&!p)){if(d){s.save(),s.beginPath(),s.moveTo(0,0),s.lineTo(this.width,0),s.lineTo(this.width,this.height),s.lineTo(0,this.height),s.closePath(),s.fillStyle=d.toLive?d.toLive(s,this):d,y&&s.transform(m[0],m[1],m[2],m[3],m[4],m[5]),s.transform(1,0,0,1,d.offsetX||0,d.offsetY||0);var S=d.gradientTransform||d.patternTransform;S&&s.transform(S[0],S[1],S[2],S[3],S[4],S[5]),s.fill(),s.restore()}p&&(s.save(),y&&s.transform(m[0],m[1],m[2],m[3],m[4],m[5]),p.render(s),s.restore())}},_renderBackground:function(s){this._renderBackgroundOrOverlay(s,"background")},_renderOverlay:function(s){this._renderBackgroundOrOverlay(s,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},centerObjectH:function(s){return this._centerObject(s,new t.Point(this.getCenter().left,s.getCenterPoint().y))},centerObjectV:function(s){return this._centerObject(s,new t.Point(s.getCenterPoint().x,this.getCenter().top))},centerObject:function(s){var f=this.getCenter();return this._centerObject(s,new t.Point(f.left,f.top))},viewportCenterObject:function(s){var f=this.getVpCenter();return this._centerObject(s,f)},viewportCenterObjectH:function(s){var f=this.getVpCenter();return this._centerObject(s,new t.Point(f.x,s.getCenterPoint().y)),this},viewportCenterObjectV:function(s){var f=this.getVpCenter();return this._centerObject(s,new t.Point(s.getCenterPoint().x,f.y))},getVpCenter:function(){var s=this.getCenter(),f=n(this.viewportTransform);return i({x:s.left,y:s.top},f)},_centerObject:function(s,f){return s.setPositionByOrigin(f,"center","center"),s.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(s){return this.toDatalessObject(s)},toObject:function(s){return this._toObjectMethod("toObject",s)},toDatalessObject:function(s){return this._toObjectMethod("toDatalessObject",s)},_toObjectMethod:function(s,f){var d=this.clipPath,p={version:t.version,objects:this._toObjects(s,f)};return d&&!d.excludeFromExport&&(p.clipPath=this._toObject(this.clipPath,s,f)),h(p,this.__serializeBgOverlay(s,f)),t.util.populateWithProperties(this,p,f),p},_toObjects:function(s,f){return this._objects.filter(function(d){return!d.excludeFromExport}).map(function(d){return this._toObject(d,s,f)},this)},_toObject:function(s,f,d){var p;this.includeDefaultValues||(p=s.includeDefaultValues,s.includeDefaultValues=!1);var m=s[f](d);return this.includeDefaultValues||(s.includeDefaultValues=p),m},__serializeBgOverlay:function(s,f){var d={},p=this.backgroundImage,m=this.overlayImage,y=this.backgroundColor,S=this.overlayColor;return y&&y.toObject?y.excludeFromExport||(d.background=y.toObject(f)):y&&(d.background=y),S&&S.toObject?S.excludeFromExport||(d.overlay=S.toObject(f)):S&&(d.overlay=S),p&&!p.excludeFromExport&&(d.backgroundImage=this._toObject(p,s,f)),m&&!m.excludeFromExport&&(d.overlayImage=this._toObject(m,s,f)),d},svgViewportTransformation:!0,toSVG:function(s,f){s||(s={}),s.reviver=f;var d=[];return this._setSVGPreamble(d,s),this._setSVGHeader(d,s),this.clipPath&&d.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(d,"background"),this._setSVGBgOverlayImage(d,"backgroundImage",f),this._setSVGObjects(d,f),this.clipPath&&d.push(`</g>
`),this._setSVGBgOverlayColor(d,"overlay"),this._setSVGBgOverlayImage(d,"overlayImage",f),d.push("</svg>"),d.join("")},_setSVGPreamble:function(s,f){f.suppressPreamble||s.push('<?xml version="1.0" encoding="',f.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(s,f){var d=f.width||this.width,p=f.height||this.height,m,y='viewBox="0 0 '+this.width+" "+this.height+'" ',S=t.Object.NUM_FRACTION_DIGITS;f.viewBox?y='viewBox="'+f.viewBox.x+" "+f.viewBox.y+" "+f.viewBox.width+" "+f.viewBox.height+'" ':this.svgViewportTransformation&&(m=this.viewportTransform,y='viewBox="'+c(-m[4]/m[0],S)+" "+c(-m[5]/m[3],S)+" "+c(this.width/m[0],S)+" "+c(this.height/m[3],S)+'" '),s.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',d,'" ','height="',p,'" ',y,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",t.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(f),`</defs>
`)},createSVGClipPathMarkup:function(s){var f=this.clipPath;return f?(f.clipPathId="CLIPPATH_"+t.Object.__uid++,'<clipPath id="'+f.clipPathId+`" >
`+this.clipPath.toClipPathSVG(s.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var s=this,f=["background","overlay"].map(function(d){var p=s[d+"Color"];if(p&&p.toLive){var m=s[d+"Vpt"],y=s.viewportTransform,S={width:s.width/(m?y[0]:1),height:s.height/(m?y[3]:1)};return p.toSVG(S,{additionalTransform:m?t.util.matrixToSVG(y):""})}});return f.join("")},createSVGFontFacesMarkup:function(){var s="",f={},d,p,m,y,S,O,R,Y,q,tt=t.fontPaths,Z=[];for(this._objects.forEach(function et(ot){Z.push(ot),ot._objects&&ot._objects.forEach(et)}),Y=0,q=Z.length;Y<q;Y++)if(d=Z[Y],p=d.fontFamily,!(d.type.indexOf("text")===-1||f[p]||!tt[p])&&(f[p]=!0,!!d.styles)){m=d.styles;for(S in m){y=m[S];for(R in y)O=y[R],p=O.fontFamily,!f[p]&&tt[p]&&(f[p]=!0)}}for(var it in f)s+=[`		@font-face {
`,"			font-family: '",it,`';
`,"			src: url('",tt[it],`');
`,`		}
`].join("");return s&&(s=['	<style type="text/css">',`<![CDATA[
`,s,"]]>",`</style>
`].join("")),s},_setSVGObjects:function(s,f){var d,p,m,y=this._objects;for(p=0,m=y.length;p<m;p++)d=y[p],!d.excludeFromExport&&this._setSVGObject(s,d,f)},_setSVGObject:function(s,f,d){s.push(f.toSVG(d))},_setSVGBgOverlayImage:function(s,f,d){this[f]&&!this[f].excludeFromExport&&this[f].toSVG&&s.push(this[f].toSVG(d))},_setSVGBgOverlayColor:function(s,f){var d=this[f+"Color"],p=this.viewportTransform,m=this.width,y=this.height;if(!!d)if(d.toLive){var S=d.repeat,O=t.util.invertTransform(p),R=this[f+"Vpt"],Y=R?t.util.matrixToSVG(O):"";s.push('<rect transform="'+Y+" translate(",m/2,",",y/2,')"',' x="',d.offsetX-m/2,'" y="',d.offsetY-y/2,'" ','width="',S==="repeat-y"||S==="no-repeat"?d.source.width:m,'" height="',S==="repeat-x"||S==="no-repeat"?d.source.height:y,'" fill="url(#SVGID_'+d.id+')"',`></rect>
`)}else s.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',d,'"',`></rect>
`)},sendToBack:function(s){if(!s)return this;var f=this._activeObject,d,p,m;if(s===f&&s.type==="activeSelection")for(m=f._objects,d=m.length;d--;)p=m[d],l(this._objects,p),this._objects.unshift(p);else l(this._objects,s),this._objects.unshift(s);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(s){if(!s)return this;var f=this._activeObject,d,p,m;if(s===f&&s.type==="activeSelection")for(m=f._objects,d=0;d<m.length;d++)p=m[d],l(this._objects,p),this._objects.push(p);else l(this._objects,s),this._objects.push(s);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(s,f){if(!s)return this;var d=this._activeObject,p,m,y,S,O,R=0;if(s===d&&s.type==="activeSelection")for(O=d._objects,p=0;p<O.length;p++)m=O[p],y=this._objects.indexOf(m),y>0+R&&(S=y-1,l(this._objects,m),this._objects.splice(S,0,m)),R++;else y=this._objects.indexOf(s),y!==0&&(S=this._findNewLowerIndex(s,y,f),l(this._objects,s),this._objects.splice(S,0,s));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(s,f,d){var p,m;if(d)for(p=f,m=f-1;m>=0;--m){var y=s.intersectsWithObject(this._objects[m])||s.isContainedWithinObject(this._objects[m])||this._objects[m].isContainedWithinObject(s);if(y){p=m;break}}else p=f-1;return p},bringForward:function(s,f){if(!s)return this;var d=this._activeObject,p,m,y,S,O,R=0;if(s===d&&s.type==="activeSelection")for(O=d._objects,p=O.length;p--;)m=O[p],y=this._objects.indexOf(m),y<this._objects.length-1-R&&(S=y+1,l(this._objects,m),this._objects.splice(S,0,m)),R++;else y=this._objects.indexOf(s),y!==this._objects.length-1&&(S=this._findNewUpperIndex(s,y,f),l(this._objects,s),this._objects.splice(S,0,s));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(s,f,d){var p,m,y;if(d)for(p=f,m=f+1,y=this._objects.length;m<y;++m){var S=s.intersectsWithObject(this._objects[m])||s.isContainedWithinObject(this._objects[m])||this._objects[m].isContainedWithinObject(s);if(S){p=m;break}}else p=f+1;return p},moveTo:function(s,f){return l(this._objects,s),this._objects.splice(f,0,s),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(t.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(s){s.dispose&&s.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),this.lowerCanvasEl.style=this._originalCanvasStyle,delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),t.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),h(t.StaticCanvas.prototype,t.Observable),h(t.StaticCanvas.prototype,t.Collection),h(t.StaticCanvas.prototype,t.DataURLExporter),h(t.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(s){var f=o();if(!f||!f.getContext)return null;var d=f.getContext("2d");if(!d)return null;switch(s){case"setLineDash":return typeof d.setLineDash!="undefined";default:return null}}}),t.StaticCanvas.prototype.toJSON=t.StaticCanvas.prototype.toObject,t.isLikelyNode&&(t.StaticCanvas.prototype.createPNGStream=function(){var s=e(this.lowerCanvasEl);return s&&s.createPNGStream()},t.StaticCanvas.prototype.createJPEGStream=function(s){var f=e(this.lowerCanvasEl);return f&&f.createJPEGStream(s)})}(),t.BaseBrush=t.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(){var h=this.canvas.contextTop;h.strokeStyle=this.color,h.lineWidth=this.width,h.lineCap=this.strokeLineCap,h.miterLimit=this.strokeMiterLimit,h.lineJoin=this.strokeLineJoin,h.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(h){var r=this.canvas.viewportTransform;h.save(),h.transform(r[0],r[1],r[2],r[3],r[4],r[5])},_setShadow:function(){if(!!this.shadow){var h=this.canvas,r=this.shadow,l=h.contextTop,c=h.getZoom();h&&h._isRetinaScaling()&&(c*=t.devicePixelRatio),l.shadowColor=r.color,l.shadowBlur=r.blur*c,l.shadowOffsetX=r.offsetX*c,l.shadowOffsetY=r.offsetY*c}},needsFullRender:function(){var h=new t.Color(this.color);return h.getAlpha()<1||!!this.shadow},_resetShadow:function(){var h=this.canvas.contextTop;h.shadowColor="",h.shadowBlur=h.shadowOffsetX=h.shadowOffsetY=0},_isOutSideCanvas:function(h){return h.x<0||h.x>this.canvas.getWidth()||h.y<0||h.y>this.canvas.getHeight()}}),function(){t.PencilBrush=t.util.createClass(t.BaseBrush,{decimate:.4,initialize:function(h){this.canvas=h,this._points=[]},_drawSegment:function(h,r,l){var c=r.midPointFrom(l);return h.quadraticCurveTo(r.x,r.y,c.x,c.y),c},onMouseDown:function(h,r){!this.canvas._isMainEvent(r.e)||(this._prepareForDrawing(h),this._captureDrawingPath(h),this._render())},onMouseMove:function(h,r){if(!!this.canvas._isMainEvent(r.e)&&!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(h))&&this._captureDrawingPath(h)&&this._points.length>1)if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var l=this._points,c=l.length,i=this.canvas.contextTop;this._saveAndTransform(i),this.oldEnd&&(i.beginPath(),i.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(i,l[c-2],l[c-1],!0),i.stroke(),i.restore()}},onMouseUp:function(h){return this.canvas._isMainEvent(h.e)?(this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(h){var r=new t.Point(h.x,h.y);this._reset(),this._addPoint(r),this.canvas.contextTop.moveTo(r.x,r.y)},_addPoint:function(h){return this._points.length>1&&h.eq(this._points[this._points.length-1])?!1:(this._points.push(h),!0)},_reset:function(){this._points=[],this._setBrushStyles(),this._setShadow()},_captureDrawingPath:function(h){var r=new t.Point(h.x,h.y);return this._addPoint(r)},_render:function(){var h=this.canvas.contextTop,r,l,c=this._points[0],i=this._points[1];if(this._saveAndTransform(h),h.beginPath(),this._points.length===2&&c.x===i.x&&c.y===i.y){var n=this.width/1e3;c=new t.Point(c.x,c.y),i=new t.Point(i.x,i.y),c.x-=n,i.x+=n}for(h.moveTo(c.x,c.y),r=1,l=this._points.length;r<l;r++)this._drawSegment(h,c,i),c=this._points[r],i=this._points[r+1];h.lineTo(c.x,c.y),h.stroke(),h.restore()},convertPointsToSVGPath:function(h){var r=this.width/1e3;return t.util.getSmoothPathFromPoints(h,r)},_isEmptySVGPath:function(h){var r=t.util.joinPath(h);return r==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(h){var r=new t.Path(h,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,r.shadow=new t.Shadow(this.shadow)),r},decimatePoints:function(h,r){if(h.length<=2)return h;var l=this.canvas.getZoom(),c=Math.pow(r/l,2),i,n=h.length-1,e=h[0],o=[e],u;for(i=1;i<n-1;i++)u=Math.pow(e.x-h[i].x,2)+Math.pow(e.y-h[i].y,2),u>=c&&(e=h[i],o.push(e));return o.push(h[n]),o},_finalizeAndAddPath:function(){var h=this.canvas.contextTop;h.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var r=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(r)){this.canvas.requestRenderAll();return}var l=this.createPath(r);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:l}),this.canvas.add(l),this.canvas.requestRenderAll(),l.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:l})}})}(),t.CircleBrush=t.util.createClass(t.BaseBrush,{width:10,initialize:function(h){this.canvas=h,this.points=[]},drawDot:function(h){var r=this.addPoint(h),l=this.canvas.contextTop;this._saveAndTransform(l),this.dot(l,r),l.restore()},dot:function(h,r){h.fillStyle=r.fill,h.beginPath(),h.arc(r.x,r.y,r.radius,0,Math.PI*2,!1),h.closePath(),h.fill()},onMouseDown:function(h){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(h)},_render:function(){var h=this.canvas.contextTop,r,l,c=this.points;for(this._saveAndTransform(h),r=0,l=c.length;r<l;r++)this.dot(h,c[r]);h.restore()},onMouseMove:function(h){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(h)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(h),this._render()):this.drawDot(h))},onMouseUp:function(){var h=this.canvas.renderOnAddRemove,r,l;this.canvas.renderOnAddRemove=!1;var c=[];for(r=0,l=this.points.length;r<l;r++){var i=this.points[r],n=new t.Circle({radius:i.radius,left:i.x,top:i.y,originX:"center",originY:"center",fill:i.fill});this.shadow&&(n.shadow=new t.Shadow(this.shadow)),c.push(n)}var e=new t.Group(c);e.canvas=this.canvas,this.canvas.fire("before:path:created",{path:e}),this.canvas.add(e),this.canvas.fire("path:created",{path:e}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=h,this.canvas.requestRenderAll()},addPoint:function(h){var r=new t.Point(h.x,h.y),l=t.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,c=new t.Color(this.color).setAlpha(t.util.getRandomInt(0,100)/100).toRgba();return r.radius=l,r.fill=c,this.points.push(r),r}}),t.SprayBrush=t.util.createClass(t.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(h){this.canvas=h,this.sprayChunks=[]},onMouseDown:function(h){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(h),this.render(this.sprayChunkPoints)},onMouseMove:function(h){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(h)||(this.addSprayChunk(h),this.render(this.sprayChunkPoints))},onMouseUp:function(){var h=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var r=[],l=0,c=this.sprayChunks.length;l<c;l++)for(var i=this.sprayChunks[l],n=0,e=i.length;n<e;n++){var o=new t.Rect({width:i[n].width,height:i[n].width,left:i[n].x+1,top:i[n].y+1,originX:"center",originY:"center",fill:this.color});r.push(o)}this.optimizeOverlapping&&(r=this._getOptimizedRects(r));var u=new t.Group(r);this.shadow&&u.set("shadow",new t.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:u}),this.canvas.add(u),this.canvas.fire("path:created",{path:u}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=h,this.canvas.requestRenderAll()},_getOptimizedRects:function(h){var r={},l,c,i;for(c=0,i=h.length;c<i;c++)l=h[c].left+""+h[c].top,r[l]||(r[l]=h[c]);var n=[];for(l in r)n.push(r[l]);return n},render:function(h){var r=this.canvas.contextTop,l,c;for(r.fillStyle=this.color,this._saveAndTransform(r),l=0,c=h.length;l<c;l++){var i=h[l];typeof i.opacity!="undefined"&&(r.globalAlpha=i.opacity),r.fillRect(i.x,i.y,i.width,i.width)}r.restore()},_render:function(){var h=this.canvas.contextTop,r,l;for(h.fillStyle=this.color,this._saveAndTransform(h),r=0,l=this.sprayChunks.length;r<l;r++)this.render(this.sprayChunks[r]);h.restore()},addSprayChunk:function(h){this.sprayChunkPoints=[];var r,l,c,i=this.width/2,n;for(n=0;n<this.density;n++){r=t.util.getRandomInt(h.x-i,h.x+i),l=t.util.getRandomInt(h.y-i,h.y+i),this.dotWidthVariance?c=t.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):c=this.dotWidth;var e=new t.Point(r,l);e.width=c,this.randomOpacity&&(e.opacity=t.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(e)}this.sprayChunks.push(this.sprayChunkPoints)}}),t.PatternBrush=t.util.createClass(t.PencilBrush,{getPatternSrc:function(){var h=20,r=5,l=t.util.createCanvasElement(),c=l.getContext("2d");return l.width=l.height=h+r,c.fillStyle=this.color,c.beginPath(),c.arc(h/2,h/2,h/2,0,Math.PI*2,!1),c.closePath(),c.fill(),l},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles"),this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(h){var r=this.callSuper("createPath",h),l=r._getLeftTopCoords().scalarAdd(r.strokeWidth/2);return r.stroke=new t.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-l.x,offsetY:-l.y}),r}}),function(){var h=t.util.getPointer,r=t.util.degreesToRadians,l=t.util.isTouchEvent;t.Canvas=t.util.createClass(t.StaticCanvas,{initialize:function(i,n){n||(n={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(i,n),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=t.PencilBrush&&new t.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var i=this.getActiveObjects(),n,e,o;if(i.length>0&&!this.preserveObjectStacking){e=[],o=[];for(var u=0,s=this._objects.length;u<s;u++)n=this._objects[u],i.indexOf(n)===-1?e.push(n):o.push(n);i.length>1&&(this._activeObject._objects=o),e.push.apply(e,o)}else e=this._objects;return e},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&this.renderTopLayer(this.contextTop);var i=this.contextContainer;return this.renderCanvas(i,this._chooseObjectsToRender()),this},renderTopLayer:function(i){i.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(i),this.contextTopDirty=!0),i.restore()},renderTop:function(){var i=this.contextTop;return this.clearContext(i),this.renderTopLayer(i),this.fire("after:render"),this},_normalizePointer:function(i,n){var e=i.calcTransformMatrix(),o=t.util.invertTransform(e),u=this.restorePointerVpt(n);return t.util.transformPoint(u,o)},isTargetTransparent:function(i,n,e){if(i.shouldCache()&&i._cacheCanvas&&i!==this._activeObject){var o=this._normalizePointer(i,{x:n,y:e}),u=Math.max(i.cacheTranslationX+o.x*i.zoomX,0),s=Math.max(i.cacheTranslationY+o.y*i.zoomY,0),m=t.util.isTransparent(i._cacheContext,Math.round(u),Math.round(s),this.targetFindTolerance);return m}var f=this.contextCache,d=i.selectionBackgroundColor,p=this.viewportTransform;i.selectionBackgroundColor="",this.clearContext(f),f.save(),f.transform(p[0],p[1],p[2],p[3],p[4],p[5]),i.render(f),f.restore(),i.selectionBackgroundColor=d;var m=t.util.isTransparent(f,n,e,this.targetFindTolerance);return m},_isSelectionKeyPressed:function(i){var n=!1;return Object.prototype.toString.call(this.selectionKey)==="[object Array]"?n=!!this.selectionKey.find(function(e){return i[e]===!0}):n=i[this.selectionKey],n},_shouldClearSelection:function(i,n){var e=this.getActiveObjects(),o=this._activeObject;return!n||n&&o&&e.length>1&&e.indexOf(n)===-1&&o!==n&&!this._isSelectionKeyPressed(i)||n&&!n.evented||n&&!n.selectable&&o&&o!==n},_shouldCenterTransform:function(i,n,e){if(!!i){var o;return n==="scale"||n==="scaleX"||n==="scaleY"||n==="resizing"?o=this.centeredScaling||i.centeredScaling:n==="rotate"&&(o=this.centeredRotation||i.centeredRotation),o?!e:e}},_getOriginFromCorner:function(i,n){var e={x:i.originX,y:i.originY};return n==="ml"||n==="tl"||n==="bl"?e.x="right":(n==="mr"||n==="tr"||n==="br")&&(e.x="left"),n==="tl"||n==="mt"||n==="tr"?e.y="bottom":(n==="bl"||n==="mb"||n==="br")&&(e.y="top"),e},_getActionFromCorner:function(i,n,e,o){if(!n||!i)return"drag";var u=o.controls[n];return u.getActionName(e,u,o)},_setupCurrentTransform:function(i,n,e){if(!!n){var o=this.getPointer(i),u=n.__corner,s=n.controls[u],f=e&&u?s.getActionHandler(i,n,s):t.controlsUtils.dragHandler,d=this._getActionFromCorner(e,u,i,n),p=this._getOriginFromCorner(n,u),m=i[this.centeredKey],y={target:n,action:d,actionHandler:f,corner:u,scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,offsetX:o.x-n.left,offsetY:o.y-n.top,originX:p.x,originY:p.y,ex:o.x,ey:o.y,lastX:o.x,lastY:o.y,theta:r(n.angle),width:n.width*n.scaleX,shiftKey:i.shiftKey,altKey:m,original:t.util.saveObjectTransform(n)};this._shouldCenterTransform(n,d,m)&&(y.originX="center",y.originY="center"),y.original.originX=p.x,y.original.originY=p.y,this._currentTransform=y,this._beforeTransform(i)}},setCursor:function(i){this.upperCanvasEl.style.cursor=i},_drawSelection:function(i){var n=this._groupSelector,e=new t.Point(n.ex,n.ey),o=t.util.transformPoint(e,this.viewportTransform),u=new t.Point(n.ex+n.left,n.ey+n.top),s=t.util.transformPoint(u,this.viewportTransform),f=Math.min(o.x,s.x),d=Math.min(o.y,s.y),p=Math.max(o.x,s.x),m=Math.max(o.y,s.y),y=this.selectionLineWidth/2;this.selectionColor&&(i.fillStyle=this.selectionColor,i.fillRect(f,d,p-f,m-d)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(i.lineWidth=this.selectionLineWidth,i.strokeStyle=this.selectionBorderColor,f+=y,d+=y,p-=y,m-=y,t.Object.prototype._setLineDash.call(this,i,this.selectionDashArray),i.strokeRect(f,d,p-f,m-d))},findTarget:function(i,n){if(!this.skipTargetFind){var e=!0,o=this.getPointer(i,e),u=this._activeObject,s=this.getActiveObjects(),f,d,p=l(i),m=s.length>1&&!n||s.length===1;if(this.targets=[],m&&u._findTargetCorner(o,p)||s.length>1&&!n&&u===this._searchPossibleTargets([u],o))return u;if(s.length===1&&u===this._searchPossibleTargets([u],o))if(this.preserveObjectStacking)f=u,d=this.targets,this.targets=[];else return u;var y=this._searchPossibleTargets(this._objects,o);return i[this.altSelectionKey]&&y&&f&&y!==f&&(y=f,this.targets=d),y}},_checkTarget:function(i,n,e){if(n&&n.visible&&n.evented&&n.containsPoint(i))if((this.perPixelTargetFind||n.perPixelTargetFind)&&!n.isEditing){var o=this.isTargetTransparent(n,e.x,e.y);if(!o)return!0}else return!0},_searchPossibleTargets:function(i,n){for(var e,o=i.length,u;o--;){var s=i[o],f=s.group?this._normalizePointer(s.group,n):n;if(this._checkTarget(f,s,n)){e=i[o],e.subTargetCheck&&e instanceof t.Group&&(u=this._searchPossibleTargets(e._objects,n),u&&this.targets.push(u));break}}return e},restorePointerVpt:function(i){return t.util.transformPoint(i,t.util.invertTransform(this.viewportTransform))},getPointer:function(i,n){if(this._absolutePointer&&!n)return this._absolutePointer;if(this._pointer&&n)return this._pointer;var e=h(i),o=this.upperCanvasEl,u=o.getBoundingClientRect(),s=u.width||0,f=u.height||0,d;(!s||!f)&&("top"in u&&"bottom"in u&&(f=Math.abs(u.top-u.bottom)),"right"in u&&"left"in u&&(s=Math.abs(u.right-u.left))),this.calcOffset(),e.x=e.x-this._offset.left,e.y=e.y-this._offset.top,n||(e=this.restorePointerVpt(e));var p=this.getRetinaScaling();return p!==1&&(e.x/=p,e.y/=p),s===0||f===0?d={width:1,height:1}:d={width:o.width/s,height:o.height/f},{x:e.x*d.width,y:e.y*d.height}},_createUpperCanvas:function(){var i=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),n=this.lowerCanvasEl,e=this.upperCanvasEl;e?e.className="":(e=this._createCanvasElement(),this.upperCanvasEl=e),t.util.addClass(e,"upper-canvas "+i),this.wrapperEl.appendChild(e),this._copyCanvasStyle(n,e),this._applyCanvasStyle(e),this.contextTop=e.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=t.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),t.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),t.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(i){var n=this.width||i.width,e=this.height||i.height;t.util.setStyle(i,{position:"absolute",width:n+"px",height:e+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),i.width=n,i.height=e,t.util.makeElementUnselectable(i)},_copyCanvasStyle:function(i,n){n.style.cssText=i.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var i=this._activeObject;return i?i.type==="activeSelection"&&i._objects?i._objects.slice(0):[i]:[]},_onObjectRemoved:function(i){i===this._activeObject&&(this.fire("before:selection:cleared",{target:i}),this._discardActiveObject(),this.fire("selection:cleared",{target:i}),i.fire("deselected")),i===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",i)},_fireSelectionEvents:function(i,n){var e=!1,o=this.getActiveObjects(),u=[],s=[];i.forEach(function(f){o.indexOf(f)===-1&&(e=!0,f.fire("deselected",{e:n,target:f}),s.push(f))}),o.forEach(function(f){i.indexOf(f)===-1&&(e=!0,f.fire("selected",{e:n,target:f}),u.push(f))}),i.length>0&&o.length>0?e&&this.fire("selection:updated",{e:n,selected:u,deselected:s,updated:u[0]||s[0],target:this._activeObject}):o.length>0?this.fire("selection:created",{e:n,selected:u,target:this._activeObject}):i.length>0&&this.fire("selection:cleared",{e:n,deselected:s})},setActiveObject:function(i,n){var e=this.getActiveObjects();return this._setActiveObject(i,n),this._fireSelectionEvents(e,n),this},_setActiveObject:function(i,n){return this._activeObject===i||!this._discardActiveObject(n,i)||i.onSelect({e:n})?!1:(this._activeObject=i,!0)},_discardActiveObject:function(i,n){var e=this._activeObject;if(e){if(e.onDeselect({e:i,object:n}))return!1;this._activeObject=null}return!0},discardActiveObject:function(i){var n=this.getActiveObjects(),e=this.getActiveObject();return n.length&&this.fire("before:selection:cleared",{target:e,e:i}),this._discardActiveObject(i),this._fireSelectionEvents(n,i),this},dispose:function(){var i=this.wrapperEl;return this.removeListeners(),i.removeChild(this.upperCanvasEl),i.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(n){t.util.cleanUpJsdomNode(this[n]),this[n]=void 0}.bind(this)),i.parentNode&&i.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,t.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(i){var n=this._activeObject;n&&n._renderControls(i)},_toObject:function(i,n,e){var o=this._realizeGroupTransformOnObject(i),u=this.callSuper("_toObject",i,n,e);return this._unwindGroupTransformOnObject(i,o),u},_realizeGroupTransformOnObject:function(i){if(i.group&&i.group.type==="activeSelection"&&this._activeObject===i.group){var n=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],e={};return n.forEach(function(o){e[o]=i[o]}),t.util.addTransformToObject(i,this._activeObject.calcOwnMatrix()),e}else return null},_unwindGroupTransformOnObject:function(i,n){n&&i.set(n)},_setSVGObject:function(i,n,e){var o=this._realizeGroupTransformOnObject(n);this.callSuper("_setSVGObject",i,n,e),this._unwindGroupTransformOnObject(n,o)},setViewportTransform:function(i){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),t.StaticCanvas.prototype.setViewportTransform.call(this,i)}});for(var c in t.StaticCanvas)c!=="prototype"&&(t.Canvas[c]=t.StaticCanvas[c])}(),function(){var h=t.util.addListener,r=t.util.removeListener,l=3,c=2,i=1,n={passive:!1};function e(o,u){return o.button&&o.button===u-1}t.util.object.extend(t.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(h,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(o,u){var s=this.upperCanvasEl,f=this._getEventPrefix();o(t.window,"resize",this._onResize),o(s,f+"down",this._onMouseDown),o(s,f+"move",this._onMouseMove,n),o(s,f+"out",this._onMouseOut),o(s,f+"enter",this._onMouseEnter),o(s,"wheel",this._onMouseWheel),o(s,"contextmenu",this._onContextMenu),o(s,"dblclick",this._onDoubleClick),o(s,"dragover",this._onDragOver),o(s,"dragenter",this._onDragEnter),o(s,"dragleave",this._onDragLeave),o(s,"drop",this._onDrop),this.enablePointerEvents||o(s,"touchstart",this._onTouchStart,n),typeof eventjs!="undefined"&&u in eventjs&&(eventjs[u](s,"gesture",this._onGesture),eventjs[u](s,"drag",this._onDrag),eventjs[u](s,"orientation",this._onOrientationChange),eventjs[u](s,"shake",this._onShake),eventjs[u](s,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(r,"remove");var o=this._getEventPrefix();r(t.document,o+"up",this._onMouseUp),r(t.document,"touchend",this._onTouchEnd,n),r(t.document,o+"move",this._onMouseMove,n),r(t.document,"touchmove",this._onMouseMove,n)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._simpleEventHandler.bind(this,"drop"),this.eventsBound=!0)},_onGesture:function(o,u){this.__onTransformGesture&&this.__onTransformGesture(o,u)},_onDrag:function(o,u){this.__onDrag&&this.__onDrag(o,u)},_onMouseWheel:function(o){this.__onMouseWheel(o)},_onMouseOut:function(o){var u=this._hoveredTarget;this.fire("mouse:out",{target:u,e:o}),this._hoveredTarget=null,u&&u.fire("mouseout",{e:o});var s=this;this._hoveredTargets.forEach(function(f){s.fire("mouse:out",{target:u,e:o}),f&&u.fire("mouseout",{e:o})}),this._hoveredTargets=[],this._iTextInstances&&this._iTextInstances.forEach(function(f){f.isEditing&&f.hiddenTextarea.focus()})},_onMouseEnter:function(o){!this._currentTransform&&!this.findTarget(o)&&(this.fire("mouse:over",{target:null,e:o}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(o,u){this.__onOrientationChange&&this.__onOrientationChange(o,u)},_onShake:function(o,u){this.__onShake&&this.__onShake(o,u)},_onLongPress:function(o,u){this.__onLongPress&&this.__onLongPress(o,u)},_onDragOver:function(o){o.preventDefault();var u=this._simpleEventHandler("dragover",o);this._fireEnterLeaveEvents(u,o)},_onContextMenu:function(o){return this.stopContextMenu&&(o.stopPropagation(),o.preventDefault()),!1},_onDoubleClick:function(o){this._cacheTransformEventData(o),this._handleEvent(o,"dblclick"),this._resetTransformEventData(o)},getPointerId:function(o){var u=o.changedTouches;return u?u[0]&&u[0].identifier:this.enablePointerEvents?o.pointerId:-1},_isMainEvent:function(o){return o.isPrimary===!0?!0:o.isPrimary===!1?!1:o.type==="touchend"&&o.touches.length===0?!0:o.changedTouches?o.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(o){o.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(o)),this.__onMouseDown(o),this._resetTransformEventData();var u=this.upperCanvasEl,s=this._getEventPrefix();h(t.document,"touchend",this._onTouchEnd,n),h(t.document,"touchmove",this._onMouseMove,n),r(u,s+"down",this._onMouseDown)},_onMouseDown:function(o){this.__onMouseDown(o),this._resetTransformEventData();var u=this.upperCanvasEl,s=this._getEventPrefix();r(u,s+"move",this._onMouseMove,n),h(t.document,s+"up",this._onMouseUp),h(t.document,s+"move",this._onMouseMove,n)},_onTouchEnd:function(o){if(!(o.touches.length>0)){this.__onMouseUp(o),this._resetTransformEventData(),this.mainTouchId=null;var u=this._getEventPrefix();r(t.document,"touchend",this._onTouchEnd,n),r(t.document,"touchmove",this._onMouseMove,n);var s=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){h(s.upperCanvasEl,u+"down",s._onMouseDown),s._willAddMouseDown=0},400)}},_onMouseUp:function(o){this.__onMouseUp(o),this._resetTransformEventData();var u=this.upperCanvasEl,s=this._getEventPrefix();this._isMainEvent(o)&&(r(t.document,s+"up",this._onMouseUp),r(t.document,s+"move",this._onMouseMove,n),h(u,s+"move",this._onMouseMove,n))},_onMouseMove:function(o){!this.allowTouchScrolling&&o.preventDefault&&o.preventDefault(),this.__onMouseMove(o)},_onResize:function(){this.calcOffset()},_shouldRender:function(o){var u=this._activeObject;return!!u!=!!o||u&&o&&u!==o?!0:(u&&u.isEditing,!1)},__onMouseUp:function(o){var u,s=this._currentTransform,f=this._groupSelector,d=!1,p=!f||f.left===0&&f.top===0;if(this._cacheTransformEventData(o),u=this._target,this._handleEvent(o,"up:before"),e(o,l)){this.fireRightClick&&this._handleEvent(o,"up",l,p);return}if(e(o,c)){this.fireMiddleClick&&this._handleEvent(o,"up",c,p),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(o);return}if(!!this._isMainEvent(o)){if(s&&(this._finalizeCurrentTransform(o),d=s.actionPerformed),!p){var m=u===this._activeObject;this._maybeGroupObjects(o),d||(d=this._shouldRender(u)||!m&&u===this._activeObject)}if(u){if(u.selectable&&u!==this._activeObject&&u.activeOn==="up")this.setActiveObject(u,o),d=!0;else{var y=u._findTargetCorner(this.getPointer(o,!0),t.util.isTouchEvent(o)),S=u.controls[y],O=S&&S.getMouseUpHandler(o,u,S);if(O){var R=this.getPointer(o);O(o,s,R.x,R.y)}}u.isMoving=!1}this._setCursorFromEvent(o,u),this._handleEvent(o,"up",i,p),this._groupSelector=null,this._currentTransform=null,u&&(u.__corner=0),d?this.requestRenderAll():p||this.renderTop()}},_simpleEventHandler:function(o,u){var s=this.findTarget(u),f=this.targets,d={e:u,target:s,subTargets:f};if(this.fire(o,d),s&&s.fire(o,d),!f)return s;for(var p=0;p<f.length;p++)f[p].fire(o,d);return s},_handleEvent:function(o,u,s,f){var d=this._target,p=this.targets||[],m={e:o,target:d,subTargets:p,button:s||i,isClick:f||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};u==="up"&&(m.currentTarget=this.findTarget(o),m.currentSubTargets=this.targets),this.fire("mouse:"+u,m),d&&d.fire("mouse"+u,m);for(var y=0;y<p.length;y++)p[y].fire("mouse"+u,m)},_finalizeCurrentTransform:function(o){var u=this._currentTransform,s=u.target,f,d={e:o,target:s,transform:u,action:u.action};s._scaling&&(s._scaling=!1),s.setCoords(),(u.actionPerformed||this.stateful&&s.hasStateChanged())&&(u.actionPerformed&&(f=this._addEventOptions(d,u),this._fire(f,d)),this._fire("modified",d))},_addEventOptions:function(o,u){var s,f;switch(u.action){case"scaleX":s="scaled",f="x";break;case"scaleY":s="scaled",f="y";break;case"skewX":s="skewed",f="x";break;case"skewY":s="skewed",f="y";break;case"scale":s="scaled",f="equally";break;case"rotate":s="rotated";break;case"drag":s="moved";break}return o.by=f,s},_onMouseDownInDrawingMode:function(o){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(o).requestRenderAll();var u=this.getPointer(o);this.freeDrawingBrush.onMouseDown(u,{e:o,pointer:u}),this._handleEvent(o,"down")},_onMouseMoveInDrawingMode:function(o){if(this._isCurrentlyDrawing){var u=this.getPointer(o);this.freeDrawingBrush.onMouseMove(u,{e:o,pointer:u})}this.setCursor(this.freeDrawingCursor),this._handleEvent(o,"move")},_onMouseUpInDrawingMode:function(o){var u=this.getPointer(o);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:o,pointer:u}),this._handleEvent(o,"up")},__onMouseDown:function(o){this._cacheTransformEventData(o),this._handleEvent(o,"down:before");var u=this._target;if(e(o,l)){this.fireRightClick&&this._handleEvent(o,"down",l);return}if(e(o,c)){this.fireMiddleClick&&this._handleEvent(o,"down",c);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(o);return}if(!!this._isMainEvent(o)&&!this._currentTransform){var s=this._pointer;this._previousPointer=s;var f=this._shouldRender(u),d=this._shouldGroup(o,u);if(this._shouldClearSelection(o,u)?this.discardActiveObject(o):d&&(this._handleGrouping(o,u),u=this._activeObject),this.selection&&(!u||!u.selectable&&!u.isEditing&&u!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),u){var p=u===this._activeObject;u.selectable&&u.activeOn==="down"&&this.setActiveObject(u,o);var m=u._findTargetCorner(this.getPointer(o,!0),t.util.isTouchEvent(o));if(u.__corner=m,u===this._activeObject&&(m||!d)){this._setupCurrentTransform(o,u,p);var y=u.controls[m],s=this.getPointer(o),S=y&&y.getMouseDownHandler(o,u,y);S&&S(o,this._currentTransform,s.x,s.y)}}this._handleEvent(o,"down"),(f||d)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(o){this._resetTransformEventData(),this._pointer=this.getPointer(o,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(o)||null},_beforeTransform:function(o){var u=this._currentTransform;this.stateful&&u.target.saveState(),this.fire("before:transform",{e:o,transform:u})},__onMouseMove:function(o){this._handleEvent(o,"move:before"),this._cacheTransformEventData(o);var u,s;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(o);return}if(!!this._isMainEvent(o)){var f=this._groupSelector;f?(s=this._absolutePointer,f.left=s.x-f.ex,f.top=s.y-f.ey,this.renderTop()):this._currentTransform?this._transformObject(o):(u=this.findTarget(o)||null,this._setCursorFromEvent(o,u),this._fireOverOutEvents(u,o)),this._handleEvent(o,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(o,u){var s=this._hoveredTarget,f=this._hoveredTargets,d=this.targets,p=Math.max(f.length,d.length);this.fireSyntheticInOutEvents(o,u,{oldTarget:s,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var m=0;m<p;m++)this.fireSyntheticInOutEvents(d[m],u,{oldTarget:f[m],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=o,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(o,u){var s=this._draggedoverTarget,f=this._hoveredTargets,d=this.targets,p=Math.max(f.length,d.length);this.fireSyntheticInOutEvents(o,u,{oldTarget:s,evtOut:"dragleave",evtIn:"dragenter"});for(var m=0;m<p;m++)this.fireSyntheticInOutEvents(d[m],u,{oldTarget:f[m],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=o},fireSyntheticInOutEvents:function(o,u,s){var f,d,p=s.oldTarget,m,y,S=p!==o,O=s.canvasEvtIn,R=s.canvasEvtOut;S&&(f={e:u,target:o,previousTarget:p},d={e:u,target:p,nextTarget:o}),y=o&&S,m=p&&S,m&&(R&&this.fire(R,d),p.fire(s.evtOut,d)),y&&(O&&this.fire(O,f),o.fire(s.evtIn,f))},__onMouseWheel:function(o){this._cacheTransformEventData(o),this._handleEvent(o,"wheel"),this._resetTransformEventData()},_transformObject:function(o){var u=this.getPointer(o),s=this._currentTransform;s.reset=!1,s.shiftKey=o.shiftKey,s.altKey=o[this.centeredKey],this._performTransformAction(o,s,u),s.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(o,u,s){var f=s.x,d=s.y,p=u.action,m=!1,y=u.actionHandler;y&&(m=y(o,u,f,d)),p==="drag"&&m&&(u.target.isMoving=!0,this.setCursor(u.target.moveCursor||this.moveCursor)),u.actionPerformed=u.actionPerformed||m},_fire:t.controlsUtils.fireEvent,_setCursorFromEvent:function(o,u){if(!u)return this.setCursor(this.defaultCursor),!1;var s=u.hoverCursor||this.hoverCursor,f=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,d=(!f||!f.contains(u))&&u._findTargetCorner(this.getPointer(o,!0));d?this.setCursor(this.getCornerCursor(d,u,o)):(u.subTargetCheck&&this.targets.concat().reverse().map(function(p){s=p.hoverCursor||s}),this.setCursor(s))},getCornerCursor:function(o,u,s){var f=u.controls[o];return f.cursorStyleHandler(s,f,u)}})}(),function(){var h=Math.min,r=Math.max;t.util.object.extend(t.Canvas.prototype,{_shouldGroup:function(l,c){var i=this._activeObject;return i&&this._isSelectionKeyPressed(l)&&c&&c.selectable&&this.selection&&(i!==c||i.type==="activeSelection")&&!c.onSelect({e:l})},_handleGrouping:function(l,c){var i=this._activeObject;i.__corner||c===i&&(c=this.findTarget(l,!0),!c||!c.selectable)||(i&&i.type==="activeSelection"?this._updateActiveSelection(c,l):this._createActiveSelection(c,l))},_updateActiveSelection:function(l,c){var i=this._activeObject,n=i._objects.slice(0);i.contains(l)?(i.removeWithUpdate(l),this._hoveredTarget=l,this._hoveredTargets=this.targets.concat(),i.size()===1&&this._setActiveObject(i.item(0),c)):(i.addWithUpdate(l),this._hoveredTarget=i,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(n,c)},_createActiveSelection:function(l,c){var i=this.getActiveObjects(),n=this._createGroup(l);this._hoveredTarget=n,this._setActiveObject(n,c),this._fireSelectionEvents(i,c)},_createGroup:function(l){var c=this._objects,i=c.indexOf(this._activeObject)<c.indexOf(l),n=i?[this._activeObject,l]:[l,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new t.ActiveSelection(n,{canvas:this})},_groupSelectedObjects:function(l){var c=this._collectObjects(l),i;c.length===1?this.setActiveObject(c[0],l):c.length>1&&(i=new t.ActiveSelection(c.reverse(),{canvas:this}),this.setActiveObject(i,l))},_collectObjects:function(l){for(var c=[],i,n=this._groupSelector.ex,e=this._groupSelector.ey,o=n+this._groupSelector.left,u=e+this._groupSelector.top,s=new t.Point(h(n,o),h(e,u)),f=new t.Point(r(n,o),r(e,u)),d=!this.selectionFullyContained,p=n===o&&e===u,m=this._objects.length;m--&&(i=this._objects[m],!(!(!i||!i.selectable||!i.visible)&&(d&&i.intersectsWithRect(s,f,!0)||i.isContainedWithinRect(s,f,!0)||d&&i.containsPoint(s,null,!0)||d&&i.containsPoint(f,null,!0))&&(c.push(i),p))););return c.length>1&&(c=c.filter(function(y){return!y.onSelect({e:l})})),c},_maybeGroupObjects:function(l){this.selection&&this._groupSelector&&this._groupSelectedObjects(l),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){t.util.object.extend(t.StaticCanvas.prototype,{toDataURL:function(h){h||(h={});var r=h.format||"png",l=h.quality||1,c=(h.multiplier||1)*(h.enableRetinaScaling?this.getRetinaScaling():1),i=this.toCanvasElement(c,h);return t.util.toDataURL(i,r,l)},toCanvasElement:function(h,r){h=h||1,r=r||{};var l=(r.width||this.width)*h,c=(r.height||this.height)*h,i=this.getZoom(),n=this.width,e=this.height,o=i*h,u=this.viewportTransform,s=(u[4]-(r.left||0))*h,f=(u[5]-(r.top||0))*h,d=this.interactive,p=[o,0,0,o,s,f],m=this.enableRetinaScaling,y=t.util.createCanvasElement(),S=this.contextTop;return y.width=l,y.height=c,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=p,this.width=l,this.height=c,this.calcViewportBoundaries(),this.renderCanvas(y.getContext("2d"),this._objects),this.viewportTransform=u,this.width=n,this.height=e,this.calcViewportBoundaries(),this.interactive=d,this.enableRetinaScaling=m,this.contextTop=S,y}})}(),t.util.object.extend(t.StaticCanvas.prototype,{loadFromJSON:function(h,r,l){if(!!h){var c=typeof h=="string"?JSON.parse(h):t.util.object.clone(h),i=this,n=c.clipPath,e=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete c.clipPath,this._enlivenObjects(c.objects,function(o){i.clear(),i._setBgOverlay(c,function(){n?i._enlivenObjects([n],function(u){i.clipPath=u[0],i.__setupCanvas.call(i,c,o,e,r)}):i.__setupCanvas.call(i,c,o,e,r)})},l),this}},__setupCanvas:function(h,r,l,c){var i=this;r.forEach(function(n,e){i.insertAt(n,e)}),this.renderOnAddRemove=l,delete h.objects,delete h.backgroundImage,delete h.overlayImage,delete h.background,delete h.overlay,this._setOptions(h),this.renderAll(),c&&c()},_setBgOverlay:function(h,r){var l={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!h.backgroundImage&&!h.overlayImage&&!h.background&&!h.overlay){r&&r();return}var c=function(){l.backgroundImage&&l.overlayImage&&l.backgroundColor&&l.overlayColor&&r&&r()};this.__setBgOverlay("backgroundImage",h.backgroundImage,l,c),this.__setBgOverlay("overlayImage",h.overlayImage,l,c),this.__setBgOverlay("backgroundColor",h.background,l,c),this.__setBgOverlay("overlayColor",h.overlay,l,c)},__setBgOverlay:function(h,r,l,c){var i=this;if(!r){l[h]=!0,c&&c();return}h==="backgroundImage"||h==="overlayImage"?t.util.enlivenObjects([r],function(n){i[h]=n[0],l[h]=!0,c&&c()}):this["set"+t.util.string.capitalize(h,!0)](r,function(){l[h]=!0,c&&c()})},_enlivenObjects:function(h,r,l){if(!h||h.length===0){r&&r([]);return}t.util.enlivenObjects(h,function(c){r&&r(c)},null,l)},_toDataURL:function(h,r){this.clone(function(l){r(l.toDataURL(h))})},_toDataURLWithMultiplier:function(h,r,l){this.clone(function(c){l(c.toDataURLWithMultiplier(h,r))})},clone:function(h,r){var l=JSON.stringify(this.toJSON(r));this.cloneWithoutData(function(c){c.loadFromJSON(l,function(){h&&h(c)})})},cloneWithoutData:function(h){var r=t.util.createCanvasElement();r.width=this.width,r.height=this.height;var l=new t.Canvas(r);this.backgroundImage?(l.setBackgroundImage(this.backgroundImage.src,function(){l.renderAll(),h&&h(l)}),l.backgroundImageOpacity=this.backgroundImageOpacity,l.backgroundImageStretch=this.backgroundImageStretch):h&&h(l)}}),function(h){var r=h.fabric||(h.fabric={}),l=r.util.object.extend,c=r.util.object.clone,i=r.util.toFixed,n=r.util.string.capitalize,e=r.util.degreesToRadians,o=!r.isLikelyNode,u=2;r.Object||(r.Object=r.util.createClass(r.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:o,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(s){s&&this.setOptions(s)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=r.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(s){var f=r.perfLimitSizeTotal,d=s.width,p=s.height,m=r.maxCacheSideLimit,y=r.minCacheSideLimit;if(d<=m&&p<=m&&d*p<=f)return d<y&&(s.width=y),p<y&&(s.height=y),s;var S=d/p,O=r.util.limitDimsByArea(S,f),R=r.util.capValue,Y=R(y,O.x,m),q=R(y,O.y,m);return d>Y&&(s.zoomX/=d/Y,s.width=Y,s.capped=!0),p>q&&(s.zoomY/=p/q,s.height=q,s.capped=!0),s},_getCacheCanvasDimensions:function(){var s=this.getTotalObjectScaling(),f=this._getTransformedDimensions(0,0),d=f.x*s.scaleX/this.scaleX,p=f.y*s.scaleY/this.scaleY;return{width:d+u,height:p+u,zoomX:s.scaleX,zoomY:s.scaleY,x:d,y:p}},_updateCacheCanvas:function(){var s=this.canvas;if(this.noScaleCache&&s&&s._currentTransform){var f=s._currentTransform.target,d=s._currentTransform.action;if(this===f&&d.slice&&d.slice(0,5)==="scale")return!1}var p=this._cacheCanvas,m=this._limitCacheSize(this._getCacheCanvasDimensions()),y=r.minCacheSideLimit,S=m.width,O=m.height,R,Y,q=m.zoomX,tt=m.zoomY,Z=S!==this.cacheWidth||O!==this.cacheHeight,it=this.zoomX!==q||this.zoomY!==tt,et=Z||it,ot=0,at=0,st=!1;if(Z){var nt=this._cacheCanvas.width,D=this._cacheCanvas.height,G=S>nt||O>D,F=(S<nt*.9||O<D*.9)&&nt>y&&D>y;st=G||F,G&&!m.capped&&(S>y||O>y)&&(ot=S*.1,at=O*.1)}return this instanceof r.Text&&this.path&&(et=!0,st=!0,ot+=this.getHeightOfLine(0)*this.zoomX,at+=this.getHeightOfLine(0)*this.zoomY),et?(st?(p.width=Math.ceil(S+ot),p.height=Math.ceil(O+at)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,p.width,p.height)),R=m.x/2,Y=m.y/2,this.cacheTranslationX=Math.round(p.width/2-R)+R,this.cacheTranslationY=Math.round(p.height/2-Y)+Y,this.cacheWidth=S,this.cacheHeight=O,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(q,tt),this.zoomX=q,this.zoomY=tt,!0):!1},setOptions:function(s){this._setOptions(s),this._initGradient(s.fill,"fill"),this._initGradient(s.stroke,"stroke"),this._initPattern(s.fill,"fill"),this._initPattern(s.stroke,"stroke")},transform:function(s){var f=this.group&&!this.group._transformDone||this.group&&this.canvas&&s===this.canvas.contextTop,d=this.calcTransformMatrix(!f);s.transform(d[0],d[1],d[2],d[3],d[4],d[5])},toObject:function(s){var f=r.Object.NUM_FRACTION_DIGITS,d={type:this.type,version:r.version,originX:this.originX,originY:this.originY,left:i(this.left,f),top:i(this.top,f),width:i(this.width,f),height:i(this.height,f),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:i(this.strokeWidth,f),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:i(this.strokeMiterLimit,f),scaleX:i(this.scaleX,f),scaleY:i(this.scaleY,f),angle:i(this.angle,f),flipX:this.flipX,flipY:this.flipY,opacity:i(this.opacity,f),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:i(this.skewX,f),skewY:i(this.skewY,f)};return this.clipPath&&!this.clipPath.excludeFromExport&&(d.clipPath=this.clipPath.toObject(s),d.clipPath.inverted=this.clipPath.inverted,d.clipPath.absolutePositioned=this.clipPath.absolutePositioned),r.util.populateWithProperties(this,d,s),this.includeDefaultValues||(d=this._removeDefaultValues(d)),d},toDatalessObject:function(s){return this.toObject(s)},_removeDefaultValues:function(s){var f=r.util.getKlass(s.type).prototype,d=f.stateProperties;return d.forEach(function(p){if(!(p==="left"||p==="top")){s[p]===f[p]&&delete s[p];var m=Object.prototype.toString.call(s[p])==="[object Array]"&&Object.prototype.toString.call(f[p])==="[object Array]";m&&s[p].length===0&&f[p].length===0&&delete s[p]}}),s},toString:function(){return"#<fabric."+n(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var s=r.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(s.scaleX),scaleY:Math.abs(s.scaleY)}},getTotalObjectScaling:function(){var s=this.getObjectScaling(),f=s.scaleX,d=s.scaleY;if(this.canvas){var p=this.canvas.getZoom(),m=this.canvas.getRetinaScaling();f*=p*m,d*=p*m}return{scaleX:f,scaleY:d}},getObjectOpacity:function(){var s=this.opacity;return this.group&&(s*=this.group.getObjectOpacity()),s},_set:function(s,f){var d=s==="scaleX"||s==="scaleY",p=this[s]!==f,m=!1;return d&&(f=this._constrainScale(f)),s==="scaleX"&&f<0?(this.flipX=!this.flipX,f*=-1):s==="scaleY"&&f<0?(this.flipY=!this.flipY,f*=-1):s==="shadow"&&f&&!(f instanceof r.Shadow)?f=new r.Shadow(f):s==="dirty"&&this.group&&this.group.set("dirty",f),this[s]=f,p&&(m=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(s)>-1?(this.dirty=!0,m&&this.group.set("dirty",!0)):m&&this.stateProperties.indexOf(s)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:r.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(s){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(s.save(),this._setupCompositeOperation(s),this.drawSelectionBackground(s),this.transform(s),this._setOpacity(s),this._setShadow(s,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(s)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(s),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),s.restore())},renderCache:function(s){s=s||{},this._cacheCanvas||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,s.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(s){var f=this.clipPath;if(s.save(),f.inverted?s.globalCompositeOperation="destination-out":s.globalCompositeOperation="destination-in",f.absolutePositioned){var d=r.util.invertTransform(this.calcTransformMatrix());s.transform(d[0],d[1],d[2],d[3],d[4],d[5])}f.transform(s),s.scale(1/f.zoomX,1/f.zoomY),s.drawImage(f._cacheCanvas,-f.cacheTranslationX,-f.cacheTranslationY),s.restore()},drawObject:function(s,f){var d=this.fill,p=this.stroke;f?(this.fill="black",this.stroke="",this._setClippingProperties(s)):this._renderBackground(s),this._render(s),this._drawClipPath(s),this.fill=d,this.stroke=p},_drawClipPath:function(s){var f=this.clipPath;!f||(f.canvas=this.canvas,f.shouldCache(),f._transformDone=!0,f.renderCache({forClipping:!0}),this.drawClipPathOnCache(s))},drawCacheOnCanvas:function(s){s.scale(1/this.zoomX,1/this.zoomY),s.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(s){if(this.isNotVisible())return!1;if(this._cacheCanvas&&!s&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&!s){var f=this.cacheWidth/this.zoomX,d=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-f/2,-d/2,f,d)}return!0}return!1},_renderBackground:function(s){if(!!this.backgroundColor){var f=this._getNonTransformedDimensions();s.fillStyle=this.backgroundColor,s.fillRect(-f.x/2,-f.y/2,f.x,f.y),this._removeShadow(s)}},_setOpacity:function(s){this.group&&!this.group._transformDone?s.globalAlpha=this.getObjectOpacity():s.globalAlpha*=this.opacity},_setStrokeStyles:function(s,f){var d=f.stroke;d&&(s.lineWidth=f.strokeWidth,s.lineCap=f.strokeLineCap,s.lineDashOffset=f.strokeDashOffset,s.lineJoin=f.strokeLineJoin,s.miterLimit=f.strokeMiterLimit,d.toLive?d.gradientUnits==="percentage"||d.gradientTransform||d.patternTransform?this._applyPatternForTransformedGradient(s,d):(s.strokeStyle=d.toLive(s,this),this._applyPatternGradientTransform(s,d)):s.strokeStyle=f.stroke)},_setFillStyles:function(s,f){var d=f.fill;d&&(d.toLive?(s.fillStyle=d.toLive(s,this),this._applyPatternGradientTransform(s,f.fill)):s.fillStyle=d)},_setClippingProperties:function(s){s.globalAlpha=1,s.strokeStyle="transparent",s.fillStyle="#000000"},_setLineDash:function(s,f){!f||f.length===0||(1&f.length&&f.push.apply(f,f),s.setLineDash(f))},_renderControls:function(s,f){var d=this.getViewportTransform(),p=this.calcTransformMatrix(),m,y,S;f=f||{},y=typeof f.hasBorders!="undefined"?f.hasBorders:this.hasBorders,S=typeof f.hasControls!="undefined"?f.hasControls:this.hasControls,p=r.util.multiplyTransformMatrices(d,p),m=r.util.qrDecompose(p),s.save(),s.translate(m.translateX,m.translateY),s.lineWidth=1*this.borderScaleFactor,this.group||(s.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),s.rotate(e(m.angle)),f.forActiveSelection||this.group?y&&this.drawBordersInGroup(s,m,f):y&&this.drawBorders(s,f),S&&this.drawControls(s,f),s.restore()},_setShadow:function(s){if(!!this.shadow){var f=this.shadow,d=this.canvas,p,m=d&&d.viewportTransform[0]||1,y=d&&d.viewportTransform[3]||1;f.nonScaling?p={scaleX:1,scaleY:1}:p=this.getObjectScaling(),d&&d._isRetinaScaling()&&(m*=r.devicePixelRatio,y*=r.devicePixelRatio),s.shadowColor=f.color,s.shadowBlur=f.blur*r.browserShadowBlurConstant*(m+y)*(p.scaleX+p.scaleY)/4,s.shadowOffsetX=f.offsetX*m*p.scaleX,s.shadowOffsetY=f.offsetY*y*p.scaleY}},_removeShadow:function(s){!this.shadow||(s.shadowColor="",s.shadowBlur=s.shadowOffsetX=s.shadowOffsetY=0)},_applyPatternGradientTransform:function(s,f){if(!f||!f.toLive)return{offsetX:0,offsetY:0};var d=f.gradientTransform||f.patternTransform,p=-this.width/2+f.offsetX||0,m=-this.height/2+f.offsetY||0;return f.gradientUnits==="percentage"?s.transform(this.width,0,0,this.height,p,m):s.transform(1,0,0,1,p,m),d&&s.transform(d[0],d[1],d[2],d[3],d[4],d[5]),{offsetX:p,offsetY:m}},_renderPaintInOrder:function(s){this.paintFirst==="stroke"?(this._renderStroke(s),this._renderFill(s)):(this._renderFill(s),this._renderStroke(s))},_render:function(){},_renderFill:function(s){!this.fill||(s.save(),this._setFillStyles(s,this),this.fillRule==="evenodd"?s.fill("evenodd"):s.fill(),s.restore())},_renderStroke:function(s){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(s),s.save(),this.strokeUniform&&this.group){var f=this.getObjectScaling();s.scale(1/f.scaleX,1/f.scaleY)}else this.strokeUniform&&s.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(s,this.strokeDashArray),this._setStrokeStyles(s,this),s.stroke(),s.restore()}},_applyPatternForTransformedGradient:function(s,f){var d=this._limitCacheSize(this._getCacheCanvasDimensions()),p=r.util.createCanvasElement(),m,y=this.canvas.getRetinaScaling(),S=d.x/this.scaleX/y,O=d.y/this.scaleY/y;p.width=S,p.height=O,m=p.getContext("2d"),m.beginPath(),m.moveTo(0,0),m.lineTo(S,0),m.lineTo(S,O),m.lineTo(0,O),m.closePath(),m.translate(S/2,O/2),m.scale(d.zoomX/this.scaleX/y,d.zoomY/this.scaleY/y),this._applyPatternGradientTransform(m,f),m.fillStyle=f.toLive(s),m.fill(),s.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),s.scale(y*this.scaleX/d.zoomX,y*this.scaleY/d.zoomY),s.strokeStyle=m.createPattern(p,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var s=r.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",s.scaleX),this.set("scaleY",s.scaleY),this.angle=s.angle,this.skewX=s.skewX,this.skewY=0}},_removeTransformMatrix:function(s){var f=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),f=r.util.transformPoint(f,this.transformMatrix)),this.transformMatrix=null,s&&(this.scaleX*=s.scaleX,this.scaleY*=s.scaleY,this.cropX=s.cropX,this.cropY=s.cropY,f.x+=s.offsetLeft,f.y+=s.offsetTop,this.width=s.width,this.height=s.height),this.setPositionByOrigin(f,"center","center")},clone:function(s,f){var d=this.toObject(f);this.constructor.fromObject?this.constructor.fromObject(d,s):r.Object._fromObject("Object",d,s)},cloneAsImage:function(s,f){var d=this.toCanvasElement(f);return s&&s(new r.Image(d)),this},toCanvasElement:function(s){s||(s={});var f=r.util,d=f.saveObjectTransform(this),p=this.group,m=this.shadow,y=Math.abs,S=(s.multiplier||1)*(s.enableRetinaScaling?r.devicePixelRatio:1);delete this.group,s.withoutTransform&&f.resetObjectTransform(this),s.withoutShadow&&(this.shadow=null);var O=r.util.createCanvasElement(),R=this.getBoundingRect(!0,!0),Y=this.shadow,q,tt={x:0,y:0},Z,it,et;Y&&(Z=Y.blur,Y.nonScaling?q={scaleX:1,scaleY:1}:q=this.getObjectScaling(),tt.x=2*Math.round(y(Y.offsetX)+Z)*y(q.scaleX),tt.y=2*Math.round(y(Y.offsetY)+Z)*y(q.scaleY)),it=R.width+tt.x,et=R.height+tt.y,O.width=Math.ceil(it),O.height=Math.ceil(et);var ot=new r.StaticCanvas(O,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});s.format==="jpeg"&&(ot.backgroundColor="#fff"),this.setPositionByOrigin(new r.Point(ot.width/2,ot.height/2),"center","center");var at=this.canvas;ot.add(this);var st=ot.toCanvasElement(S||1,s);return this.shadow=m,this.set("canvas",at),p&&(this.group=p),this.set(d).setCoords(),ot._objects=[],ot.dispose(),ot=null,st},toDataURL:function(s){return s||(s={}),r.util.toDataURL(this.toCanvasElement(s),s.format||"png",s.quality||1)},isType:function(s){return this.type===s},complexity:function(){return 1},toJSON:function(s){return this.toObject(s)},rotate:function(s){var f=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return f&&this._setOriginToCenter(),this.set("angle",s),f&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(s,f){f=f||this.canvas.getPointer(s);var d=new r.Point(f.x,f.y),p=this._getLeftTopCoords();return this.angle&&(d=r.util.rotatePoint(d,p,e(-this.angle))),{x:d.x-p.x,y:d.y-p.y}},_setupCompositeOperation:function(s){this.globalCompositeOperation&&(s.globalCompositeOperation=this.globalCompositeOperation)}}),r.util.createAccessors&&r.util.createAccessors(r.Object),l(r.Object.prototype,r.Observable),r.Object.NUM_FRACTION_DIGITS=2,r.Object._fromObject=function(s,f,d,p){var m=r[s];f=c(f,!0),r.util.enlivenPatterns([f.fill,f.stroke],function(y){typeof y[0]!="undefined"&&(f.fill=y[0]),typeof y[1]!="undefined"&&(f.stroke=y[1]),r.util.enlivenObjects([f.clipPath],function(S){f.clipPath=S[0];var O=p?new m(f[p],f):new m(f);d&&d(O)})})},r.Object.__uid=0)}(a),function(){var h=t.util.degreesToRadians,r={left:-.5,center:0,right:.5},l={top:-.5,center:0,bottom:.5};t.util.object.extend(t.Object.prototype,{translateToGivenOrigin:function(c,i,n,e,o){var u=c.x,s=c.y,f,d,p;return typeof i=="string"?i=r[i]:i-=.5,typeof e=="string"?e=r[e]:e-=.5,f=e-i,typeof n=="string"?n=l[n]:n-=.5,typeof o=="string"?o=l[o]:o-=.5,d=o-n,(f||d)&&(p=this._getTransformedDimensions(),u=c.x+f*p.x,s=c.y+d*p.y),new t.Point(u,s)},translateToCenterPoint:function(c,i,n){var e=this.translateToGivenOrigin(c,i,n,"center","center");return this.angle?t.util.rotatePoint(e,c,h(this.angle)):e},translateToOriginPoint:function(c,i,n){var e=this.translateToGivenOrigin(c,"center","center",i,n);return this.angle?t.util.rotatePoint(e,c,h(this.angle)):e},getCenterPoint:function(){var c=new t.Point(this.left,this.top);return this.translateToCenterPoint(c,this.originX,this.originY)},getPointByOrigin:function(c,i){var n=this.getCenterPoint();return this.translateToOriginPoint(n,c,i)},toLocalPoint:function(c,i,n){var e=this.getCenterPoint(),o,u;return typeof i!="undefined"&&typeof n!="undefined"?o=this.translateToGivenOrigin(e,"center","center",i,n):o=new t.Point(this.left,this.top),u=new t.Point(c.x,c.y),this.angle&&(u=t.util.rotatePoint(u,e,-h(this.angle))),u.subtractEquals(o)},setPositionByOrigin:function(c,i,n){var e=this.translateToCenterPoint(c,i,n),o=this.translateToOriginPoint(e,this.originX,this.originY);this.set("left",o.x),this.set("top",o.y)},adjustPosition:function(c){var i=h(this.angle),n=this.getScaledWidth(),e=t.util.cos(i)*n,o=t.util.sin(i)*n,u,s;typeof this.originX=="string"?u=r[this.originX]:u=this.originX-.5,typeof c=="string"?s=r[c]:s=c-.5,this.left+=e*(s-u),this.top+=o*(s-u),this.setCoords(),this.originX=c},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var c=this.getCenterPoint();this.originX="center",this.originY="center",this.left=c.x,this.top=c.y},_resetOrigin:function(){var c=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=c.x,this.top=c.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function h(n){return[new t.Point(n.tl.x,n.tl.y),new t.Point(n.tr.x,n.tr.y),new t.Point(n.br.x,n.br.y),new t.Point(n.bl.x,n.bl.y)]}var r=t.util,l=r.degreesToRadians,c=r.multiplyTransformMatrices,i=r.transformPoint;r.object.extend(t.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(n,e){return e?n?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),n?this.aCoords:this.lineCoords)},getCoords:function(n,e){return h(this._getCoords(n,e))},intersectsWithRect:function(n,e,o,u){var s=this.getCoords(o,u),f=t.Intersection.intersectPolygonRectangle(s,n,e);return f.status==="Intersection"},intersectsWithObject:function(n,e,o){var u=t.Intersection.intersectPolygonPolygon(this.getCoords(e,o),n.getCoords(e,o));return u.status==="Intersection"||n.isContainedWithinObject(this,e,o)||this.isContainedWithinObject(n,e,o)},isContainedWithinObject:function(n,e,o){for(var u=this.getCoords(e,o),s=e?n.aCoords:n.lineCoords,f=0,d=n._getImageLines(s);f<4;f++)if(!n.containsPoint(u[f],d))return!1;return!0},isContainedWithinRect:function(n,e,o,u){var s=this.getBoundingRect(o,u);return s.left>=n.x&&s.left+s.width<=e.x&&s.top>=n.y&&s.top+s.height<=e.y},containsPoint:function(n,e,o,u){var s=this._getCoords(o,u),e=e||this._getImageLines(s),f=this._findCrossPoints(n,e);return f!==0&&f%2==1},isOnScreen:function(n){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,o=this.canvas.vptCoords.br,u=this.getCoords(!0,n);return u.some(function(s){return s.x<=o.x&&s.x>=e.x&&s.y<=o.y&&s.y>=e.y})||this.intersectsWithRect(e,o,!0,n)?!0:this._containsCenterOfCanvas(e,o,n)},_containsCenterOfCanvas:function(n,e,o){var u={x:(n.x+e.x)/2,y:(n.y+e.y)/2};return!!this.containsPoint(u,null,!0,o)},isPartiallyOnScreen:function(n){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,o=this.canvas.vptCoords.br;if(this.intersectsWithRect(e,o,!0,n))return!0;var u=this.getCoords(!0,n).every(function(s){return(s.x>=o.x||s.x<=e.x)&&(s.y>=o.y||s.y<=e.y)});return u&&this._containsCenterOfCanvas(e,o,n)},_getImageLines:function(n){var e={topline:{o:n.tl,d:n.tr},rightline:{o:n.tr,d:n.br},bottomline:{o:n.br,d:n.bl},leftline:{o:n.bl,d:n.tl}};return e},_findCrossPoints:function(n,e){var o,u,s,f,d,p=0,m;for(var y in e)if(m=e[y],!(m.o.y<n.y&&m.d.y<n.y)&&!(m.o.y>=n.y&&m.d.y>=n.y)&&(m.o.x===m.d.x&&m.o.x>=n.x?d=m.o.x:(o=0,u=(m.d.y-m.o.y)/(m.d.x-m.o.x),s=n.y-o*n.x,f=m.o.y-u*m.o.x,d=-(s-f)/(o-u)),d>=n.x&&(p+=1),p===2))break;return p},getBoundingRect:function(n,e){var o=this.getCoords(n,e);return r.makeBoundingBoxFromPoints(o)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(n){return Math.abs(n)<this.minScaleLimit?n<0?-this.minScaleLimit:this.minScaleLimit:n===0?1e-4:n},scale:function(n){return this._set("scaleX",n),this._set("scaleY",n),this.setCoords()},scaleToWidth:function(n,e){var o=this.getBoundingRect(e).width/this.getScaledWidth();return this.scale(n/this.width/o)},scaleToHeight:function(n,e){var o=this.getBoundingRect(e).height/this.getScaledHeight();return this.scale(n/this.height/o)},calcCoords:function(n){return n?this.calcACoords():this.calcOCoords()},calcLineCoords:function(){var n=this.getViewportTransform(),e=this.padding,o=l(this.angle),u=r.cos(o),s=r.sin(o),f=u*e,d=s*e,p=f+d,m=f-d,y=this.calcACoords(),S={tl:i(y.tl,n),tr:i(y.tr,n),bl:i(y.bl,n),br:i(y.br,n)};return e&&(S.tl.x-=m,S.tl.y-=p,S.tr.x+=p,S.tr.y-=m,S.bl.x-=p,S.bl.y+=m,S.br.x+=m,S.br.y+=p),S},calcOCoords:function(){var n=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),o=this.getViewportTransform(),u=c(o,e),s=c(u,n),s=c(s,[1/o[0],0,0,1/o[3],0,0]),f=this._calculateCurrentDimensions(),d={};return this.forEachControl(function(p,m,y){d[m]=p.positionHandler(f,s,y)}),d},calcACoords:function(){var n=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),o=c(e,n),u=this._getTransformedDimensions(),s=u.x/2,f=u.y/2;return{tl:i({x:-s,y:-f},o),tr:i({x:s,y:-f},o),bl:i({x:-s,y:f},o),br:i({x:s,y:f},o)}},setCoords:function(n){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),n?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return r.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var n=this.getCenterPoint();return[1,0,0,1,n.x,n.y]},transformMatrixKey:function(n){var e="_",o="";return!n&&this.group&&(o=this.group.transformMatrixKey(n)+e),o+this.top+e+this.left+e+this.scaleX+e+this.scaleY+e+this.skewX+e+this.skewY+e+this.angle+e+this.originX+e+this.originY+e+this.width+e+this.height+e+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(n){var e=this.calcOwnMatrix();if(n||!this.group)return e;var o=this.transformMatrixKey(n),u=this.matrixCache||(this.matrixCache={});return u.key===o?u.value:(this.group&&(e=c(this.group.calcTransformMatrix(!1),e)),u.key=o,u.value=e,e)},calcOwnMatrix:function(){var n=this.transformMatrixKey(!0),e=this.ownMatrixCache||(this.ownMatrixCache={});if(e.key===n)return e.value;var o=this._calcTranslateMatrix(),u={angle:this.angle,translateX:o[4],translateY:o[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return e.key=n,e.value=r.composeMatrix(u),e.value},_calcDimensionsTransformMatrix:function(n,e,o){return r.calcDimensionsMatrix({skewX:n,skewY:e,scaleX:this.scaleX*(o&&this.flipX?-1:1),scaleY:this.scaleY*(o&&this.flipY?-1:1)})},_getNonTransformedDimensions:function(){var n=this.strokeWidth,e=this.width+n,o=this.height+n;return{x:e,y:o}},_getTransformedDimensions:function(n,e){typeof n=="undefined"&&(n=this.skewX),typeof e=="undefined"&&(e=this.skewY);var o,u,s,f=n===0&&e===0;if(this.strokeUniform?(u=this.width,s=this.height):(o=this._getNonTransformedDimensions(),u=o.x,s=o.y),f)return this._finalizeDimensions(u*this.scaleX,s*this.scaleY);var d=r.sizeAfterTransform(u,s,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:n,skewY:e});return this._finalizeDimensions(d.x,d.y)},_finalizeDimensions:function(n,e){return this.strokeUniform?{x:n+this.strokeWidth,y:e+this.strokeWidth}:{x:n,y:e}},_calculateCurrentDimensions:function(){var n=this.getViewportTransform(),e=this._getTransformedDimensions(),o=i(e,n,!0);return o.scalarAdd(2*this.padding)}})}(),t.util.object.extend(t.Object.prototype,{sendToBack:function(){return this.group?t.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?t.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(h){return this.group?t.StaticCanvas.prototype.sendBackwards.call(this.group,this,h):this.canvas&&this.canvas.sendBackwards(this,h),this},bringForward:function(h){return this.group?t.StaticCanvas.prototype.bringForward.call(this.group,this,h):this.canvas&&this.canvas.bringForward(this,h),this},moveTo:function(h){return this.group&&this.group.type!=="activeSelection"?t.StaticCanvas.prototype.moveTo.call(this.group,this,h):this.canvas&&this.canvas.moveTo(this,h),this}}),function(){function h(l,c){if(c){if(c.toLive)return l+": url(#SVGID_"+c.id+"); ";var i=new t.Color(c),n=l+": "+i.toRgb()+"; ",e=i.getAlpha();return e!==1&&(n+=l+"-opacity: "+e.toString()+"; "),n}else return l+": none; "}var r=t.util.toFixed;t.util.object.extend(t.Object.prototype,{getSvgStyles:function(l){var c=this.fillRule?this.fillRule:"nonzero",i=this.strokeWidth?this.strokeWidth:"0",n=this.strokeDashArray?this.strokeDashArray.join(" "):"none",e=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",u=this.strokeLineJoin?this.strokeLineJoin:"miter",s=this.strokeMiterLimit?this.strokeMiterLimit:"4",f=typeof this.opacity!="undefined"?this.opacity:"1",d=this.visible?"":" visibility: hidden;",p=l?"":this.getSvgFilter(),m=h("fill",this.fill),y=h("stroke",this.stroke);return[y,"stroke-width: ",i,"; ","stroke-dasharray: ",n,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",e,"; ","stroke-linejoin: ",u,"; ","stroke-miterlimit: ",s,"; ",m,"fill-rule: ",c,"; ","opacity: ",f,";",p,d].join("")},getSvgSpanStyles:function(l,c){var i="; ",n=l.fontFamily?"font-family: "+(l.fontFamily.indexOf("'")===-1&&l.fontFamily.indexOf('"')===-1?"'"+l.fontFamily+"'":l.fontFamily)+i:"",e=l.strokeWidth?"stroke-width: "+l.strokeWidth+i:"",n=n,o=l.fontSize?"font-size: "+l.fontSize+"px"+i:"",u=l.fontStyle?"font-style: "+l.fontStyle+i:"",s=l.fontWeight?"font-weight: "+l.fontWeight+i:"",f=l.fill?h("fill",l.fill):"",d=l.stroke?h("stroke",l.stroke):"",p=this.getSvgTextDecoration(l),m=l.deltaY?"baseline-shift: "+-l.deltaY+"; ":"";return p&&(p="text-decoration: "+p+i),[d,e,n,o,u,s,p,f,m,c?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(l){return["overline","underline","line-through"].filter(function(c){return l[c.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(l,c){var i=l?this.calcTransformMatrix():this.calcOwnMatrix(),n='transform="'+t.util.matrixToSVG(i);return n+(c||"")+'" '},_setSVGBg:function(l){if(this.backgroundColor){var c=t.Object.NUM_FRACTION_DIGITS;l.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',r(-this.width/2,c),'" y="',r(-this.height/2,c),'" width="',r(this.width,c),'" height="',r(this.height,c),`"></rect>
`)}},toSVG:function(l){return this._createBaseSVGMarkup(this._toSVG(l),{reviver:l})},toClipPathSVG:function(l){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(l),{reviver:l})},_createBaseClipPathSVGMarkup:function(l,c){c=c||{};var i=c.reviver,n=c.additionalTransform||"",e=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),o=l.indexOf("COMMON_PARTS");return l[o]=e,i?i(l.join("")):l.join("")},_createBaseSVGMarkup:function(l,c){c=c||{};var i=c.noStyle,n=c.reviver,e=i?"":'style="'+this.getSvgStyles()+'" ',o=c.withShadow?'style="'+this.getSvgFilter()+'" ':"",u=this.clipPath,s=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",f=u&&u.absolutePositioned,d=this.stroke,p=this.fill,m=this.shadow,y,S=[],O,R=l.indexOf("COMMON_PARTS"),Y=c.additionalTransform;return u&&(u.clipPathId="CLIPPATH_"+t.Object.__uid++,O='<clipPath id="'+u.clipPathId+`" >
`+u.toClipPathSVG(n)+`</clipPath>
`),f&&S.push("<g ",o,this.getSvgCommons(),` >
`),S.push("<g ",this.getSvgTransform(!1),f?"":o+this.getSvgCommons(),` >
`),y=[e,s,i?"":this.addPaintOrder()," ",Y?'transform="'+Y+'" ':""].join(""),l[R]=y,p&&p.toLive&&S.push(p.toSVG(this)),d&&d.toLive&&S.push(d.toSVG(this)),m&&S.push(m.toSVG(this)),u&&S.push(O),S.push(l.join("")),S.push(`</g>
`),f&&S.push(`</g>
`),n?n(S.join("")):S.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var h=t.util.object.extend,r="stateProperties";function l(i,n,e){var o={},u=!0;e.forEach(function(s){o[s]=i[s]}),h(i[n],o,u)}function c(i,n,e){if(i===n)return!0;if(Array.isArray(i)){if(!Array.isArray(n)||i.length!==n.length)return!1;for(var o=0,u=i.length;o<u;o++)if(!c(i[o],n[o]))return!1;return!0}else if(i&&typeof i=="object"){var s=Object.keys(i),f;if(!n||typeof n!="object"||!e&&s.length!==Object.keys(n).length)return!1;for(var o=0,u=s.length;o<u;o++)if(f=s[o],!(f==="canvas"||f==="group")&&!c(i[f],n[f]))return!1;return!0}}t.util.object.extend(t.Object.prototype,{hasStateChanged:function(i){i=i||r;var n="_"+i;return Object.keys(this[n]).length<this[i].length?!0:!c(this[n],this,!0)},saveState:function(i){var n=i&&i.propertySet||r,e="_"+n;return this[e]?(l(this,e,this[n]),i&&i.stateProperties&&l(this,e,i.stateProperties),this):this.setupState(i)},setupState:function(i){i=i||{};var n=i.propertySet||r;return i.propertySet=n,this["_"+n]={},this.saveState(i),this}})}(),function(){var h=t.util.degreesToRadians;t.util.object.extend(t.Object.prototype,{_findTargetCorner:function(r,l){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var c=r.x,i=r.y,n,e,o=Object.keys(this.oCoords),u=o.length-1,s;for(this.__corner=0;u>=0;u--)if(s=o[u],!!this.isControlVisible(s)&&(e=this._getImageLines(l?this.oCoords[s].touchCorner:this.oCoords[s].corner),n=this._findCrossPoints({x:c,y:i},e),n!==0&&n%2==1))return this.__corner=s,s;return!1},forEachControl:function(r){for(var l in this.controls)r(this.controls[l],l,this)},_setCornerCoords:function(){var r=this.oCoords;for(var l in r){var c=this.controls[l];r[l].corner=c.calcCornerCoords(this.angle,this.cornerSize,r[l].x,r[l].y,!1),r[l].touchCorner=c.calcCornerCoords(this.angle,this.touchCornerSize,r[l].x,r[l].y,!0)}},drawSelectionBackground:function(r){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;r.save();var l=this.getCenterPoint(),c=this._calculateCurrentDimensions(),i=this.canvas.viewportTransform;return r.translate(l.x,l.y),r.scale(1/i[0],1/i[3]),r.rotate(h(this.angle)),r.fillStyle=this.selectionBackgroundColor,r.fillRect(-c.x/2,-c.y/2,c.x,c.y),r.restore(),this},drawBorders:function(r,l){l=l||{};var c=this._calculateCurrentDimensions(),i=this.borderScaleFactor,n=c.x+i,e=c.y+i,o=typeof l.hasControls!="undefined"?l.hasControls:this.hasControls,u=!1;return r.save(),r.strokeStyle=l.borderColor||this.borderColor,this._setLineDash(r,l.borderDashArray||this.borderDashArray),r.strokeRect(-n/2,-e/2,n,e),o&&(r.beginPath(),this.forEachControl(function(s,f,d){s.withConnection&&s.getVisibility(d,f)&&(u=!0,r.moveTo(s.x*n,s.y*e),r.lineTo(s.x*n+s.offsetX,s.y*e+s.offsetY))}),u&&r.stroke()),r.restore(),this},drawBordersInGroup:function(r,l,c){c=c||{};var i=t.util.sizeAfterTransform(this.width,this.height,l),n=this.strokeWidth,e=this.strokeUniform,o=this.borderScaleFactor,u=i.x+n*(e?this.canvas.getZoom():l.scaleX)+o,s=i.y+n*(e?this.canvas.getZoom():l.scaleY)+o;return r.save(),this._setLineDash(r,c.borderDashArray||this.borderDashArray),r.strokeStyle=c.borderColor||this.borderColor,r.strokeRect(-u/2,-s/2,u,s),r.restore(),this},drawControls:function(r,l){l=l||{},r.save();var c=this.canvas.getRetinaScaling(),i,n;return r.setTransform(c,0,0,c,0,0),r.strokeStyle=r.fillStyle=l.cornerColor||this.cornerColor,this.transparentCorners||(r.strokeStyle=l.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(r,l.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(i=this.group.calcTransformMatrix()),this.forEachControl(function(e,o,u){n=u.oCoords[o],e.getVisibility(u,o)&&(i&&(n=t.util.transformPoint(n,i)),e.render(r,n.x,n.y,l,u))}),r.restore(),this},isControlVisible:function(r){return this.controls[r]&&this.controls[r].getVisibility(this,r)},setControlVisible:function(r,l){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[r]=l,this},setControlsVisibility:function(r){r||(r={});for(var l in r)this.setControlVisible(l,r[l]);return this},onDeselect:function(){},onSelect:function(){}})}(),t.util.object.extend(t.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(h,r){r=r||{};var l=function(){},c=r.onComplete||l,i=r.onChange||l,n=this;return t.util.animate({startValue:h.left,endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(e){h.set("left",e),n.requestRenderAll(),i()},onComplete:function(){h.setCoords(),c()}}),this},fxCenterObjectV:function(h,r){r=r||{};var l=function(){},c=r.onComplete||l,i=r.onChange||l,n=this;return t.util.animate({startValue:h.top,endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(e){h.set("top",e),n.requestRenderAll(),i()},onComplete:function(){h.setCoords(),c()}}),this},fxRemove:function(h,r){r=r||{};var l=function(){},c=r.onComplete||l,i=r.onChange||l,n=this;return t.util.animate({startValue:h.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(e){h.set("opacity",e),n.requestRenderAll(),i()},onComplete:function(){n.remove(h),c()}}),this}}),t.util.object.extend(t.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var h=[],r,l;for(r in arguments[0])h.push(r);for(var c=0,i=h.length;c<i;c++)r=h[c],l=c!==i-1,this._animate(r,arguments[0][r],arguments[1],l)}else this._animate.apply(this,arguments);return this},_animate:function(h,r,l,c){var i=this,n;r=r.toString(),l?l=t.util.object.clone(l):l={},~h.indexOf(".")&&(n=h.split("."));var e=i.colorProperties.indexOf(h)>-1||n&&i.colorProperties.indexOf(n[1])>-1,o=n?this.get(n[0])[n[1]]:this.get(h);"from"in l||(l.from=o),e||(~r.indexOf("=")?r=o+parseFloat(r.replace("=","")):r=parseFloat(r));var u={startValue:l.from,endValue:r,byValue:l.by,easing:l.easing,duration:l.duration,abort:l.abort&&function(s,f,d){return l.abort.call(i,s,f,d)},onChange:function(s,f,d){n?i[n[0]][n[1]]=s:i.set(h,s),!c&&l.onChange&&l.onChange(s,f,d)},onComplete:function(s,f,d){c||(i.setCoords(),l.onComplete&&l.onComplete(s,f,d))}};return e?t.util.animateColor(u.startValue,u.endValue,u.duration,u):t.util.animate(u)}}),function(h){var r=h.fabric||(h.fabric={}),l=r.util.object.extend,c=r.util.object.clone,i={x1:1,x2:1,y1:1,y2:1};if(r.Line){r.warn("fabric.Line is already defined");return}r.Line=r.util.createClass(r.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:r.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(e,o){e||(e=[0,0,0,0]),this.callSuper("initialize",o),this.set("x1",e[0]),this.set("y1",e[1]),this.set("x2",e[2]),this.set("y2",e[3]),this._setWidthHeight(o)},_setWidthHeight:function(e){e||(e={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in e?e.left:this._getLeftToOriginX(),this.top="top"in e?e.top:this._getTopToOriginY()},_set:function(e,o){return this.callSuper("_set",e,o),typeof i[e]!="undefined"&&this._setWidthHeight(),this},_getLeftToOriginX:n({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:n({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(e){e.beginPath();var o=this.calcLinePoints();e.moveTo(o.x1,o.y1),e.lineTo(o.x2,o.y2),e.lineWidth=this.strokeWidth;var u=e.strokeStyle;e.strokeStyle=this.stroke||e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=u},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(e){return l(this.callSuper("toObject",e),this.calcLinePoints())},_getNonTransformedDimensions:function(){var e=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e},calcLinePoints:function(){var e=this.x1<=this.x2?-1:1,o=this.y1<=this.y2?-1:1,u=e*this.width*.5,s=o*this.height*.5,f=e*this.width*-.5,d=o*this.height*-.5;return{x1:u,x2:f,y1:s,y2:d}},_toSVG:function(){var e=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',e.x1,'" y1="',e.y1,'" x2="',e.x2,'" y2="',e.y2,`" />
`]}}),r.Line.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),r.Line.fromElement=function(e,o,u){u=u||{};var s=r.parseAttributes(e,r.Line.ATTRIBUTE_NAMES),f=[s.x1||0,s.y1||0,s.x2||0,s.y2||0];o(new r.Line(f,l(s,u)))},r.Line.fromObject=function(e,o){function u(f){delete f.points,o&&o(f)}var s=c(e,!0);s.points=[e.x1,e.y1,e.x2,e.y2],r.Object._fromObject("Line",s,u,"points")};function n(e,o){var u=e.origin,s=e.axis1,f=e.axis2,d=e.dimension,p=o.nearest,m=o.center,y=o.farthest;return function(){switch(this.get(u)){case p:return Math.min(this.get(s),this.get(f));case m:return Math.min(this.get(s),this.get(f))+.5*this.get(d);case y:return Math.max(this.get(s),this.get(f))}}}}(a),function(h){var r=h.fabric||(h.fabric={}),l=Math.PI;if(r.Circle){r.warn("fabric.Circle is already defined.");return}r.Circle=r.util.createClass(r.Object,{type:"circle",radius:0,startAngle:0,endAngle:l*2,cacheProperties:r.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(i,n){return this.callSuper("_set",i,n),i==="radius"&&this.setRadius(n),this},toObject:function(i){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(i))},_toSVG:function(){var i,n=0,e=0,o=(this.endAngle-this.startAngle)%(2*l);if(o===0)i=["<circle ","COMMON_PARTS",'cx="'+n+'" cy="'+e+'" ','r="',this.radius,`" />
`];else{var u=r.util.cos(this.startAngle)*this.radius,s=r.util.sin(this.startAngle)*this.radius,f=r.util.cos(this.endAngle)*this.radius,d=r.util.sin(this.endAngle)*this.radius,p=o>l?"1":"0";i=['<path d="M '+u+" "+s," A "+this.radius+" "+this.radius," 0 ",+p+" 1"," "+f+" "+d,'" ',"COMMON_PARTS",` />
`]}return i},_render:function(i){i.beginPath(),i.arc(0,0,this.radius,this.startAngle,this.endAngle,!1),this._renderPaintInOrder(i)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(i){return this.radius=i,this.set("width",i*2).set("height",i*2)}}),r.Circle.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),r.Circle.fromElement=function(i,n){var e=r.parseAttributes(i,r.Circle.ATTRIBUTE_NAMES);if(!c(e))throw new Error("value of `r` attribute is required and can not be negative");e.left=(e.left||0)-e.radius,e.top=(e.top||0)-e.radius,n(new r.Circle(e))};function c(i){return"radius"in i&&i.radius>=0}r.Circle.fromObject=function(i,n){r.Object._fromObject("Circle",i,n)}}(a),function(h){var r=h.fabric||(h.fabric={});if(r.Triangle){r.warn("fabric.Triangle is already defined");return}r.Triangle=r.util.createClass(r.Object,{type:"triangle",width:100,height:100,_render:function(l){var c=this.width/2,i=this.height/2;l.beginPath(),l.moveTo(-c,i),l.lineTo(0,-i),l.lineTo(c,i),l.closePath(),this._renderPaintInOrder(l)},_toSVG:function(){var l=this.width/2,c=this.height/2,i=[-l+" "+c,"0 "+-c,l+" "+c].join(",");return["<polygon ","COMMON_PARTS",'points="',i,'" />']}}),r.Triangle.fromObject=function(l,c){return r.Object._fromObject("Triangle",l,c)}}(a),function(h){var r=h.fabric||(h.fabric={}),l=Math.PI*2;if(r.Ellipse){r.warn("fabric.Ellipse is already defined.");return}r.Ellipse=r.util.createClass(r.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:r.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(c){this.callSuper("initialize",c),this.set("rx",c&&c.rx||0),this.set("ry",c&&c.ry||0)},_set:function(c,i){switch(this.callSuper("_set",c,i),c){case"rx":this.rx=i,this.set("width",i*2);break;case"ry":this.ry=i,this.set("height",i*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(c){return this.callSuper("toObject",["rx","ry"].concat(c))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(c){c.beginPath(),c.save(),c.transform(1,0,0,this.ry/this.rx,0,0),c.arc(0,0,this.rx,0,l,!1),c.restore(),this._renderPaintInOrder(c)}}),r.Ellipse.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),r.Ellipse.fromElement=function(c,i){var n=r.parseAttributes(c,r.Ellipse.ATTRIBUTE_NAMES);n.left=(n.left||0)-n.rx,n.top=(n.top||0)-n.ry,i(new r.Ellipse(n))},r.Ellipse.fromObject=function(c,i){r.Object._fromObject("Ellipse",c,i)}}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.util.object.extend;if(r.Rect){r.warn("fabric.Rect is already defined");return}r.Rect=r.util.createClass(r.Object,{stateProperties:r.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:r.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(c){this.callSuper("initialize",c),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(c){var i=this.rx?Math.min(this.rx,this.width/2):0,n=this.ry?Math.min(this.ry,this.height/2):0,e=this.width,o=this.height,u=-this.width/2,s=-this.height/2,f=i!==0||n!==0,d=1-.5522847498;c.beginPath(),c.moveTo(u+i,s),c.lineTo(u+e-i,s),f&&c.bezierCurveTo(u+e-d*i,s,u+e,s+d*n,u+e,s+n),c.lineTo(u+e,s+o-n),f&&c.bezierCurveTo(u+e,s+o-d*n,u+e-d*i,s+o,u+e-i,s+o),c.lineTo(u+i,s+o),f&&c.bezierCurveTo(u+d*i,s+o,u,s+o-d*n,u,s+o-n),c.lineTo(u,s+n),f&&c.bezierCurveTo(u,s+d*n,u+d*i,s,u+i,s),c.closePath(),this._renderPaintInOrder(c)},toObject:function(c){return this.callSuper("toObject",["rx","ry"].concat(c))},_toSVG:function(){var c=-this.width/2,i=-this.height/2;return["<rect ","COMMON_PARTS",'x="',c,'" y="',i,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),r.Rect.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),r.Rect.fromElement=function(c,i,n){if(!c)return i(null);n=n||{};var e=r.parseAttributes(c,r.Rect.ATTRIBUTE_NAMES);e.left=e.left||0,e.top=e.top||0,e.height=e.height||0,e.width=e.width||0;var o=new r.Rect(l(n?r.util.object.clone(n):{},e));o.visible=o.visible&&o.width>0&&o.height>0,i(o)},r.Rect.fromObject=function(c,i){return r.Object._fromObject("Rect",c,i)}}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.util.object.extend,c=r.util.array.min,i=r.util.array.max,n=r.util.toFixed;if(r.Polyline){r.warn("fabric.Polyline is already defined");return}r.Polyline=r.util.createClass(r.Object,{type:"polyline",points:null,cacheProperties:r.Object.prototype.cacheProperties.concat("points"),initialize:function(e,o){o=o||{},this.points=e||[],this.callSuper("initialize",o),this._setPositionDimensions(o)},_setPositionDimensions:function(e){var o=this._calcDimensions(e),u;this.width=o.width,this.height=o.height,e.fromSVG||(u=this.translateToGivenOrigin({x:o.left-this.strokeWidth/2,y:o.top-this.strokeWidth/2},"left","top",this.originX,this.originY)),typeof e.left=="undefined"&&(this.left=e.fromSVG?o.left:u.x),typeof e.top=="undefined"&&(this.top=e.fromSVG?o.top:u.y),this.pathOffset={x:o.left+this.width/2,y:o.top+this.height/2}},_calcDimensions:function(){var e=this.points,o=c(e,"x")||0,u=c(e,"y")||0,s=i(e,"x")||0,f=i(e,"y")||0,d=s-o,p=f-u;return{left:o,top:u,width:d,height:p}},toObject:function(e){return l(this.callSuper("toObject",e),{points:this.points.concat()})},_toSVG:function(){for(var e=[],o=this.pathOffset.x,u=this.pathOffset.y,s=r.Object.NUM_FRACTION_DIGITS,f=0,d=this.points.length;f<d;f++)e.push(n(this.points[f].x-o,s),",",n(this.points[f].y-u,s)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',e.join(""),`" />
`]},commonRender:function(e){var o,u=this.points.length,s=this.pathOffset.x,f=this.pathOffset.y;if(!u||isNaN(this.points[u-1].y))return!1;e.beginPath(),e.moveTo(this.points[0].x-s,this.points[0].y-f);for(var d=0;d<u;d++)o=this.points[d],e.lineTo(o.x-s,o.y-f);return!0},_render:function(e){!this.commonRender(e)||this._renderPaintInOrder(e)},complexity:function(){return this.get("points").length}}),r.Polyline.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat(),r.Polyline.fromElementGenerator=function(e){return function(o,u,s){if(!o)return u(null);s||(s={});var f=r.parsePointsAttribute(o.getAttribute("points")),d=r.parseAttributes(o,r[e].ATTRIBUTE_NAMES);d.fromSVG=!0,u(new r[e](f,l(d,s)))}},r.Polyline.fromElement=r.Polyline.fromElementGenerator("Polyline"),r.Polyline.fromObject=function(e,o){return r.Object._fromObject("Polyline",e,o,"points")}}(a),function(h){var r=h.fabric||(h.fabric={});if(r.Polygon){r.warn("fabric.Polygon is already defined");return}r.Polygon=r.util.createClass(r.Polyline,{type:"polygon",_render:function(l){!this.commonRender(l)||(l.closePath(),this._renderPaintInOrder(l))}}),r.Polygon.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat(),r.Polygon.fromElement=r.Polyline.fromElementGenerator("Polygon"),r.Polygon.fromObject=function(l,c){r.Object._fromObject("Polygon",l,c,"points")}}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.util.array.min,c=r.util.array.max,i=r.util.object.extend,n=Object.prototype.toString,e=r.util.toFixed;if(r.Path){r.warn("fabric.Path is already defined");return}r.Path=r.util.createClass(r.Object,{type:"path",path:null,cacheProperties:r.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:r.Object.prototype.stateProperties.concat("path"),initialize:function(o,u){u=u||{},this.callSuper("initialize",u),o||(o=[]);var s=n.call(o)==="[object Array]";this.path=r.util.makePathSimpler(s?o:r.util.parsePath(o)),!!this.path&&r.Polyline.prototype._setPositionDimensions.call(this,u)},_renderPathCommands:function(o){var u,s=0,f=0,d=0,p=0,m=0,y=0,S=-this.pathOffset.x,O=-this.pathOffset.y;o.beginPath();for(var R=0,Y=this.path.length;R<Y;++R)switch(u=this.path[R],u[0]){case"L":d=u[1],p=u[2],o.lineTo(d+S,p+O);break;case"M":d=u[1],p=u[2],s=d,f=p,o.moveTo(d+S,p+O);break;case"C":d=u[5],p=u[6],m=u[3],y=u[4],o.bezierCurveTo(u[1]+S,u[2]+O,m+S,y+O,d+S,p+O);break;case"Q":o.quadraticCurveTo(u[1]+S,u[2]+O,u[3]+S,u[4]+O),d=u[3],p=u[4],m=u[1],y=u[2];break;case"z":case"Z":d=s,p=f,o.closePath();break}},_render:function(o){this._renderPathCommands(o),this._renderPaintInOrder(o)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(o){return i(this.callSuper("toObject",o),{path:this.path.map(function(u){return u.slice()})})},toDatalessObject:function(o){var u=this.toObject(["sourcePath"].concat(o));return u.sourcePath&&delete u.path,u},_toSVG:function(){var o=r.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',o,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var o=r.Object.NUM_FRACTION_DIGITS;return" translate("+e(-this.pathOffset.x,o)+", "+e(-this.pathOffset.y,o)+")"},toClipPathSVG:function(o){var u=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:o,additionalTransform:u})},toSVG:function(o){var u=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:o,additionalTransform:u})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var o=[],u=[],s,f=0,d=0,p=0,m=0,y,S=0,O=this.path.length;S<O;++S){switch(s=this.path[S],s[0]){case"L":p=s[1],m=s[2],y=[];break;case"M":p=s[1],m=s[2],f=p,d=m,y=[];break;case"C":y=r.util.getBoundsOfCurve(p,m,s[1],s[2],s[3],s[4],s[5],s[6]),p=s[5],m=s[6];break;case"Q":y=r.util.getBoundsOfCurve(p,m,s[1],s[2],s[1],s[2],s[3],s[4]),p=s[3],m=s[4];break;case"z":case"Z":p=f,m=d;break}y.forEach(function(et){o.push(et.x),u.push(et.y)}),o.push(p),u.push(m)}var R=l(o)||0,Y=l(u)||0,q=c(o)||0,tt=c(u)||0,Z=q-R,it=tt-Y;return{left:R,top:Y,width:Z,height:it}}}),r.Path.fromObject=function(o,u){if(typeof o.sourcePath=="string"){var s=o.sourcePath;r.loadSVGFromURL(s,function(f){var d=f[0];d.setOptions(o),u&&u(d)})}else r.Object._fromObject("Path",o,u,"path")},r.Path.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat(["d"]),r.Path.fromElement=function(o,u,s){var f=r.parseAttributes(o,r.Path.ATTRIBUTE_NAMES);f.fromSVG=!0,u(new r.Path(f.d,i(f,s)))}}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.util.array.min,c=r.util.array.max;r.Group||(r.Group=r.util.createClass(r.Object,r.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(i,n,e){n=n||{},this._objects=[],e&&this.callSuper("initialize",n),this._objects=i||[];for(var o=this._objects.length;o--;)this._objects[o].group=this;if(e)this._updateObjectsACoords();else{var u=n&&n.centerPoint;n.originX!==void 0&&(this.originX=n.originX),n.originY!==void 0&&(this.originY=n.originY),u||this._calcBounds(),this._updateObjectsCoords(u),delete n.centerPoint,this.callSuper("initialize",n)}this.setCoords()},_updateObjectsACoords:function(){for(var i=!0,n=this._objects.length;n--;)this._objects[n].setCoords(i)},_updateObjectsCoords:function(i){for(var i=i||this.getCenterPoint(),n=this._objects.length;n--;)this._updateObjectCoords(this._objects[n],i)},_updateObjectCoords:function(i,n){var e=i.left,o=i.top,u=!0;i.set({left:e-n.x,top:o-n.y}),i.group=this,i.setCoords(u)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(i){var n=!!this.group;return this._restoreObjectsState(),r.util.resetObjectTransform(this),i&&(n&&r.util.removeTransformFromObject(i,this.group.calcTransformMatrix()),this._objects.push(i),i.group=this,i._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,n?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(i){return this._restoreObjectsState(),r.util.resetObjectTransform(this),this.remove(i),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(i){this.dirty=!0,i.group=this,i._set("canvas",this.canvas)},_onObjectRemoved:function(i){this.dirty=!0,delete i.group},_set:function(i,n){var e=this._objects.length;if(this.useSetOnGroup)for(;e--;)this._objects[e].setOnGroup(i,n);if(i==="canvas")for(;e--;)this._objects[e]._set(i,n);r.Object.prototype._set.call(this,i,n)},toObject:function(i){var n=this.includeDefaultValues,e=this._objects.filter(function(u){return!u.excludeFromExport}).map(function(u){var s=u.includeDefaultValues;u.includeDefaultValues=n;var f=u.toObject(i);return u.includeDefaultValues=s,f}),o=r.Object.prototype.toObject.call(this,i);return o.objects=e,o},toDatalessObject:function(i){var n,e=this.sourcePath;if(e)n=e;else{var o=this.includeDefaultValues;n=this._objects.map(function(s){var f=s.includeDefaultValues;s.includeDefaultValues=o;var d=s.toDatalessObject(i);return s.includeDefaultValues=f,d})}var u=r.Object.prototype.toDatalessObject.call(this,i);return u.objects=n,u},render:function(i){this._transformDone=!0,this.callSuper("render",i),this._transformDone=!1},shouldCache:function(){var i=r.Object.prototype.shouldCache.call(this);if(i){for(var n=0,e=this._objects.length;n<e;n++)if(this._objects[n].willDrawShadow())return this.ownCaching=!1,!1}return i},willDrawShadow:function(){if(r.Object.prototype.willDrawShadow.call(this))return!0;for(var i=0,n=this._objects.length;i<n;i++)if(this._objects[i].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(i){for(var n=0,e=this._objects.length;n<e;n++)this._objects[n].render(i);this._drawClipPath(i)},isCacheDirty:function(i){if(this.callSuper("isCacheDirty",i))return!0;if(!this.statefullCache)return!1;for(var n=0,e=this._objects.length;n<e;n++)if(this._objects[n].isCacheDirty(!0)){if(this._cacheCanvas){var o=this.cacheWidth/this.zoomX,u=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-o/2,-u/2,o,u)}return!0}return!1},_restoreObjectsState:function(){var i=this.calcOwnMatrix();return this._objects.forEach(function(n){r.util.addTransformToObject(n,i),delete n.group,n.setCoords()}),this},realizeTransform:function(i,n){return r.util.addTransformToObject(i,n),i},destroy:function(){return this._objects.forEach(function(i){i.set("dirty",!0)}),this._restoreObjectsState()},toActiveSelection:function(){if(!!this.canvas){var i=this._objects,n=this.canvas;this._objects=[];var e=this.toObject();delete e.objects;var o=new r.ActiveSelection([]);return o.set(e),o.type="activeSelection",n.remove(this),i.forEach(function(u){u.group=o,u.dirty=!0,n.add(u)}),o.canvas=n,o._objects=i,n._activeObject=o,o.setCoords(),o}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var i=!0;return this.forEachObject(function(n){n.setCoords(i)}),this},_calcBounds:function(i){for(var n=[],e=[],o,u,s,f=["tr","br","bl","tl"],d=0,p=this._objects.length,m,y=f.length;d<p;++d){for(o=this._objects[d],s=o.calcACoords(),m=0;m<y;m++)u=f[m],n.push(s[u].x),e.push(s[u].y);o.aCoords=s}this._getBounds(n,e,i)},_getBounds:function(i,n,e){var o=new r.Point(l(i),l(n)),u=new r.Point(c(i),c(n)),s=o.y||0,f=o.x||0,d=u.x-o.x||0,p=u.y-o.y||0;this.width=d,this.height=p,e||this.setPositionByOrigin({x:f,y:s},"left","top")},_toSVG:function(i){for(var n=["<g ","COMMON_PARTS",` >
`],e=0,o=this._objects.length;e<o;e++)n.push("		",this._objects[e].toSVG(i));return n.push(`</g>
`),n},getSvgStyles:function(){var i=typeof this.opacity!="undefined"&&this.opacity!==1?"opacity: "+this.opacity+";":"",n=this.visible?"":" visibility: hidden;";return[i,this.getSvgFilter(),n].join("")},toClipPathSVG:function(i){for(var n=[],e=0,o=this._objects.length;e<o;e++)n.push("	",this._objects[e].toClipPathSVG(i));return this._createBaseClipPathSVGMarkup(n,{reviver:i})}}),r.Group.fromObject=function(i,n){var e=i.objects,o=r.util.object.clone(i,!0);if(delete o.objects,typeof e=="string"){r.loadSVGFromURL(e,function(u){var s=r.util.groupSVGElements(u,i,e);s.set(o),n&&n(s)});return}r.util.enlivenObjects(e,function(u){r.util.enlivenObjects([i.clipPath],function(s){var f=r.util.object.clone(i,!0);f.clipPath=s[0],delete f.objects,n&&n(new r.Group(u,f,!0))})})})}(a),function(h){var r=h.fabric||(h.fabric={});r.ActiveSelection||(r.ActiveSelection=r.util.createClass(r.Group,{type:"activeSelection",initialize:function(l,c){c=c||{},this._objects=l||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;c.originX&&(this.originX=c.originX),c.originY&&(this.originY=c.originY),this._calcBounds(),this._updateObjectsCoords(),r.Object.prototype.initialize.call(this,c),this.setCoords()},toGroup:function(){var l=this._objects.concat();this._objects=[];var c=r.Object.prototype.toObject.call(this),i=new r.Group([]);if(delete c.type,i.set(c),l.forEach(function(e){e.canvas.remove(e),e.group=i}),i._objects=l,!this.canvas)return i;var n=this.canvas;return n.add(i),n._activeObject=i,i.setCoords(),i},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(l,c,i){l.save(),l.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",l,c),i=i||{},typeof i.hasControls=="undefined"&&(i.hasControls=!1),i.forActiveSelection=!0;for(var n=0,e=this._objects.length;n<e;n++)this._objects[n]._renderControls(l,i);l.restore()}}),r.ActiveSelection.fromObject=function(l,c){r.util.enlivenObjects(l.objects,function(i){delete l.objects,c&&c(new r.ActiveSelection(i,l,!0))})})}(a),function(h){var r=t.util.object.extend;if(h.fabric||(h.fabric={}),h.fabric.Image){t.warn("fabric.Image is already defined.");return}t.Image=t.util.createClass(t.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:t.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:t.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(l,c){c||(c={}),this.filters=[],this.cacheKey="texture"+t.Object.__uid++,this.callSuper("initialize",c),this._initElement(l,c)},getElement:function(){return this._element||{}},setElement:function(l,c){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=l,this._originalElement=l,this._initConfig(c),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(l){var c=t.filterBackend;c&&c.evictCachesForKey&&c.evictCachesForKey(l)},dispose:function(){this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(l){t.util.cleanUpJsdomNode(this[l]),this[l]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var l=this.getElement();return{width:l.naturalWidth||l.width,height:l.naturalHeight||l.height}},_stroke:function(l){if(!(!this.stroke||this.strokeWidth===0)){var c=this.width/2,i=this.height/2;l.beginPath(),l.moveTo(-c,-i),l.lineTo(c,-i),l.lineTo(c,i),l.lineTo(-c,i),l.lineTo(-c,-i),l.closePath()}},toObject:function(l){var c=[];this.filters.forEach(function(n){n&&c.push(n.toObject())});var i=r(this.callSuper("toObject",["cropX","cropY"].concat(l)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:c});return this.resizeFilter&&(i.resizeFilter=this.resizeFilter.toObject()),i},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var l=[],c=[],i,n=this._element,e=-this.width/2,o=-this.height/2,u="",s="";if(!n)return[];if(this.hasCrop()){var f=t.Object.__uid++;l.push('<clipPath id="imageCrop_'+f+`">
`,'	<rect x="'+e+'" y="'+o+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),u=' clip-path="url(#imageCrop_'+f+')" '}if(this.imageSmoothing||(s='" image-rendering="optimizeSpeed'),c.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',e-this.cropX,'" y="',o-this.cropY,'" width="',n.width||n.naturalWidth,'" height="',n.height||n.height,s,'"',u,`></image>
`),this.stroke||this.strokeDashArray){var d=this.fill;this.fill=null,i=["	<rect ",'x="',e,'" y="',o,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=d}return this.paintFirst!=="fill"?l=l.concat(i,c):l=l.concat(c,i),l},getSrc:function(l){var c=l?this._element:this._originalElement;return c?c.toDataURL?c.toDataURL():this.srcFromAttribute?c.getAttribute("src"):c.src:this.src||""},setSrc:function(l,c,i){return t.util.loadImage(l,function(n,e){this.setElement(n,i),this._setWidthHeight(),c&&c(this,e)},this,i&&i.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var l=this.resizeFilter,c=this.minimumScaleTrigger,i=this.getTotalObjectScaling(),n=i.scaleX,e=i.scaleY,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!l||n>c&&e>c){this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=n,this._lastScaleY=e;return}t.filterBackend||(t.filterBackend=t.initFilterBackend());var u=t.util.createCanvasElement(),s=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,f=o.width,d=o.height;u.width=f,u.height=d,this._element=u,this._lastScaleX=l.scaleX=n,this._lastScaleY=l.scaleY=e,t.filterBackend.applyFilters([l],o,f,d,this._element,s),this._filterScalingX=u.width/this._originalElement.width,this._filterScalingY=u.height/this._originalElement.height},applyFilters:function(l){if(l=l||this.filters||[],l=l.filter(function(o){return o&&!o.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),l.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var c=this._originalElement,i=c.naturalWidth||c.width,n=c.naturalHeight||c.height;if(this._element===this._originalElement){var e=t.util.createCanvasElement();e.width=i,e.height=n,this._element=e,this._filteredEl=e}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,i,n),this._lastScaleX=1,this._lastScaleY=1;return t.filterBackend||(t.filterBackend=t.initFilterBackend()),t.filterBackend.applyFilters(l,this._originalElement,i,n,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(l){t.util.setImageSmoothing(l,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(l),this._renderPaintInOrder(l)},drawCacheOnCanvas:function(l){t.util.setImageSmoothing(l,this.imageSmoothing),t.Object.prototype.drawCacheOnCanvas.call(this,l)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(l){var c=this._element;if(!!c){var i=this._filterScalingX,n=this._filterScalingY,e=this.width,o=this.height,u=Math.min,s=Math.max,f=s(this.cropX,0),d=s(this.cropY,0),p=c.naturalWidth||c.width,m=c.naturalHeight||c.height,y=f*i,S=d*n,O=u(e*i,p-y),R=u(o*n,m-S),Y=-e/2,q=-o/2,tt=u(e,p/i-f),Z=u(o,m/n-d);c&&l.drawImage(c,y,S,O,R,Y,q,tt,Z)}},_needsResize:function(){var l=this.getTotalObjectScaling();return l.scaleX!==this._lastScaleX||l.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(l,c){this.setElement(t.util.getById(l),c),t.util.addClass(this.getElement(),t.Image.CSS_CANVAS)},_initConfig:function(l){l||(l={}),this.setOptions(l),this._setWidthHeight(l)},_initFilters:function(l,c){l&&l.length?t.util.enlivenObjects(l,function(i){c&&c(i)},"fabric.Image.filters"):c&&c()},_setWidthHeight:function(l){l||(l={});var c=this.getElement();this.width=l.width||c.naturalWidth||c.width||0,this.height=l.height||c.naturalHeight||c.height||0},parsePreserveAspectRatioAttribute:function(){var l=t.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),c=this._element.width,i=this._element.height,n=1,e=1,o=0,u=0,s=0,f=0,d,p=this.width,m=this.height,y={width:p,height:m};return l&&(l.alignX!=="none"||l.alignY!=="none")?(l.meetOrSlice==="meet"&&(n=e=t.util.findScaleToFit(this._element,y),d=(p-c*n)/2,l.alignX==="Min"&&(o=-d),l.alignX==="Max"&&(o=d),d=(m-i*e)/2,l.alignY==="Min"&&(u=-d),l.alignY==="Max"&&(u=d)),l.meetOrSlice==="slice"&&(n=e=t.util.findScaleToCover(this._element,y),d=c-p/n,l.alignX==="Mid"&&(s=d/2),l.alignX==="Max"&&(s=d),d=i-m/e,l.alignY==="Mid"&&(f=d/2),l.alignY==="Max"&&(f=d),c=p/n,i=m/e)):(n=p/c,e=m/i),{width:c,height:i,scaleX:n,scaleY:e,offsetLeft:o,offsetTop:u,cropX:s,cropY:f}}}),t.Image.CSS_CANVAS="canvas-img",t.Image.prototype.getSvgSrc=t.Image.prototype.getSrc,t.Image.fromObject=function(l,c){var i=t.util.object.clone(l);t.util.loadImage(i.src,function(n,e){if(e){c&&c(null,!0);return}t.Image.prototype._initFilters.call(i,i.filters,function(o){i.filters=o||[],t.Image.prototype._initFilters.call(i,[i.resizeFilter],function(u){i.resizeFilter=u[0],t.util.enlivenObjects([i.clipPath],function(s){i.clipPath=s[0];var f=new t.Image(n,i);c(f,!1)})})})},null,i.crossOrigin)},t.Image.fromURL=function(l,c,i){t.util.loadImage(l,function(n,e){c&&c(new t.Image(n,i),e)},null,i&&i.crossOrigin)},t.Image.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),t.Image.fromElement=function(l,c,i){var n=t.parseAttributes(l,t.Image.ATTRIBUTE_NAMES);t.Image.fromURL(n["xlink:href"],c,r(i?t.util.object.clone(i):{},n))}}(a),t.util.object.extend(t.Object.prototype,{_getAngleValueForStraighten:function(){var h=this.angle%360;return h>0?Math.round((h-1)/90)*90:Math.round(h/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten()),this},fxStraighten:function(h){h=h||{};var r=function(){},l=h.onComplete||r,c=h.onChange||r,i=this;return t.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(n){i.rotate(n),c()},onComplete:function(){i.setCoords(),l()}}),this}}),t.util.object.extend(t.StaticCanvas.prototype,{straightenObject:function(h){return h.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(h){return h.fxStraighten({onChange:this.requestRenderAllBound}),this}}),function(){function h(l,c){var i="precision "+c+` float;
void main(){}`,n=l.createShader(l.FRAGMENT_SHADER);return l.shaderSource(n,i),l.compileShader(n),!!l.getShaderParameter(n,l.COMPILE_STATUS)}t.isWebglSupported=function(l){if(t.isLikelyNode)return!1;l=l||t.WebglFilterBackend.prototype.tileSize;var c=document.createElement("canvas"),i=c.getContext("webgl")||c.getContext("experimental-webgl"),n=!1;if(i){t.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),n=t.maxTextureSize>=l;for(var e=["highp","mediump","lowp"],o=0;o<3;o++)if(h(i,e[o])){t.webGlPrecision=e[o];break}}return this.isSupported=n,n},t.WebglFilterBackend=r;function r(l){l&&l.tileSize&&(this.tileSize=l.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}r.prototype={tileSize:2048,resources:{},setupGLContext:function(l,c){this.dispose(),this.createWebGLCanvas(l,c),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(l,c)},chooseFastestCopyGLTo2DMethod:function(l,c){var i=typeof window.performance!="undefined",n;try{new ImageData(1,1),n=!0}catch{n=!1}var e=typeof ArrayBuffer!="undefined",o=typeof Uint8ClampedArray!="undefined";if(!!(i&&n&&e&&o)){var u=t.util.createCanvasElement(),s=new ArrayBuffer(l*c*4);if(t.forceGLPutImageData){this.imageBuffer=s,this.copyGLTo2D=w;return}var f={imageBuffer:s,destinationWidth:l,destinationHeight:c,targetCanvas:u},d,p,m;u.width=l,u.height=c,d=window.performance.now(),C.call(f,this.gl,f),p=window.performance.now()-d,d=window.performance.now(),w.call(f,this.gl,f),m=window.performance.now()-d,p>m?(this.imageBuffer=s,this.copyGLTo2D=w):this.copyGLTo2D=C}},createWebGLCanvas:function(l,c){var i=t.util.createCanvasElement();i.width=l,i.height=c;var n={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},e=i.getContext("webgl",n);e||(e=i.getContext("experimental-webgl",n)),!!e&&(e.clearColor(0,0,0,0),this.canvas=i,this.gl=e)},applyFilters:function(l,c,i,n,e,o){var u=this.gl,s;o&&(s=this.getCachedTexture(o,c));var f={originalWidth:c.width||c.originalWidth,originalHeight:c.height||c.originalHeight,sourceWidth:i,sourceHeight:n,destinationWidth:i,destinationHeight:n,context:u,sourceTexture:this.createTexture(u,i,n,!s&&c),targetTexture:this.createTexture(u,i,n),originalTexture:s||this.createTexture(u,i,n,!s&&c),passes:l.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:e},d=u.createFramebuffer();return u.bindFramebuffer(u.FRAMEBUFFER,d),l.forEach(function(p){p&&p.applyTo(f)}),_(f),this.copyGLTo2D(u,f),u.bindTexture(u.TEXTURE_2D,null),u.deleteTexture(f.sourceTexture),u.deleteTexture(f.targetTexture),u.deleteFramebuffer(d),e.getContext("2d").setTransform(1,0,0,1,0,0),f},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(l,c,i,n){var e=l.createTexture();return l.bindTexture(l.TEXTURE_2D,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),n?l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,n):l.texImage2D(l.TEXTURE_2D,0,l.RGBA,c,i,0,l.RGBA,l.UNSIGNED_BYTE,null),e},getCachedTexture:function(l,c){if(this.textureCache[l])return this.textureCache[l];var i=this.createTexture(this.gl,c.width,c.height,c);return this.textureCache[l]=i,i},evictCachesForKey:function(l){this.textureCache[l]&&(this.gl.deleteTexture(this.textureCache[l]),delete this.textureCache[l])},copyGLTo2D:C,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var l=this.gl,c={renderer:"",vendor:""};if(!l)return c;var i=l.getExtension("WEBGL_debug_renderer_info");if(i){var n=l.getParameter(i.UNMASKED_RENDERER_WEBGL),e=l.getParameter(i.UNMASKED_VENDOR_WEBGL);n&&(c.renderer=n.toLowerCase()),e&&(c.vendor=e.toLowerCase())}return this.gpuInfo=c,c}}}();function _(h){var r=h.targetCanvas,l=r.width,c=r.height,i=h.destinationWidth,n=h.destinationHeight;(l!==i||c!==n)&&(r.width=i,r.height=n)}function C(h,r){var l=h.canvas,c=r.targetCanvas,i=c.getContext("2d");i.translate(0,c.height),i.scale(1,-1);var n=l.height-c.height;i.drawImage(l,0,n,c.width,c.height,0,0,c.width,c.height)}function w(h,r){var l=r.targetCanvas,c=l.getContext("2d"),i=r.destinationWidth,n=r.destinationHeight,e=i*n*4,o=new Uint8Array(this.imageBuffer,0,e),u=new Uint8ClampedArray(this.imageBuffer,0,e);h.readPixels(0,0,i,n,h.RGBA,h.UNSIGNED_BYTE,o);var s=new ImageData(u,i,n);c.putImageData(s,0,0)}(function(){var h=function(){};t.Canvas2dFilterBackend=r;function r(){}r.prototype={evictCachesForKey:h,dispose:h,clearWebGLCaches:h,resources:{},applyFilters:function(l,c,i,n,e){var o=e.getContext("2d");o.drawImage(c,0,0,i,n);var u=o.getImageData(0,0,i,n),s=o.getImageData(0,0,i,n),f={sourceWidth:i,sourceHeight:n,imageData:u,originalEl:c,originalImageData:s,canvasEl:e,ctx:o,filterBackend:this};return l.forEach(function(d){d.applyTo(f)}),(f.imageData.width!==i||f.imageData.height!==n)&&(e.width=f.imageData.width,e.height=f.imageData.height),o.putImageData(f.imageData,0,0),f}}})(),t.Image=t.Image||{},t.Image.filters=t.Image.filters||{},t.Image.filters.BaseFilter=t.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(h){h&&this.setOptions(h)},setOptions:function(h){for(var r in h)this[r]=h[r]},createProgram:function(h,r,l){r=r||this.fragmentSource,l=l||this.vertexSource,t.webGlPrecision!=="highp"&&(r=r.replace(/precision highp float/g,"precision "+t.webGlPrecision+" float"));var c=h.createShader(h.VERTEX_SHADER);if(h.shaderSource(c,l),h.compileShader(c),!h.getShaderParameter(c,h.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+h.getShaderInfoLog(c));var i=h.createShader(h.FRAGMENT_SHADER);if(h.shaderSource(i,r),h.compileShader(i),!h.getShaderParameter(i,h.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+h.getShaderInfoLog(i));var n=h.createProgram();if(h.attachShader(n,c),h.attachShader(n,i),h.linkProgram(n),!h.getProgramParameter(n,h.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+h.getProgramInfoLog(n));var e=this.getAttributeLocations(h,n),o=this.getUniformLocations(h,n)||{};return o.uStepW=h.getUniformLocation(n,"uStepW"),o.uStepH=h.getUniformLocation(n,"uStepH"),{program:n,attributeLocations:e,uniformLocations:o}},getAttributeLocations:function(h,r){return{aPosition:h.getAttribLocation(r,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(h,r,l){var c=r.aPosition,i=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,i),h.enableVertexAttribArray(c),h.vertexAttribPointer(c,2,h.FLOAT,!1,0,0),h.bufferData(h.ARRAY_BUFFER,l,h.STATIC_DRAW)},_setupFrameBuffer:function(h){var r=h.context,l,c;h.passes>1?(l=h.destinationWidth,c=h.destinationHeight,(h.sourceWidth!==l||h.sourceHeight!==c)&&(r.deleteTexture(h.targetTexture),h.targetTexture=h.filterBackend.createTexture(r,l,c)),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,h.targetTexture,0)):(r.bindFramebuffer(r.FRAMEBUFFER,null),r.finish())},_swapTextures:function(h){h.passes--,h.pass++;var r=h.targetTexture;h.targetTexture=h.sourceTexture,h.sourceTexture=r},isNeutralState:function(){var h=this.mainParameter,r=t.Image.filters[this.type].prototype;if(h)if(Array.isArray(r[h])){for(var l=r[h].length;l--;)if(this[h][l]!==r[h][l])return!1;return!0}else return r[h]===this[h];else return!1},applyTo:function(h){h.webgl?(this._setupFrameBuffer(h),this.applyToWebGL(h),this._swapTextures(h)):this.applyTo2d(h)},retrieveShader:function(h){return h.programCache.hasOwnProperty(this.type)||(h.programCache[this.type]=this.createProgram(h.context)),h.programCache[this.type]},applyToWebGL:function(h){var r=h.context,l=this.retrieveShader(h);h.pass===0&&h.originalTexture?r.bindTexture(r.TEXTURE_2D,h.originalTexture):r.bindTexture(r.TEXTURE_2D,h.sourceTexture),r.useProgram(l.program),this.sendAttributeData(r,l.attributeLocations,h.aPosition),r.uniform1f(l.uniformLocations.uStepW,1/h.sourceWidth),r.uniform1f(l.uniformLocations.uStepH,1/h.sourceHeight),this.sendUniformData(r,l.uniformLocations),r.viewport(0,0,h.destinationWidth,h.destinationHeight),r.drawArrays(r.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(h,r,l){h.activeTexture(l),h.bindTexture(h.TEXTURE_2D,r),h.activeTexture(h.TEXTURE0)},unbindAdditionalTexture:function(h,r){h.activeTexture(r),h.bindTexture(h.TEXTURE_2D,null),h.activeTexture(h.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(h){this[this.mainParameter]=h},sendUniformData:function(){},createHelpLayer:function(h){if(!h.helpLayer){var r=document.createElement("canvas");r.width=h.sourceWidth,r.height=h.sourceHeight,h.helpLayer=r}},toObject:function(){var h={type:this.type},r=this.mainParameter;return r&&(h[r]=this[r]),h},toJSON:function(){return this.toObject()}}),t.Image.filters.BaseFilter.fromObject=function(h,r){var l=new t.Image.filters[h.type](h);return r&&r(l),l},function(h){var r=h.fabric||(h.fabric={}),l=r.Image.filters,c=r.util.createClass;l.ColorMatrix=c(l.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(i){this.callSuper("initialize",i),this.matrix=this.matrix.slice(0)},applyTo2d:function(i){var n=i.imageData,e=n.data,o=e.length,u=this.matrix,s,f,d,p,m,y=this.colorsOnly;for(m=0;m<o;m+=4)s=e[m],f=e[m+1],d=e[m+2],y?(e[m]=s*u[0]+f*u[1]+d*u[2]+u[4]*255,e[m+1]=s*u[5]+f*u[6]+d*u[7]+u[9]*255,e[m+2]=s*u[10]+f*u[11]+d*u[12]+u[14]*255):(p=e[m+3],e[m]=s*u[0]+f*u[1]+d*u[2]+p*u[3]+u[4]*255,e[m+1]=s*u[5]+f*u[6]+d*u[7]+p*u[8]+u[9]*255,e[m+2]=s*u[10]+f*u[11]+d*u[12]+p*u[13]+u[14]*255,e[m+3]=s*u[15]+f*u[16]+d*u[17]+p*u[18]+u[19]*255)},getUniformLocations:function(i,n){return{uColorMatrix:i.getUniformLocation(n,"uColorMatrix"),uConstants:i.getUniformLocation(n,"uConstants")}},sendUniformData:function(i,n){var e=this.matrix,o=[e[0],e[1],e[2],e[3],e[5],e[6],e[7],e[8],e[10],e[11],e[12],e[13],e[15],e[16],e[17],e[18]],u=[e[4],e[9],e[14],e[19]];i.uniformMatrix4fv(n.uColorMatrix,!1,o),i.uniform4fv(n.uConstants,u)}}),r.Image.filters.ColorMatrix.fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.Image.filters,c=r.util.createClass;l.Brightness=c(l.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(i){if(this.brightness!==0){var n=i.imageData,e=n.data,o,u=e.length,s=Math.round(this.brightness*255);for(o=0;o<u;o+=4)e[o]=e[o]+s,e[o+1]=e[o+1]+s,e[o+2]=e[o+2]+s}},getUniformLocations:function(i,n){return{uBrightness:i.getUniformLocation(n,"uBrightness")}},sendUniformData:function(i,n){i.uniform1f(n.uBrightness,this.brightness)}}),r.Image.filters.Brightness.fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.util.object.extend,c=r.Image.filters,i=r.util.createClass;c.Convolute=i(c.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(n){var e=Math.sqrt(this.matrix.length),o=this.type+"_"+e+"_"+(this.opaque?1:0),u=this.fragmentSource[o];return n.programCache.hasOwnProperty(o)||(n.programCache[o]=this.createProgram(n.context,u)),n.programCache[o]},applyTo2d:function(n){var e=n.imageData,o=e.data,u=this.matrix,s=Math.round(Math.sqrt(u.length)),f=Math.floor(s/2),d=e.width,p=e.height,m=n.ctx.createImageData(d,p),y=m.data,S=this.opaque?1:0,O,R,Y,q,tt,Z,it,et,ot,at,st,nt,D;for(st=0;st<p;st++)for(at=0;at<d;at++){for(tt=(st*d+at)*4,O=0,R=0,Y=0,q=0,D=0;D<s;D++)for(nt=0;nt<s;nt++)it=st+D-f,Z=at+nt-f,!(it<0||it>=p||Z<0||Z>=d)&&(et=(it*d+Z)*4,ot=u[D*s+nt],O+=o[et]*ot,R+=o[et+1]*ot,Y+=o[et+2]*ot,S||(q+=o[et+3]*ot));y[tt]=O,y[tt+1]=R,y[tt+2]=Y,S?y[tt+3]=o[tt+3]:y[tt+3]=q}n.imageData=m},getUniformLocations:function(n,e){return{uMatrix:n.getUniformLocation(e,"uMatrix"),uOpaque:n.getUniformLocation(e,"uOpaque"),uHalfSize:n.getUniformLocation(e,"uHalfSize"),uSize:n.getUniformLocation(e,"uSize")}},sendUniformData:function(n,e){n.uniform1fv(e.uMatrix,this.matrix)},toObject:function(){return l(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),r.Image.filters.Convolute.fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.Image.filters,c=r.util.createClass;l.Grayscale=c(l.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(i){var n=i.imageData,e=n.data,o,u=e.length,s,f=this.mode;for(o=0;o<u;o+=4)f==="average"?s=(e[o]+e[o+1]+e[o+2])/3:f==="lightness"?s=(Math.min(e[o],e[o+1],e[o+2])+Math.max(e[o],e[o+1],e[o+2]))/2:f==="luminosity"&&(s=.21*e[o]+.72*e[o+1]+.07*e[o+2]),e[o]=s,e[o+1]=s,e[o+2]=s},retrieveShader:function(i){var n=this.type+"_"+this.mode;if(!i.programCache.hasOwnProperty(n)){var e=this.fragmentSource[this.mode];i.programCache[n]=this.createProgram(i.context,e)}return i.programCache[n]},getUniformLocations:function(i,n){return{uMode:i.getUniformLocation(n,"uMode")}},sendUniformData:function(i,n){var e=1;i.uniform1i(n.uMode,e)},isNeutralState:function(){return!1}}),r.Image.filters.Grayscale.fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.Image.filters,c=r.util.createClass;l.Invert=c(l.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(i){var n=i.imageData,e=n.data,o,u=e.length;for(o=0;o<u;o+=4)e[o]=255-e[o],e[o+1]=255-e[o+1],e[o+2]=255-e[o+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(i,n){return{uInvert:i.getUniformLocation(n,"uInvert")}},sendUniformData:function(i,n){i.uniform1i(n.uInvert,this.invert)}}),r.Image.filters.Invert.fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.util.object.extend,c=r.Image.filters,i=r.util.createClass;c.Noise=i(c.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(n){if(this.noise!==0){var e=n.imageData,o=e.data,u,s=o.length,f=this.noise,d;for(u=0,s=o.length;u<s;u+=4)d=(.5-Math.random())*f,o[u]+=d,o[u+1]+=d,o[u+2]+=d}},getUniformLocations:function(n,e){return{uNoise:n.getUniformLocation(e,"uNoise"),uSeed:n.getUniformLocation(e,"uSeed")}},sendUniformData:function(n,e){n.uniform1f(e.uNoise,this.noise/255),n.uniform1f(e.uSeed,Math.random())},toObject:function(){return l(this.callSuper("toObject"),{noise:this.noise})}}),r.Image.filters.Noise.fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.Image.filters,c=r.util.createClass;l.Pixelate=c(l.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(i){var n=i.imageData,e=n.data,o=n.height,u=n.width,s,f,d,p,m,y,S,O,R,Y,q;for(f=0;f<o;f+=this.blocksize)for(d=0;d<u;d+=this.blocksize)for(s=f*4*u+d*4,p=e[s],m=e[s+1],y=e[s+2],S=e[s+3],Y=Math.min(f+this.blocksize,o),q=Math.min(d+this.blocksize,u),O=f;O<Y;O++)for(R=d;R<q;R++)s=O*4*u+R*4,e[s]=p,e[s+1]=m,e[s+2]=y,e[s+3]=S},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(i,n){return{uBlocksize:i.getUniformLocation(n,"uBlocksize"),uStepW:i.getUniformLocation(n,"uStepW"),uStepH:i.getUniformLocation(n,"uStepH")}},sendUniformData:function(i,n){i.uniform1f(n.uBlocksize,this.blocksize)}}),r.Image.filters.Pixelate.fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.util.object.extend,c=r.Image.filters,i=r.util.createClass;c.RemoveColor=i(c.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(n){var e=n.imageData,o=e.data,u,s=this.distance*255,f,d,p,m=new r.Color(this.color).getSource(),y=[m[0]-s,m[1]-s,m[2]-s],S=[m[0]+s,m[1]+s,m[2]+s];for(u=0;u<o.length;u+=4)f=o[u],d=o[u+1],p=o[u+2],f>y[0]&&d>y[1]&&p>y[2]&&f<S[0]&&d<S[1]&&p<S[2]&&(o[u+3]=0)},getUniformLocations:function(n,e){return{uLow:n.getUniformLocation(e,"uLow"),uHigh:n.getUniformLocation(e,"uHigh")}},sendUniformData:function(n,e){var o=new r.Color(this.color).getSource(),u=parseFloat(this.distance),s=[0+o[0]/255-u,0+o[1]/255-u,0+o[2]/255-u,1],f=[o[0]/255+u,o[1]/255+u,o[2]/255+u,1];n.uniform4fv(e.uLow,s),n.uniform4fv(e.uHigh,f)},toObject:function(){return l(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),r.Image.filters.RemoveColor.fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.Image.filters,c=r.util.createClass,i={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var n in i)l[n]=c(l.ColorMatrix,{type:n,matrix:i[n],mainParameter:!1,colorsOnly:!0}),r.Image.filters[n].fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric,l=r.Image.filters,c=r.util.createClass;l.BlendColor=c(l.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(i){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[i]+`}
}`},retrieveShader:function(i){var n=this.type+"_"+this.mode,e;return i.programCache.hasOwnProperty(n)||(e=this.buildSource(this.mode),i.programCache[n]=this.createProgram(i.context,e)),i.programCache[n]},applyTo2d:function(i){var n=i.imageData,e=n.data,o=e.length,u,s,f,d,p,m,y,S=1-this.alpha;y=new r.Color(this.color).getSource(),u=y[0]*this.alpha,s=y[1]*this.alpha,f=y[2]*this.alpha;for(var O=0;O<o;O+=4)switch(d=e[O],p=e[O+1],m=e[O+2],this.mode){case"multiply":e[O]=d*u/255,e[O+1]=p*s/255,e[O+2]=m*f/255;break;case"screen":e[O]=255-(255-d)*(255-u)/255,e[O+1]=255-(255-p)*(255-s)/255,e[O+2]=255-(255-m)*(255-f)/255;break;case"add":e[O]=d+u,e[O+1]=p+s,e[O+2]=m+f;break;case"diff":case"difference":e[O]=Math.abs(d-u),e[O+1]=Math.abs(p-s),e[O+2]=Math.abs(m-f);break;case"subtract":e[O]=d-u,e[O+1]=p-s,e[O+2]=m-f;break;case"darken":e[O]=Math.min(d,u),e[O+1]=Math.min(p,s),e[O+2]=Math.min(m,f);break;case"lighten":e[O]=Math.max(d,u),e[O+1]=Math.max(p,s),e[O+2]=Math.max(m,f);break;case"overlay":e[O]=u<128?2*d*u/255:255-2*(255-d)*(255-u)/255,e[O+1]=s<128?2*p*s/255:255-2*(255-p)*(255-s)/255,e[O+2]=f<128?2*m*f/255:255-2*(255-m)*(255-f)/255;break;case"exclusion":e[O]=u+d-2*u*d/255,e[O+1]=s+p-2*s*p/255,e[O+2]=f+m-2*f*m/255;break;case"tint":e[O]=u+d*S,e[O+1]=s+p*S,e[O+2]=f+m*S}},getUniformLocations:function(i,n){return{uColor:i.getUniformLocation(n,"uColor")}},sendUniformData:function(i,n){var e=new r.Color(this.color).getSource();e[0]=this.alpha*e[0]/255,e[1]=this.alpha*e[1]/255,e[2]=this.alpha*e[2]/255,e[3]=this.alpha,i.uniform4fv(n.uColor,e)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),r.Image.filters.BlendColor.fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric,l=r.Image.filters,c=r.util.createClass;l.BlendImage=c(l.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(i){var n=this.type+"_"+this.mode,e=this.fragmentSource[this.mode];return i.programCache.hasOwnProperty(n)||(i.programCache[n]=this.createProgram(i.context,e)),i.programCache[n]},applyToWebGL:function(i){var n=i.context,e=this.createTexture(i.filterBackend,this.image);this.bindAdditionalTexture(n,e,n.TEXTURE1),this.callSuper("applyToWebGL",i),this.unbindAdditionalTexture(n,n.TEXTURE1)},createTexture:function(i,n){return i.getCachedTexture(n.cacheKey,n._element)},calculateMatrix:function(){var i=this.image,n=i._element.width,e=i._element.height;return[1/i.scaleX,0,0,0,1/i.scaleY,0,-i.left/n,-i.top/e,1]},applyTo2d:function(i){var n=i.imageData,e=i.filterBackend.resources,o=n.data,u=o.length,s=n.width,f=n.height,d,p,m,y,S,O,R,Y,q,tt,Z=this.image,it;e.blendImage||(e.blendImage=r.util.createCanvasElement()),q=e.blendImage,tt=q.getContext("2d"),q.width!==s||q.height!==f?(q.width=s,q.height=f):tt.clearRect(0,0,s,f),tt.setTransform(Z.scaleX,0,0,Z.scaleY,Z.left,Z.top),tt.drawImage(Z._element,0,0,s,f),it=tt.getImageData(0,0,s,f).data;for(var et=0;et<u;et+=4)switch(S=o[et],O=o[et+1],R=o[et+2],Y=o[et+3],d=it[et],p=it[et+1],m=it[et+2],y=it[et+3],this.mode){case"multiply":o[et]=S*d/255,o[et+1]=O*p/255,o[et+2]=R*m/255,o[et+3]=Y*y/255;break;case"mask":o[et+3]=y;break}},getUniformLocations:function(i,n){return{uTransformMatrix:i.getUniformLocation(n,"uTransformMatrix"),uImage:i.getUniformLocation(n,"uImage")}},sendUniformData:function(i,n){var e=this.calculateMatrix();i.uniform1i(n.uImage,1),i.uniformMatrix3fv(n.uTransformMatrix,!1,e)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),r.Image.filters.BlendImage.fromObject=function(i,n){r.Image.fromObject(i.image,function(e){var o=r.util.object.clone(i);o.image=e,n(new r.Image.filters.BlendImage(o))})}}(a),function(h){var r=h.fabric||(h.fabric={}),l=Math.pow,c=Math.floor,i=Math.sqrt,n=Math.abs,e=Math.round,o=Math.sin,u=Math.ceil,s=r.Image.filters,f=r.util.createClass;s.Resize=f(s.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(d,p){return{uDelta:d.getUniformLocation(p,"uDelta"),uTaps:d.getUniformLocation(p,"uTaps")}},sendUniformData:function(d,p){d.uniform2fv(p.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),d.uniform1fv(p.uTaps,this.taps)},retrieveShader:function(d){var p=this.getFilterWindow(),m=this.type+"_"+p;if(!d.programCache.hasOwnProperty(m)){var y=this.generateShader(p);d.programCache[m]=this.createProgram(d.context,y)}return d.programCache[m]},getFilterWindow:function(){var d=this.tempScale;return Math.ceil(this.lanczosLobes/d)},getTaps:function(){for(var d=this.lanczosCreate(this.lanczosLobes),p=this.tempScale,m=this.getFilterWindow(),y=new Array(m),S=1;S<=m;S++)y[S-1]=d(S*p);return y},generateShader:function(d){for(var p=new Array(d),m=this.fragmentSourceTOP,d,y=1;y<=d;y++)p[y-1]=y+".0 * uDelta";return m+="uniform float uTaps["+d+`];
`,m+=`void main() {
`,m+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,m+=`  float sum = 1.0;
`,p.forEach(function(S,O){m+="  color += texture2D(uTexture, vTexCoord + "+S+") * uTaps["+O+`];
`,m+="  color += texture2D(uTexture, vTexCoord - "+S+") * uTaps["+O+`];
`,m+="  sum += 2.0 * uTaps["+O+`];
`}),m+=`  gl_FragColor = color / sum;
`,m+="}",m},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(d){d.webgl?(d.passes++,this.width=d.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=d.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),d.destinationWidth=this.dW,this._setupFrameBuffer(d),this.applyToWebGL(d),this._swapTextures(d),d.sourceWidth=d.destinationWidth,this.height=d.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),d.destinationHeight=this.dH,this._setupFrameBuffer(d),this.applyToWebGL(d),this._swapTextures(d),d.sourceHeight=d.destinationHeight):this.applyTo2d(d)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(d){return function(p){if(p>=d||p<=-d)return 0;if(p<11920929e-14&&p>-11920929e-14)return 1;p*=Math.PI;var m=p/d;return o(p)/p*o(m)/m}},applyTo2d:function(d){var p=d.imageData,m=this.scaleX,y=this.scaleY;this.rcpScaleX=1/m,this.rcpScaleY=1/y;var S=p.width,O=p.height,R=e(S*m),Y=e(O*y),q;this.resizeType==="sliceHack"?q=this.sliceByTwo(d,S,O,R,Y):this.resizeType==="hermite"?q=this.hermiteFastResize(d,S,O,R,Y):this.resizeType==="bilinear"?q=this.bilinearFiltering(d,S,O,R,Y):this.resizeType==="lanczos"&&(q=this.lanczosResize(d,S,O,R,Y)),d.imageData=q},sliceByTwo:function(d,p,m,y,S){var O=d.imageData,R=.5,Y=!1,q=!1,tt=p*R,Z=m*R,it=r.filterBackend.resources,et,ot,at=0,st=0,nt=p,D=0;for(it.sliceByTwo||(it.sliceByTwo=document.createElement("canvas")),et=it.sliceByTwo,(et.width<p*1.5||et.height<m)&&(et.width=p*1.5,et.height=m),ot=et.getContext("2d"),ot.clearRect(0,0,p*1.5,m),ot.putImageData(O,0,0),y=c(y),S=c(S);!Y||!q;)p=tt,m=Z,y<c(tt*R)?tt=c(tt*R):(tt=y,Y=!0),S<c(Z*R)?Z=c(Z*R):(Z=S,q=!0),ot.drawImage(et,at,st,p,m,nt,D,tt,Z),at=nt,st=D,D+=Z;return ot.getImageData(at,st,y,S)},lanczosResize:function(d,p,m,y,S){function O(F){var j,W,T,P,L,k,z,H,V,$,Q;for(D.x=(F+.5)*Z,G.x=c(D.x),j=0;j<S;j++){for(D.y=(j+.5)*it,G.y=c(D.y),L=0,k=0,z=0,H=0,V=0,W=G.x-at;W<=G.x+at;W++)if(!(W<0||W>=p)){$=c(1e3*n(W-D.x)),nt[$]||(nt[$]={});for(var b=G.y-st;b<=G.y+st;b++)b<0||b>=m||(Q=c(1e3*n(b-D.y)),nt[$][Q]||(nt[$][Q]=tt(i(l($*et,2)+l(Q*ot,2))/1e3)),T=nt[$][Q],T>0&&(P=(b*p+W)*4,L+=T,k+=T*R[P],z+=T*R[P+1],H+=T*R[P+2],V+=T*R[P+3]))}P=(j*y+F)*4,q[P]=k/L,q[P+1]=z/L,q[P+2]=H/L,q[P+3]=V/L}return++F<y?O(F):Y}var R=d.imageData.data,Y=d.ctx.createImageData(y,S),q=Y.data,tt=this.lanczosCreate(this.lanczosLobes),Z=this.rcpScaleX,it=this.rcpScaleY,et=2/this.rcpScaleX,ot=2/this.rcpScaleY,at=u(Z*this.lanczosLobes/2),st=u(it*this.lanczosLobes/2),nt={},D={},G={};return O(0)},bilinearFiltering:function(d,p,m,y,S){var O,R,Y,q,tt,Z,it,et,ot,at,st,nt,D=0,G,F=this.rcpScaleX,j=this.rcpScaleY,W=4*(p-1),T=d.imageData,P=T.data,L=d.ctx.createImageData(y,S),k=L.data;for(it=0;it<S;it++)for(et=0;et<y;et++)for(tt=c(F*et),Z=c(j*it),ot=F*et-tt,at=j*it-Z,G=4*(Z*p+tt),st=0;st<4;st++)O=P[G+st],R=P[G+4+st],Y=P[G+W+st],q=P[G+W+4+st],nt=O*(1-ot)*(1-at)+R*ot*(1-at)+Y*at*(1-ot)+q*ot*at,k[D++]=nt;return L},hermiteFastResize:function(d,p,m,y,S){for(var O=this.rcpScaleX,R=this.rcpScaleY,Y=u(O/2),q=u(R/2),tt=d.imageData,Z=tt.data,it=d.ctx.createImageData(y,S),et=it.data,ot=0;ot<S;ot++)for(var at=0;at<y;at++){for(var st=(at+ot*y)*4,nt=0,D=0,G=0,F=0,j=0,W=0,T=0,P=(ot+.5)*R,L=c(ot*R);L<(ot+1)*R;L++)for(var k=n(P-(L+.5))/q,z=(at+.5)*O,H=k*k,V=c(at*O);V<(at+1)*O;V++){var $=n(z-(V+.5))/Y,Q=i(H+$*$);Q>1&&Q<-1||(nt=2*Q*Q*Q-3*Q*Q+1,nt>0&&($=4*(V+L*p),T+=nt*Z[$+3],G+=nt,Z[$+3]<255&&(nt=nt*Z[$+3]/250),F+=nt*Z[$],j+=nt*Z[$+1],W+=nt*Z[$+2],D+=nt))}et[st]=F/D,et[st+1]=j/D,et[st+2]=W/D,et[st+3]=T/G}return it},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),r.Image.filters.Resize.fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.Image.filters,c=r.util.createClass;l.Contrast=c(l.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(i){if(this.contrast!==0){var n=i.imageData,e,o,u=n.data,o=u.length,s=Math.floor(this.contrast*255),f=259*(s+255)/(255*(259-s));for(e=0;e<o;e+=4)u[e]=f*(u[e]-128)+128,u[e+1]=f*(u[e+1]-128)+128,u[e+2]=f*(u[e+2]-128)+128}},getUniformLocations:function(i,n){return{uContrast:i.getUniformLocation(n,"uContrast")}},sendUniformData:function(i,n){i.uniform1f(n.uContrast,this.contrast)}}),r.Image.filters.Contrast.fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.Image.filters,c=r.util.createClass;l.Saturation=c(l.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(i){if(this.saturation!==0){var n=i.imageData,e=n.data,o=e.length,u=-this.saturation,s,f;for(s=0;s<o;s+=4)f=Math.max(e[s],e[s+1],e[s+2]),e[s]+=f!==e[s]?(f-e[s])*u:0,e[s+1]+=f!==e[s+1]?(f-e[s+1])*u:0,e[s+2]+=f!==e[s+2]?(f-e[s+2])*u:0}},getUniformLocations:function(i,n){return{uSaturation:i.getUniformLocation(n,"uSaturation")}},sendUniformData:function(i,n){i.uniform1f(n.uSaturation,-this.saturation)}}),r.Image.filters.Saturation.fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.Image.filters,c=r.util.createClass;l.Vibrance=c(l.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(i){if(this.vibrance!==0){var n=i.imageData,e=n.data,o=e.length,u=-this.vibrance,s,f,d,p;for(s=0;s<o;s+=4)f=Math.max(e[s],e[s+1],e[s+2]),d=(e[s]+e[s+1]+e[s+2])/3,p=Math.abs(f-d)*2/255*u,e[s]+=f!==e[s]?(f-e[s])*p:0,e[s+1]+=f!==e[s+1]?(f-e[s+1])*p:0,e[s+2]+=f!==e[s+2]?(f-e[s+2])*p:0}},getUniformLocations:function(i,n){return{uVibrance:i.getUniformLocation(n,"uVibrance")}},sendUniformData:function(i,n){i.uniform1f(n.uVibrance,-this.vibrance)}}),r.Image.filters.Vibrance.fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.Image.filters,c=r.util.createClass;l.Blur=c(l.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(i){i.webgl?(this.aspectRatio=i.sourceWidth/i.sourceHeight,i.passes++,this._setupFrameBuffer(i),this.horizontal=!0,this.applyToWebGL(i),this._swapTextures(i),this._setupFrameBuffer(i),this.horizontal=!1,this.applyToWebGL(i),this._swapTextures(i)):this.applyTo2d(i)},applyTo2d:function(i){i.imageData=this.simpleBlur(i)},simpleBlur:function(i){var n=i.filterBackend.resources,e,o,u=i.imageData.width,s=i.imageData.height;n.blurLayer1||(n.blurLayer1=r.util.createCanvasElement(),n.blurLayer2=r.util.createCanvasElement()),e=n.blurLayer1,o=n.blurLayer2,(e.width!==u||e.height!==s)&&(o.width=e.width=u,o.height=e.height=s);var f=e.getContext("2d"),d=o.getContext("2d"),p=15,m,y,S,O,R=this.blur*.06*.5;for(f.putImageData(i.imageData,0,0),d.clearRect(0,0,u,s),O=-p;O<=p;O++)m=(Math.random()-.5)/4,y=O/p,S=R*y*u+m,d.globalAlpha=1-Math.abs(y),d.drawImage(e,S,m),f.drawImage(o,0,0),d.globalAlpha=1,d.clearRect(0,0,o.width,o.height);for(O=-p;O<=p;O++)m=(Math.random()-.5)/4,y=O/p,S=R*y*s+m,d.globalAlpha=1-Math.abs(y),d.drawImage(e,m,S),f.drawImage(o,0,0),d.globalAlpha=1,d.clearRect(0,0,o.width,o.height);i.ctx.drawImage(e,0,0);var Y=i.ctx.getImageData(0,0,e.width,e.height);return f.globalAlpha=1,f.clearRect(0,0,e.width,e.height),Y},getUniformLocations:function(i,n){return{delta:i.getUniformLocation(n,"uDelta")}},sendUniformData:function(i,n){var e=this.chooseRightDelta();i.uniform2fv(n.delta,e)},chooseRightDelta:function(){var i=1,n=[0,0],e;return this.horizontal?this.aspectRatio>1&&(i=1/this.aspectRatio):this.aspectRatio<1&&(i=this.aspectRatio),e=i*this.blur*.12,this.horizontal?n[0]=e:n[1]=e,n}}),l.Blur.fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.Image.filters,c=r.util.createClass;l.Gamma=c(l.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(i){this.gamma=[1,1,1],l.BaseFilter.prototype.initialize.call(this,i)},applyTo2d:function(i){var n=i.imageData,e=n.data,o=this.gamma,u=e.length,s=1/o[0],f=1/o[1],d=1/o[2],p;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),p=0,u=256;p<u;p++)this.rVals[p]=Math.pow(p/255,s)*255,this.gVals[p]=Math.pow(p/255,f)*255,this.bVals[p]=Math.pow(p/255,d)*255;for(p=0,u=e.length;p<u;p+=4)e[p]=this.rVals[e[p]],e[p+1]=this.gVals[e[p+1]],e[p+2]=this.bVals[e[p+2]]},getUniformLocations:function(i,n){return{uGamma:i.getUniformLocation(n,"uGamma")}},sendUniformData:function(i,n){i.uniform3fv(n.uGamma,this.gamma)}}),r.Image.filters.Gamma.fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.Image.filters,c=r.util.createClass;l.Composed=c(l.BaseFilter,{type:"Composed",subFilters:[],initialize:function(i){this.callSuper("initialize",i),this.subFilters=this.subFilters.slice(0)},applyTo:function(i){i.passes+=this.subFilters.length-1,this.subFilters.forEach(function(n){n.applyTo(i)})},toObject:function(){return r.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(i){return i.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(i){return!i.isNeutralState()})}}),r.Image.filters.Composed.fromObject=function(i,n){var e=i.subFilters||[],o=e.map(function(s){return new r.Image.filters[s.type](s)}),u=new r.Image.filters.Composed({subFilters:o});return n&&n(u),u}}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.Image.filters,c=r.util.createClass;l.HueRotation=c(l.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var i=this.rotation*Math.PI,n=r.util.cos(i),e=r.util.sin(i),o=1/3,u=Math.sqrt(o)*e,s=1-n;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=n+s/3,this.matrix[1]=o*s-u,this.matrix[2]=o*s+u,this.matrix[5]=o*s+u,this.matrix[6]=n+o*s,this.matrix[7]=o*s-u,this.matrix[10]=o*s-u,this.matrix[11]=o*s+u,this.matrix[12]=n+o*s},isNeutralState:function(i){return this.calculateMatrix(),l.BaseFilter.prototype.isNeutralState.call(this,i)},applyTo:function(i){this.calculateMatrix(),l.BaseFilter.prototype.applyTo.call(this,i)}}),r.Image.filters.HueRotation.fromObject=r.Image.filters.BaseFilter.fromObject}(a),function(h){var r=h.fabric||(h.fabric={}),l=r.util.object.clone;if(r.Text){r.warn("fabric.Text is already defined");return}var c="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide".split(" ");r.Text=r.util.createClass(r.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:r.Object.prototype.stateProperties.concat(c),cacheProperties:r.Object.prototype.cacheProperties.concat(c),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(i,n){this.styles=n?n.styles||{}:{},this.text=i,this.__skipDimension=!0,this.callSuper("initialize",n),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var i=this.path;i&&(i.segmentsInfo=r.util.getPathSegmentsInfo(i.path))},getMeasuringContext:function(){return r._measuringContext||(r._measuringContext=this.canvas&&this.canvas.contextCache||r.util.createCanvasElement().getContext("2d")),r._measuringContext},_splitText:function(){var i=this._splitTextIntoLines(this.text);return this.textLines=i.lines,this._textLines=i.graphemeLines,this._unwrappedTextLines=i._unwrappedLines,this._text=i.graphemeText,i},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var i,n,e,o,u,s,f,d=0,p=this._textLines.length;d<p;d++)if(!(this.textAlign!=="justify"&&(d===p-1||this.isEndOfWrapping(d)))&&(o=0,u=this._textLines[d],n=this.getLineWidth(d),n<this.width&&(f=this.textLines[d].match(this._reSpacesAndTabs)))){e=f.length,i=(this.width-n)/e;for(var m=0,y=u.length;m<=y;m++)s=this.__charBounds[d][m],this._reSpaceAndTab.test(u[m])?(s.width+=i,s.kernedWidth+=i,s.left+=o,o+=i):s.left+=o}},isEndOfWrapping:function(i){return i===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var i=this.callSuper("_getCacheCanvasDimensions"),n=this.fontSize;return i.width+=n*i.zoomX,i.height+=n*i.zoomY,i},_render:function(i){var n=this.path;n&&!n.isNotVisible()&&n._render(i),this._setTextStyles(i),this._renderTextLinesBackground(i),this._renderTextDecoration(i,"underline"),this._renderText(i),this._renderTextDecoration(i,"overline"),this._renderTextDecoration(i,"linethrough")},_renderText:function(i){this.paintFirst==="stroke"?(this._renderTextStroke(i),this._renderTextFill(i)):(this._renderTextFill(i),this._renderTextStroke(i))},_setTextStyles:function(i,n,e){i.textBaseline="alphabetic",i.font=this._getFontDeclaration(n,e)},calcTextWidth:function(){for(var i=this.getLineWidth(0),n=1,e=this._textLines.length;n<e;n++){var o=this.getLineWidth(n);o>i&&(i=o)}return i},_renderTextLine:function(i,n,e,o,u,s){this._renderChars(i,n,e,o,u,s)},_renderTextLinesBackground:function(i){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var n,e,o=i.fillStyle,u,s,f=this._getLeftOffset(),d=this._getTopOffset(),p=0,m=0,y,S,O=this.path,R,Y=0,q=this._textLines.length;Y<q;Y++){if(n=this.getHeightOfLine(Y),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",Y)){d+=n;continue}u=this._textLines[Y],e=this._getLineLeftOffset(Y),m=0,p=0,s=this.getValueOfPropertyAt(Y,0,"textBackgroundColor");for(var tt=0,Z=u.length;tt<Z;tt++)y=this.__charBounds[Y][tt],S=this.getValueOfPropertyAt(Y,tt,"textBackgroundColor"),O?(i.save(),i.translate(y.renderLeft,y.renderTop),i.rotate(y.angle),i.fillStyle=S,S&&i.fillRect(-y.width/2,-n/this.lineHeight*(1-this._fontSizeFraction),y.width,n/this.lineHeight),i.restore()):S!==s?(R=f+e+p,this.direction==="rtl"&&(R=this.width-R-m),i.fillStyle=s,s&&i.fillRect(R,d,m,n/this.lineHeight),p=y.left,m=y.width,s=S):m+=y.kernedWidth;S&&!O&&(R=f+e+p,this.direction==="rtl"&&(R=this.width-R-m),i.fillStyle=S,i.fillRect(R,d,m,n/this.lineHeight)),d+=n}i.fillStyle=o,this._removeShadow(i)}},getFontCache:function(i){var n=i.fontFamily.toLowerCase();r.charWidthsCache[n]||(r.charWidthsCache[n]={});var e=r.charWidthsCache[n],o=i.fontStyle.toLowerCase()+"_"+(i.fontWeight+"").toLowerCase();return e[o]||(e[o]={}),e[o]},_measureChar:function(i,n,e,o){var u=this.getFontCache(n),s=this._getFontDeclaration(n),f=this._getFontDeclaration(o),d=e+i,p=s===f,m,y,S,O=n.fontSize/this.CACHE_FONT_SIZE,R;if(e&&u[e]!==void 0&&(S=u[e]),u[i]!==void 0&&(R=m=u[i]),p&&u[d]!==void 0&&(y=u[d],R=y-S),m===void 0||S===void 0||y===void 0){var Y=this.getMeasuringContext();this._setTextStyles(Y,n,!0)}return m===void 0&&(R=m=Y.measureText(i).width,u[i]=m),S===void 0&&p&&e&&(S=Y.measureText(e).width,u[e]=S),p&&y===void 0&&(y=Y.measureText(d).width,u[d]=y,R=y-S),{width:m*O,kernedWidth:R*O}},getHeightOfChar:function(i,n){return this.getValueOfPropertyAt(i,n,"fontSize")},measureLine:function(i){var n=this._measureLine(i);return this.charSpacing!==0&&(n.width-=this._getWidthOfCharSpacing()),n.width<0&&(n.width=0),n},_measureLine:function(i){var n=0,e,o,u=this._textLines[i],s,f,d=0,p=new Array(u.length),m=0,y,S,O=this.path,R=this.pathSide==="right";for(this.__charBounds[i]=p,e=0;e<u.length;e++)o=u[e],f=this._getGraphemeBox(o,i,e,s),p[e]=f,n+=f.kernedWidth,s=o;if(p[e]={left:f?f.left+f.width:0,width:0,kernedWidth:0,height:this.fontSize},O){switch(S=O.segmentsInfo[O.segmentsInfo.length-1].length,y=r.util.getPointOnPath(O.path,0,O.segmentsInfo),y.x+=O.pathOffset.x,y.y+=O.pathOffset.y,this.textAlign){case"left":m=R?S-n:0;break;case"center":m=(S-n)/2;break;case"right":m=R?0:S-n;break}for(m+=this.pathStartOffset*(R?-1:1),e=R?u.length-1:0;R?e>=0:e<u.length;R?e--:e++)f=p[e],m>S?m%=S:m<0&&(m+=S),this._setGraphemeOnPath(m,f,y),m+=f.kernedWidth}return{width:n,numOfSpaces:d}},_setGraphemeOnPath:function(i,n,e){var o=i+n.kernedWidth/2,u=this.path,s=r.util.getPointOnPath(u.path,o,u.segmentsInfo);n.renderLeft=s.x-e.x,n.renderTop=s.y-e.y,n.angle=s.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(i,n,e,o,u){var s=this.getCompleteStyleDeclaration(n,e),f=o?this.getCompleteStyleDeclaration(n,e-1):{},d=this._measureChar(i,s,o,f),p=d.kernedWidth,m=d.width,y;this.charSpacing!==0&&(y=this._getWidthOfCharSpacing(),m+=y,p+=y);var S={width:m,left:0,height:s.fontSize,kernedWidth:p,deltaY:s.deltaY};if(e>0&&!u){var O=this.__charBounds[n][e-1];S.left=O.left+O.width+d.kernedWidth-d.width}return S},getHeightOfLine:function(i){if(this.__lineHeights[i])return this.__lineHeights[i];for(var n=this._textLines[i],e=this.getHeightOfChar(i,0),o=1,u=n.length;o<u;o++)e=Math.max(this.getHeightOfChar(i,o),e);return this.__lineHeights[i]=e*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var i,n=0,e=0,o=this._textLines.length;e<o;e++)i=this.getHeightOfLine(e),n+=e===o-1?i/this.lineHeight:i;return n},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(i,n){i.save();for(var e=0,o=this._getLeftOffset(),u=this._getTopOffset(),s=0,f=this._textLines.length;s<f;s++){var d=this.getHeightOfLine(s),p=d/this.lineHeight,m=this._getLineLeftOffset(s);this._renderTextLine(n,i,this._textLines[s],o+m,u+e+p,s),e+=d}i.restore()},_renderTextFill:function(i){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(i,"fillText")},_renderTextStroke:function(i){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(i),i.save(),this._setLineDash(i,this.strokeDashArray),i.beginPath(),this._renderTextCommon(i,"strokeText"),i.closePath(),i.restore())},_renderChars:function(i,n,e,o,u,s){var f=this.getHeightOfLine(s),d=this.textAlign.indexOf("justify")!==-1,p,m,y="",S,O=0,R,Y=this.path,q=!d&&this.charSpacing===0&&this.isEmptyStyles(s)&&!Y,tt=this.direction==="ltr",Z=this.direction==="ltr"?1:-1,it;if(n.save(),u-=f*this._fontSizeFraction/this.lineHeight,q){n.canvas.setAttribute("dir",tt?"ltr":"rtl"),n.direction=tt?"ltr":"rtl",n.textAlign=tt?"left":"right",this._renderChar(i,n,s,0,e.join(""),o,u,f),n.restore();return}for(var et=0,ot=e.length-1;et<=ot;et++)R=et===ot||this.charSpacing||Y,y+=e[et],S=this.__charBounds[s][et],O===0?(o+=Z*(S.kernedWidth-S.width),O+=S.width):O+=S.kernedWidth,d&&!R&&this._reSpaceAndTab.test(e[et])&&(R=!0),R||(p=p||this.getCompleteStyleDeclaration(s,et),m=this.getCompleteStyleDeclaration(s,et+1),R=this._hasStyleChanged(p,m)),R&&(Y?(n.save(),n.translate(S.renderLeft,S.renderTop),n.rotate(S.angle),this._renderChar(i,n,s,et,y,-O/2,0,f),n.restore()):(it=o,n.canvas.setAttribute("dir",tt?"ltr":"rtl"),n.direction=tt?"ltr":"rtl",n.textAlign=tt?"left":"right",this._renderChar(i,n,s,et,y,it,u,f)),y="",p=m,o+=Z*O,O=0);n.restore()},_applyPatternGradientTransformText:function(i){var n=r.util.createCanvasElement(),e,o=this.width+this.strokeWidth,u=this.height+this.strokeWidth;return n.width=o,n.height=u,e=n.getContext("2d"),e.beginPath(),e.moveTo(0,0),e.lineTo(o,0),e.lineTo(o,u),e.lineTo(0,u),e.closePath(),e.translate(o/2,u/2),e.fillStyle=i.toLive(e),this._applyPatternGradientTransform(e,i),e.fill(),e.createPattern(n,"no-repeat")},handleFiller:function(i,n,e){var o,u;return e.toLive?e.gradientUnits==="percentage"||e.gradientTransform||e.patternTransform?(o=-this.width/2,u=-this.height/2,i.translate(o,u),i[n]=this._applyPatternGradientTransformText(e),{offsetX:o,offsetY:u}):(i[n]=e.toLive(i,this),this._applyPatternGradientTransform(i,e)):(i[n]=e,{offsetX:0,offsetY:0})},_setStrokeStyles:function(i,n){return i.lineWidth=n.strokeWidth,i.lineCap=this.strokeLineCap,i.lineDashOffset=this.strokeDashOffset,i.lineJoin=this.strokeLineJoin,i.miterLimit=this.strokeMiterLimit,this.handleFiller(i,"strokeStyle",n.stroke)},_setFillStyles:function(i,n){return this.handleFiller(i,"fillStyle",n.fill)},_renderChar:function(i,n,e,o,u,s,f){var d=this._getStyleDeclaration(e,o),p=this.getCompleteStyleDeclaration(e,o),m=i==="fillText"&&p.fill,y=i==="strokeText"&&p.stroke&&p.strokeWidth,S,O;!y&&!m||(n.save(),m&&(S=this._setFillStyles(n,p)),y&&(O=this._setStrokeStyles(n,p)),n.font=this._getFontDeclaration(p),d&&d.textBackgroundColor&&this._removeShadow(n),d&&d.deltaY&&(f+=d.deltaY),m&&n.fillText(u,s-S.offsetX,f-S.offsetY),y&&n.strokeText(u,s-O.offsetX,f-O.offsetY),n.restore())},setSuperscript:function(i,n){return this._setScript(i,n,this.superscript)},setSubscript:function(i,n){return this._setScript(i,n,this.subscript)},_setScript:function(i,n,e){var o=this.get2DCursorLocation(i,!0),u=this.getValueOfPropertyAt(o.lineIndex,o.charIndex,"fontSize"),s=this.getValueOfPropertyAt(o.lineIndex,o.charIndex,"deltaY"),f={fontSize:u*e.size,deltaY:s+u*e.baseline};return this.setSelectionStyles(f,i,n),this},_hasStyleChanged:function(i,n){return i.fill!==n.fill||i.stroke!==n.stroke||i.strokeWidth!==n.strokeWidth||i.fontSize!==n.fontSize||i.fontFamily!==n.fontFamily||i.fontWeight!==n.fontWeight||i.fontStyle!==n.fontStyle||i.deltaY!==n.deltaY},_hasStyleChangedForSvg:function(i,n){return this._hasStyleChanged(i,n)||i.overline!==n.overline||i.underline!==n.underline||i.linethrough!==n.linethrough},_getLineLeftOffset:function(i){var n=this.getLineWidth(i),e=this.width-n,o=this.textAlign,u=this.direction,s,f=0,s=this.isEndOfWrapping(i);return o==="justify"||o==="justify-center"&&!s||o==="justify-right"&&!s||o==="justify-left"&&!s?0:(o==="center"&&(f=e/2),o==="right"&&(f=e),o==="justify-center"&&(f=e/2),o==="justify-right"&&(f=e),u==="rtl"&&(f-=e),f)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var i=this._forceClearCache;return i||(i=this.hasStateChanged("_dimensionAffectingProps")),i&&(this.dirty=!0,this._forceClearCache=!1),i},getLineWidth:function(i){if(this.__lineWidths[i])return this.__lineWidths[i];var n,e=this._textLines[i],o;return e===""?n=0:(o=this.measureLine(i),n=o.width),this.__lineWidths[i]=n,n},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(i,n,e){var o=this._getStyleDeclaration(i,n);return o&&typeof o[e]!="undefined"?o[e]:this[e]},_renderTextDecoration:function(i,n){if(!(!this[n]&&!this.styleHas(n))){for(var e,o,u,s,f,d,p,m,y=this._getLeftOffset(),S=this._getTopOffset(),O,R,Y,q,tt,Z,it,et,ot=this.path,at=this._getWidthOfCharSpacing(),st=this.offsets[n],nt=0,D=this._textLines.length;nt<D;nt++){if(e=this.getHeightOfLine(nt),!this[n]&&!this.styleHas(n,nt)){S+=e;continue}p=this._textLines[nt],Z=e/this.lineHeight,s=this._getLineLeftOffset(nt),R=0,Y=0,m=this.getValueOfPropertyAt(nt,0,n),et=this.getValueOfPropertyAt(nt,0,"fill"),O=S+Z*(1-this._fontSizeFraction),o=this.getHeightOfChar(nt,0),f=this.getValueOfPropertyAt(nt,0,"deltaY");for(var G=0,F=p.length;G<F;G++)if(q=this.__charBounds[nt][G],tt=this.getValueOfPropertyAt(nt,G,n),it=this.getValueOfPropertyAt(nt,G,"fill"),u=this.getHeightOfChar(nt,G),d=this.getValueOfPropertyAt(nt,G,"deltaY"),ot&&tt&&it)i.save(),i.fillStyle=et,i.translate(q.renderLeft,q.renderTop),i.rotate(q.angle),i.fillRect(-q.kernedWidth/2,st*u+d,q.kernedWidth,this.fontSize/15),i.restore();else if((tt!==m||it!==et||u!==o||d!==f)&&Y>0){var j=y+s+R;this.direction==="rtl"&&(j=this.width-j-Y),m&&et&&(i.fillStyle=et,i.fillRect(j,O+st*o+f,Y,this.fontSize/15)),R=q.left,Y=q.width,m=tt,et=it,o=u,f=d}else Y+=q.kernedWidth;var j=y+s+R;this.direction==="rtl"&&(j=this.width-j-Y),i.fillStyle=it,tt&&it&&i.fillRect(j,O+st*o+f,Y-at,this.fontSize/15),S+=e}this._removeShadow(i)}},_getFontDeclaration:function(i,n){var e=i||this,o=this.fontFamily,u=r.Text.genericFonts.indexOf(o.toLowerCase())>-1,s=o===void 0||o.indexOf("'")>-1||o.indexOf(",")>-1||o.indexOf('"')>-1||u?e.fontFamily:'"'+e.fontFamily+'"';return[r.isLikelyNode?e.fontWeight:e.fontStyle,r.isLikelyNode?e.fontStyle:e.fontWeight,n?this.CACHE_FONT_SIZE+"px":e.fontSize+"px",s].join(" ")},render:function(i){!this.visible||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",i))},_splitTextIntoLines:function(i){for(var n=i.split(this._reNewline),e=new Array(n.length),o=[`
`],u=[],s=0;s<n.length;s++)e[s]=r.util.string.graphemeSplit(n[s]),u=u.concat(e[s],o);return u.pop(),{_unwrappedLines:e,lines:n,graphemeText:u,graphemeLines:e}},toObject:function(i){var n=c.concat(i),e=this.callSuper("toObject",n);return e.styles=l(this.styles,!0),e.path&&(e.path=this.path.toObject()),e},set:function(i,n){this.callSuper("set",i,n);var e=!1,o=!1;if(typeof i=="object")for(var u in i)u==="path"&&this.setPathInfo(),e=e||this._dimensionAffectingProps.indexOf(u)!==-1,o=o||u==="path";else e=this._dimensionAffectingProps.indexOf(i)!==-1,o=i==="path";return o&&this.setPathInfo(),e&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),r.Text.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),r.Text.DEFAULT_SVG_FONT_SIZE=16,r.Text.fromElement=function(i,n,e){if(!i)return n(null);var o=r.parseAttributes(i,r.Text.ATTRIBUTE_NAMES),u=o.textAnchor||"left";if(e=r.util.object.extend(e?l(e):{},o),e.top=e.top||0,e.left=e.left||0,o.textDecoration){var s=o.textDecoration;s.indexOf("underline")!==-1&&(e.underline=!0),s.indexOf("overline")!==-1&&(e.overline=!0),s.indexOf("line-through")!==-1&&(e.linethrough=!0),delete e.textDecoration}"dx"in o&&(e.left+=o.dx),"dy"in o&&(e.top+=o.dy),"fontSize"in e||(e.fontSize=r.Text.DEFAULT_SVG_FONT_SIZE);var f="";"textContent"in i?f=i.textContent:"firstChild"in i&&i.firstChild!==null&&"data"in i.firstChild&&i.firstChild.data!==null&&(f=i.firstChild.data),f=f.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var d=e.strokeWidth;e.strokeWidth=0;var p=new r.Text(f,e),m=p.getScaledHeight()/p.height,y=(p.height+p.strokeWidth)*p.lineHeight-p.height,S=y*m,O=p.getScaledHeight()+S,R=0;u==="center"&&(R=p.getScaledWidth()/2),u==="right"&&(R=p.getScaledWidth()),p.set({left:p.left-R,top:p.top-(O-p.fontSize*(.07+p._fontSizeFraction))/p.lineHeight,strokeWidth:typeof d!="undefined"?d:1}),n(p)},r.Text.fromObject=function(i,n){var e=l(i),o=i.path;return delete e.path,r.Object._fromObject("Text",e,function(u){o?r.Object._fromObject("Path",o,function(s){u.set("path",s),n(u)},"path"):n(u)},"text")},r.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],r.util.createAccessors&&r.util.createAccessors(r.Text)}(a),function(){t.util.object.extend(t.Text.prototype,{isEmptyStyles:function(h){if(!this.styles||typeof h!="undefined"&&!this.styles[h])return!0;var r=typeof h=="undefined"?this.styles:{line:this.styles[h]};for(var l in r)for(var c in r[l])for(var i in r[l][c])return!1;return!0},styleHas:function(h,r){if(!this.styles||!h||h===""||typeof r!="undefined"&&!this.styles[r])return!1;var l=typeof r=="undefined"?this.styles:{0:this.styles[r]};for(var c in l)for(var i in l[c])if(typeof l[c][i][h]!="undefined")return!0;return!1},cleanStyle:function(h){if(!this.styles||!h||h==="")return!1;var r=this.styles,l=0,c,i,n=!0,e=0,o;for(var u in r){c=0;for(var s in r[u]){var o=r[u][s],f=o.hasOwnProperty(h);l++,f?(i?o[h]!==i&&(n=!1):i=o[h],o[h]===this[h]&&delete o[h]):n=!1,Object.keys(o).length!==0?c++:delete r[u][s]}c===0&&delete r[u]}for(var d=0;d<this._textLines.length;d++)e+=this._textLines[d].length;n&&l===e&&(this[h]=i,this.removeStyle(h))},removeStyle:function(h){if(!(!this.styles||!h||h==="")){var r=this.styles,l,c,i;for(c in r){l=r[c];for(i in l)delete l[i][h],Object.keys(l[i]).length===0&&delete l[i];Object.keys(l).length===0&&delete r[c]}}},_extendStyles:function(h,r){var l=this.get2DCursorLocation(h);this._getLineStyle(l.lineIndex)||this._setLineStyle(l.lineIndex),this._getStyleDeclaration(l.lineIndex,l.charIndex)||this._setStyleDeclaration(l.lineIndex,l.charIndex,{}),t.util.object.extend(this._getStyleDeclaration(l.lineIndex,l.charIndex),r)},get2DCursorLocation:function(h,r){typeof h=="undefined"&&(h=this.selectionStart);for(var l=r?this._unwrappedTextLines:this._textLines,c=l.length,i=0;i<c;i++){if(h<=l[i].length)return{lineIndex:i,charIndex:h};h-=l[i].length+this.missingNewlineOffset(i)}return{lineIndex:i-1,charIndex:l[i-1].length<h?l[i-1].length:h}},getSelectionStyles:function(h,r,l){typeof h=="undefined"&&(h=this.selectionStart||0),typeof r=="undefined"&&(r=this.selectionEnd||h);for(var c=[],i=h;i<r;i++)c.push(this.getStyleAtPosition(i,l));return c},getStyleAtPosition:function(h,r){var l=this.get2DCursorLocation(h),c=r?this.getCompleteStyleDeclaration(l.lineIndex,l.charIndex):this._getStyleDeclaration(l.lineIndex,l.charIndex);return c||{}},setSelectionStyles:function(h,r,l){typeof r=="undefined"&&(r=this.selectionStart||0),typeof l=="undefined"&&(l=this.selectionEnd||r);for(var c=r;c<l;c++)this._extendStyles(c,h);return this._forceClearCache=!0,this},_getStyleDeclaration:function(h,r){var l=this.styles&&this.styles[h];return l?l[r]:null},getCompleteStyleDeclaration:function(h,r){for(var l=this._getStyleDeclaration(h,r)||{},c={},i,n=0;n<this._styleProperties.length;n++)i=this._styleProperties[n],c[i]=typeof l[i]=="undefined"?this[i]:l[i];return c},_setStyleDeclaration:function(h,r,l){this.styles[h][r]=l},_deleteStyleDeclaration:function(h,r){delete this.styles[h][r]},_getLineStyle:function(h){return!!this.styles[h]},_setLineStyle:function(h){this.styles[h]={}},_deleteLineStyle:function(h){delete this.styles[h]}})}(),function(){function h(r){r.textDecoration&&(r.textDecoration.indexOf("underline")>-1&&(r.underline=!0),r.textDecoration.indexOf("line-through")>-1&&(r.linethrough=!0),r.textDecoration.indexOf("overline")>-1&&(r.overline=!0),delete r.textDecoration)}t.IText=t.util.createClass(t.Text,t.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(r,l){this.callSuper("initialize",r,l),this.initBehavior()},setSelectionStart:function(r){r=Math.max(r,0),this._updateAndFire("selectionStart",r)},setSelectionEnd:function(r){r=Math.min(r,this.text.length),this._updateAndFire("selectionEnd",r)},_updateAndFire:function(r,l){this[r]!==l&&(this._fireSelectionChanged(),this[r]=l),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(r){this.clearContextTop(),this.callSuper("render",r),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(r){this.callSuper("_render",r)},clearContextTop:function(r){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var l=this.canvas.contextTop,c=this.canvas.viewportTransform;l.save(),l.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this.transform(l),this._clearTextArea(l),r||l.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var r=this._getCursorBoundaries(),l=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(r,l):this.renderSelection(r,l),l.restore()}},_clearTextArea:function(r){var l=this.width+4,c=this.height+4;r.clearRect(-l/2,-c/2,l,c)},_getCursorBoundaries:function(r){typeof r=="undefined"&&(r=this.selectionStart);var l=this._getLeftOffset(),c=this._getTopOffset(),i=this._getCursorBoundariesOffsets(r);return{left:l,top:c,leftOffset:i.left,topOffset:i.top}},_getCursorBoundariesOffsets:function(r){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var l,c,i,n=0,e=0,o,u=this.get2DCursorLocation(r);i=u.charIndex,c=u.lineIndex;for(var s=0;s<c;s++)n+=this.getHeightOfLine(s);l=this._getLineLeftOffset(c);var f=this.__charBounds[c][i];return f&&(e=f.left),this.charSpacing!==0&&i===this._textLines[c].length&&(e-=this._getWidthOfCharSpacing()),o={top:n,left:l+(e>0?e:0)},this.direction==="rtl"&&(o.left*=-1),this.cursorOffsetCache=o,this.cursorOffsetCache},renderCursor:function(r,l){var c=this.get2DCursorLocation(),i=c.lineIndex,n=c.charIndex>0?c.charIndex-1:0,e=this.getValueOfPropertyAt(i,n,"fontSize"),o=this.scaleX*this.canvas.getZoom(),u=this.cursorWidth/o,s=r.topOffset,f=this.getValueOfPropertyAt(i,n,"deltaY");s+=(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-e*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(r,l),l.fillStyle=this.cursorColor||this.getValueOfPropertyAt(i,n,"fill"),l.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,l.fillRect(r.left+r.leftOffset-u/2,s+r.top+f,u,e)},renderSelection:function(r,l){for(var c=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,i=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,n=this.textAlign.indexOf("justify")!==-1,e=this.get2DCursorLocation(c),o=this.get2DCursorLocation(i),u=e.lineIndex,s=o.lineIndex,f=e.charIndex<0?0:e.charIndex,d=o.charIndex<0?0:o.charIndex,p=u;p<=s;p++){var m=this._getLineLeftOffset(p)||0,y=this.getHeightOfLine(p),S=0,O=0,R=0;if(p===u&&(O=this.__charBounds[u][f].left),p>=u&&p<s)R=n&&!this.isEndOfWrapping(p)?this.width:this.getLineWidth(p)||5;else if(p===s)if(d===0)R=this.__charBounds[s][d].left;else{var Y=this._getWidthOfCharSpacing();R=this.__charBounds[s][d-1].left+this.__charBounds[s][d-1].width-Y}S=y,(this.lineHeight<1||p===s&&this.lineHeight>1)&&(y/=this.lineHeight);var q=r.left+m+O,tt=R-O,Z=y,it=0;this.inCompositionMode?(l.fillStyle=this.compositionColor||"black",Z=1,it=y):l.fillStyle=this.selectionColor,this.direction==="rtl"&&(q=this.width-q-tt),l.fillRect(q,r.top+r.topOffset+it,tt,Z),r.topOffset+=S}},getCurrentCharFontSize:function(){var r=this._getCurrentCharIndex();return this.getValueOfPropertyAt(r.l,r.c,"fontSize")},getCurrentCharColor:function(){var r=this._getCurrentCharIndex();return this.getValueOfPropertyAt(r.l,r.c,"fill")},_getCurrentCharIndex:function(){var r=this.get2DCursorLocation(this.selectionStart,!0),l=r.charIndex>0?r.charIndex-1:0;return{l:r.lineIndex,c:l}}}),t.IText.fromObject=function(r,l){if(h(r),r.styles)for(var c in r.styles)for(var i in r.styles[c])h(r.styles[c][i]);t.Object._fromObject("IText",r,l,"text")}}(),function(){var h=t.util.object.clone;t.util.object.extend(t.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var r=this;this.on("added",function(){var l=r.canvas;l&&(l._hasITextHandlers||(l._hasITextHandlers=!0,r._initCanvasHandlers(l)),l._iTextInstances=l._iTextInstances||[],l._iTextInstances.push(r))})},initRemovedHandler:function(){var r=this;this.on("removed",function(){var l=r.canvas;l&&(l._iTextInstances=l._iTextInstances||[],t.util.removeFromArray(l._iTextInstances,r),l._iTextInstances.length===0&&(l._hasITextHandlers=!1,r._removeCanvasHandlers(l)))})},_initCanvasHandlers:function(r){r._mouseUpITextHandler=function(){r._iTextInstances&&r._iTextInstances.forEach(function(l){l.__isMousedown=!1})},r.on("mouse:up",r._mouseUpITextHandler)},_removeCanvasHandlers:function(r){r.off("mouse:up",r._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(r,l,c,i){var n;return n={isAborted:!1,abort:function(){this.isAborted=!0}},r.animate("_currentCursorOpacity",l,{duration:c,onComplete:function(){n.isAborted||r[i]()},onChange:function(){r.canvas&&r.selectionStart===r.selectionEnd&&r.renderCursorOrSelection()},abort:function(){return n.isAborted}}),n},_onTickComplete:function(){var r=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){r._currentTickCompleteState=r._animateCursor(r,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(r){var l=this,c=r?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){l._tick()},c)},abortCursorAnimation:function(){var r=this._currentTickState||this._currentTickCompleteState,l=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,r&&l&&l.clearContext(l.contextTop||l.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(r){var l=0,c=r-1;if(this._reSpace.test(this._text[c]))for(;this._reSpace.test(this._text[c]);)l++,c--;for(;/\S/.test(this._text[c])&&c>-1;)l++,c--;return r-l},findWordBoundaryRight:function(r){var l=0,c=r;if(this._reSpace.test(this._text[c]))for(;this._reSpace.test(this._text[c]);)l++,c++;for(;/\S/.test(this._text[c])&&c<this._text.length;)l++,c++;return r+l},findLineBoundaryLeft:function(r){for(var l=0,c=r-1;!/\n/.test(this._text[c])&&c>-1;)l++,c--;return r-l},findLineBoundaryRight:function(r){for(var l=0,c=r;!/\n/.test(this._text[c])&&c<this._text.length;)l++,c++;return r+l},searchWordBoundary:function(r,l){for(var c=this._text,i=this._reSpace.test(c[r])?r-1:r,n=c[i],e=t.reNonWord;!e.test(n)&&i>0&&i<c.length;)i+=l,n=c[i];return e.test(n)&&(i+=l===1?0:1),i},selectWord:function(r){r=r||this.selectionStart;var l=this.searchWordBoundary(r,-1),c=this.searchWordBoundary(r,1);this.selectionStart=l,this.selectionEnd=c,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(r){r=r||this.selectionStart;var l=this.findLineBoundaryLeft(r),c=this.findLineBoundaryRight(r);return this.selectionStart=l,this.selectionEnd=c,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(r){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(r),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(r){r._iTextInstances&&r._iTextInstances.forEach(function(l){l.selected=!1,l.isEditing&&l.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(r){if(!(!this.__isMousedown||!this.isEditing)){var l=this.getSelectionStartFromPointer(r.e),c=this.selectionStart,i=this.selectionEnd;(l!==this.__selectionStartOnMouseDown||c===i)&&(c===l||i===l)||(l>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=l):(this.selectionStart=l,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==c||this.selectionEnd!==i)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(r,l,c){var i=c.slice(0,r),n=t.util.string.graphemeSplit(i).length;if(r===l)return{selectionStart:n,selectionEnd:n};var e=c.slice(r,l),o=t.util.string.graphemeSplit(e).length;return{selectionStart:n,selectionEnd:n+o}},fromGraphemeToStringSelection:function(r,l,c){var i=c.slice(0,r),n=i.join("").length;if(r===l)return{selectionStart:n,selectionEnd:n};var e=c.slice(r,l),o=e.join("").length;return{selectionStart:n,selectionEnd:n+o}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var r=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=r.selectionStart,this.hiddenTextarea.selectionEnd=r.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(!!this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var r=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=r.selectionEnd,this.inCompositionMode||(this.selectionStart=r.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var r=this._calcTextareaPosition();this.hiddenTextarea.style.left=r.left,this.hiddenTextarea.style.top=r.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var r=this.inCompositionMode?this.compositionStart:this.selectionStart,l=this._getCursorBoundaries(r),c=this.get2DCursorLocation(r),i=c.lineIndex,n=c.charIndex,e=this.getValueOfPropertyAt(i,n,"fontSize")*this.lineHeight,o=l.leftOffset,u=this.calcTransformMatrix(),s={x:l.left+o,y:l.top+l.topOffset+e},f=this.canvas.getRetinaScaling(),d=this.canvas.upperCanvasEl,p=d.width/f,m=d.height/f,y=p-e,S=m-e,O=d.clientWidth/p,R=d.clientHeight/m;return s=t.util.transformPoint(s,u),s=t.util.transformPoint(s,this.canvas.viewportTransform),s.x*=O,s.y*=R,s.x<0&&(s.x=0),s.x>y&&(s.x=y),s.y<0&&(s.y=0),s.y>S&&(s.y=S),s.x+=this.canvas._offset.left,s.y+=this.canvas._offset.top,{left:s.x+"px",top:s.y+"px",fontSize:e+"px",charHeight:e}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){!this._savedProps||(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var r=this._textBeforeEdit!==this.text,l=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,l&&(l.blur&&l.blur(),l.parentNode&&l.parentNode.removeChild(l)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),r&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),r&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var r in this.styles)this._textLines[r]||delete this.styles[r]},removeStyleFromTo:function(r,l){var c=this.get2DCursorLocation(r,!0),i=this.get2DCursorLocation(l,!0),n=c.lineIndex,e=c.charIndex,o=i.lineIndex,u=i.charIndex,s,f;if(n!==o){if(this.styles[n])for(s=e;s<this._unwrappedTextLines[n].length;s++)delete this.styles[n][s];if(this.styles[o])for(s=u;s<this._unwrappedTextLines[o].length;s++)f=this.styles[o][s],f&&(this.styles[n]||(this.styles[n]={}),this.styles[n][e+s-u]=f);for(s=n+1;s<=o;s++)delete this.styles[s];this.shiftLineStyles(o,n-o)}else if(this.styles[n]){f=this.styles[n];var d=u-e,p,m;for(s=e;s<u;s++)delete f[s];for(m in this.styles[n])p=parseInt(m,10),p>=u&&(f[p-d]=f[m],delete f[m])}},shiftLineStyles:function(r,l){var c=h(this.styles);for(var i in this.styles){var n=parseInt(i,10);n>r&&(this.styles[n+l]=c[n],c[n-l]||delete this.styles[n])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(r,l,c,i){var n,e={},o=!1,u=this._unwrappedTextLines[r].length===l;c||(c=1),this.shiftLineStyles(r,c),this.styles[r]&&(n=this.styles[r][l===0?l:l-1]);for(var s in this.styles[r]){var f=parseInt(s,10);f>=l&&(o=!0,e[f-l]=this.styles[r][s],u&&l===0||delete this.styles[r][s])}var d=!1;for(o&&!u&&(this.styles[r+c]=e,d=!0),d&&c--;c>0;)i&&i[c-1]?this.styles[r+c]={0:h(i[c-1])}:n?this.styles[r+c]={0:h(n)}:delete this.styles[r+c],c--;this._forceClearCache=!0},insertCharStyleObject:function(r,l,c,i){this.styles||(this.styles={});var n=this.styles[r],e=n?h(n):{};c||(c=1);for(var o in e){var u=parseInt(o,10);u>=l&&(n[u+c]=e[u],e[u-c]||delete n[u])}if(this._forceClearCache=!0,i){for(;c--;)!Object.keys(i[c]).length||(this.styles[r]||(this.styles[r]={}),this.styles[r][l+c]=h(i[c]));return}if(!!n)for(var s=n[l?l-1:1];s&&c--;)this.styles[r][l+c]=h(s)},insertNewStyleBlock:function(r,l,c){for(var i=this.get2DCursorLocation(l,!0),n=[0],e=0,o=0;o<r.length;o++)r[o]===`
`?(e++,n[e]=0):n[e]++;n[0]>0&&(this.insertCharStyleObject(i.lineIndex,i.charIndex,n[0],c),c=c&&c.slice(n[0]+1)),e&&this.insertNewlineStyleObject(i.lineIndex,i.charIndex+n[0],e);for(var o=1;o<e;o++)n[o]>0?this.insertCharStyleObject(i.lineIndex+o,0,n[o],c):c&&(this.styles[i.lineIndex+o][0]=c[0]),c=c&&c.slice(n[o]+1);n[o]>0&&this.insertCharStyleObject(i.lineIndex+o,0,n[o],c)},setSelectionStartEndWithShift:function(r,l,c){c<=r?(l===r?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=r),this.selectionStart=c):c>r&&c<l?this._selectionDirection==="right"?this.selectionEnd=c:this.selectionStart=c:(l===r?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=l),this.selectionEnd=c)},setSelectionInBoundaries:function(){var r=this.text.length;this.selectionStart>r?this.selectionStart=r:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>r?this.selectionEnd=r:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),t.util.object.extend(t.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(h){if(!!this.canvas){this.__newClickTime=+new Date;var r=h.pointer;this.isTripleClick(r)&&(this.fire("tripleclick",h),this._stopEvent(h.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=r,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(h){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===h.x&&this.__lastPointer.y===h.y},_stopEvent:function(h){h.preventDefault&&h.preventDefault(),h.stopPropagation&&h.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(h){!this.isEditing||this.selectWord(this.getSelectionStartFromPointer(h.e))},tripleClickHandler:function(h){!this.isEditing||this.selectLine(this.getSelectionStartFromPointer(h.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(h){!this.canvas||!this.editable||h.e.button&&h.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(h.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(h){!this.canvas||!this.editable||h.e.button&&h.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(h){if(this.__isMousedown=!1,!(!this.editable||this.group||h.transform&&h.transform.actionPerformed||h.e.button&&h.e.button!==1)){if(this.canvas){var r=this.canvas._activeObject;if(r&&r!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(h.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(h){var r=this.getSelectionStartFromPointer(h),l=this.selectionStart,c=this.selectionEnd;h.shiftKey?this.setSelectionStartEndWithShift(l,c,r):(this.selectionStart=r,this.selectionEnd=r),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(h){for(var r=this.getLocalPointer(h),l=0,c=0,i=0,n=0,e=0,o,u,s=0,f=this._textLines.length;s<f&&i<=r.y;s++)i+=this.getHeightOfLine(s)*this.scaleY,e=s,s>0&&(n+=this._textLines[s-1].length+this.missingNewlineOffset(s-1));o=this._getLineLeftOffset(e),c=o*this.scaleX,u=this._textLines[e],this.direction==="rtl"&&(r.x=this.width*this.scaleX-r.x+c);for(var d=0,p=u.length;d<p&&(l=c,c+=this.__charBounds[e][d].kernedWidth*this.scaleX,c<=r.x);d++)n++;return this._getNewSelectionStartFromOffset(r,l,c,n,p)},_getNewSelectionStartFromOffset:function(h,r,l,c,i){var n=h.x-r,e=l-h.x,o=e>n||e<0?0:1,u=c+o;return this.flipX&&(u=i-u),u>this._text.length&&(u=this._text.length),u}}),t.util.object.extend(t.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=t.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var h=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+h.top+"; left: "+h.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding\uFF70top: "+h.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):t.document.body.appendChild(this.hiddenTextarea),t.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),t.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),t.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),t.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),t.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),t.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(t.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(h){if(!!this.isEditing){var r=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(h.keyCode in r)this[r[h.keyCode]](h);else if(h.keyCode in this.ctrlKeysMapDown&&(h.ctrlKey||h.metaKey))this[this.ctrlKeysMapDown[h.keyCode]](h);else return;h.stopImmediatePropagation(),h.preventDefault(),h.keyCode>=33&&h.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(h){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(h.keyCode in this.ctrlKeysMapUp&&(h.ctrlKey||h.metaKey))this[this.ctrlKeysMapUp[h.keyCode]](h);else return;h.stopImmediatePropagation(),h.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(h){var r=this.fromPaste;if(this.fromPaste=!1,h&&h.stopPropagation(),!!this.isEditing){var l=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,c=this._text.length,i=l.length,n,e,o=i-c,u=this.selectionStart,s=this.selectionEnd,f=u!==s,d,p,m;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var y=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),S=u>y.selectionStart;f?(n=this._text.slice(u,s),o+=s-u):i<c&&(S?n=this._text.slice(s+o,s):n=this._text.slice(u,u-o)),e=l.slice(y.selectionEnd-o,y.selectionEnd),n&&n.length&&(e.length&&(d=this.getSelectionStyles(u,u+1,!1),d=e.map(function(){return d[0]})),f?(p=u,m=s):S?(p=s-n.length,m=s):(p=s,m=s+n.length),this.removeStyleFromTo(p,m)),e.length&&(r&&e.join("")===t.copiedText&&!t.disableStyleCopyPaste&&(d=t.copiedTextStyle),this.insertNewStyleBlock(e,u,d)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(h){this.compositionStart=h.target.selectionStart,this.compositionEnd=h.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(t.copiedText=this.getSelectedText(),t.disableStyleCopyPaste?t.copiedTextStyle=null:t.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(h){return h&&h.clipboardData||t.window.clipboardData},_getWidthBeforeCursor:function(h,r){var l=this._getLineLeftOffset(h),c;return r>0&&(c=this.__charBounds[h][r-1],l+=c.left+c.width),l},getDownCursorOffset:function(h,r){var l=this._getSelectionForOffset(h,r),c=this.get2DCursorLocation(l),i=c.lineIndex;if(i===this._textLines.length-1||h.metaKey||h.keyCode===34)return this._text.length-l;var n=c.charIndex,e=this._getWidthBeforeCursor(i,n),o=this._getIndexOnLine(i+1,e),u=this._textLines[i].slice(n);return u.length+o+1+this.missingNewlineOffset(i)},_getSelectionForOffset:function(h,r){return h.shiftKey&&this.selectionStart!==this.selectionEnd&&r?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(h,r){var l=this._getSelectionForOffset(h,r),c=this.get2DCursorLocation(l),i=c.lineIndex;if(i===0||h.metaKey||h.keyCode===33)return-l;var n=c.charIndex,e=this._getWidthBeforeCursor(i,n),o=this._getIndexOnLine(i-1,e),u=this._textLines[i].slice(0,n),s=this.missingNewlineOffset(i-1);return-this._textLines[i-1].length+o-u.length+(1-s)},_getIndexOnLine:function(h,r){for(var l=this._textLines[h],c=this._getLineLeftOffset(h),i=c,n=0,e,o,u=0,s=l.length;u<s;u++)if(e=this.__charBounds[h][u].width,i+=e,i>r){o=!0;var f=i-e,d=i,p=Math.abs(f-r),m=Math.abs(d-r);n=m<p?u:u-1;break}return o||(n=l.length-1),n},moveCursorDown:function(h){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",h)},moveCursorUp:function(h){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",h)},_moveCursorUpOrDown:function(h,r){var l="get"+h+"CursorOffset",c=this[l](r,this._selectionDirection==="right");r.shiftKey?this.moveCursorWithShift(c):this.moveCursorWithoutShift(c),c!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(h){var r=this._selectionDirection==="left"?this.selectionStart+h:this.selectionEnd+h;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,r),h!==0},moveCursorWithoutShift:function(h){return h<0?(this.selectionStart+=h,this.selectionEnd=this.selectionStart):(this.selectionEnd+=h,this.selectionStart=this.selectionEnd),h!==0},moveCursorLeft:function(h){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",h)},_move:function(h,r,l){var c;if(h.altKey)c=this["findWordBoundary"+l](this[r]);else if(h.metaKey||h.keyCode===35||h.keyCode===36)c=this["findLineBoundary"+l](this[r]);else return this[r]+=l==="Left"?-1:1,!0;if(typeof c!==void 0&&this[r]!==c)return this[r]=c,!0},_moveLeft:function(h,r){return this._move(h,r,"Left")},_moveRight:function(h,r){return this._move(h,r,"Right")},moveCursorLeftWithoutShift:function(h){var r=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(r=this._moveLeft(h,"selectionStart")),this.selectionEnd=this.selectionStart,r},moveCursorLeftWithShift:function(h){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(h,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(h,"selectionStart")},moveCursorRight:function(h){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",h)},_moveCursorLeftOrRight:function(h,r){var l="moveCursor"+h+"With";this._currentCursorOpacity=1,r.shiftKey?l+="Shift":l+="outShift",this[l](r)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(h){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(h,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(h,"selectionEnd")},moveCursorRightWithoutShift:function(h){var r=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(r=this._moveRight(h,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,r},removeChars:function(h,r){typeof r=="undefined"&&(r=h+1),this.removeStyleFromTo(h,r),this._text.splice(h,r-h),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(h,r,l,c){typeof c=="undefined"&&(c=l),c>l&&this.removeStyleFromTo(l,c);var i=t.util.string.graphemeSplit(h);this.insertNewStyleBlock(i,l,r),this._text=[].concat(this._text.slice(0,l),i,this._text.slice(c)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var h=t.util.toFixed,r=/  +/g;t.util.object.extend(t.Text.prototype,{_toSVG:function(){var l=this._getSVGLeftTopOffsets(),c=this._getSVGTextAndBg(l.textTop,l.textLeft);return this._wrapSVGTextAndBg(c)},toSVG:function(l){return this._createBaseSVGMarkup(this._toSVG(),{reviver:l,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(l){var c=!0,i=this.getSvgTextDecoration(this);return[l.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",i?'text-decoration="'+i+'" ':"",'style="',this.getSvgStyles(c),'"',this.addPaintOrder()," >",l.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(l,c){var i=[],n=[],e=l,o;this._setSVGBg(n);for(var u=0,s=this._textLines.length;u<s;u++)o=this._getLineLeftOffset(u),(this.textBackgroundColor||this.styleHas("textBackgroundColor",u))&&this._setSVGTextLineBg(n,u,c+o,e),this._setSVGTextLineText(i,u,c+o,e),e+=this.getHeightOfLine(u);return{textSpans:i,textBgRects:n}},_createTextCharSpan:function(l,c,i,n){var e=l!==l.trim()||l.match(r),o=this.getSvgSpanStyles(c,e),u=o?'style="'+o+'"':"",s=c.deltaY,f="",d=t.Object.NUM_FRACTION_DIGITS;return s&&(f=' dy="'+h(s,d)+'" '),['<tspan x="',h(i,d),'" y="',h(n,d),'" ',f,u,">",t.util.string.escapeXml(l),"</tspan>"].join("")},_setSVGTextLineText:function(l,c,i,n){var e=this.getHeightOfLine(c),o=this.textAlign.indexOf("justify")!==-1,u,s,f="",d,p,m=0,y=this._textLines[c],S;n+=e*(1-this._fontSizeFraction)/this.lineHeight;for(var O=0,R=y.length-1;O<=R;O++)S=O===R||this.charSpacing,f+=y[O],d=this.__charBounds[c][O],m===0?(i+=d.kernedWidth-d.width,m+=d.width):m+=d.kernedWidth,o&&!S&&this._reSpaceAndTab.test(y[O])&&(S=!0),S||(u=u||this.getCompleteStyleDeclaration(c,O),s=this.getCompleteStyleDeclaration(c,O+1),S=this._hasStyleChangedForSvg(u,s)),S&&(p=this._getStyleDeclaration(c,O)||{},l.push(this._createTextCharSpan(f,p,i,n)),f="",u=s,i+=m,m=0)},_pushTextBgRect:function(l,c,i,n,e,o){var u=t.Object.NUM_FRACTION_DIGITS;l.push("		<rect ",this._getFillAttributes(c),' x="',h(i,u),'" y="',h(n,u),'" width="',h(e,u),'" height="',h(o,u),`"></rect>
`)},_setSVGTextLineBg:function(l,c,i,n){for(var e=this._textLines[c],o=this.getHeightOfLine(c)/this.lineHeight,u=0,s=0,f,d,p=this.getValueOfPropertyAt(c,0,"textBackgroundColor"),m=0,y=e.length;m<y;m++)f=this.__charBounds[c][m],d=this.getValueOfPropertyAt(c,m,"textBackgroundColor"),d!==p?(p&&this._pushTextBgRect(l,p,i+s,n,u,o),s=f.left,u=f.width,p=d):u+=f.kernedWidth;d&&this._pushTextBgRect(l,d,i+s,n,u,o)},_getFillAttributes:function(l){var c=l&&typeof l=="string"?new t.Color(l):"";return!c||!c.getSource()||c.getAlpha()===1?'fill="'+l+'"':'opacity="'+c.getAlpha()+'" fill="'+c.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(l){for(var c=0,i=0,n=0;n<l;n++)c+=this.getHeightOfLine(n);return i=this.getHeightOfLine(n),{lineTop:c,offset:(this._fontSizeMult-this._fontSizeFraction)*i/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(l){var c=t.Object.prototype.getSvgStyles.call(this,l);return c+" white-space: pre;"}})}(),function(h){var r=h.fabric||(h.fabric={});r.Textbox=r.util.createClass(r.IText,r.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:r.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(l){for(var c=0,i=0,n=0,e={},o=0;o<l.graphemeLines.length;o++)l.graphemeText[n]===`
`&&o>0?(i=0,n++,c++):!this.splitByGrapheme&&this._reSpaceAndTab.test(l.graphemeText[n])&&o>0&&(i++,n++),e[o]={line:c,offset:i},n+=l.graphemeLines[o].length,i+=l.graphemeLines[o].length;return e},styleHas:function(l,c){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[c];i&&(c=i.line)}return r.Text.prototype.styleHas.call(this,l,c)},isEmptyStyles:function(l){if(!this.styles)return!0;var c=0,i=l+1,n,e,o=!1,u=this._styleMap[l],s=this._styleMap[l+1];u&&(l=u.line,c=u.offset),s&&(i=s.line,o=i===l,n=s.offset),e=typeof l=="undefined"?this.styles:{line:this.styles[l]};for(var f in e)for(var d in e[f])if(d>=c&&(!o||d<n))for(var p in e[f][d])return!1;return!0},_getStyleDeclaration:function(l,c){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[l];if(!i)return null;l=i.line,c=i.offset+c}return this.callSuper("_getStyleDeclaration",l,c)},_setStyleDeclaration:function(l,c,i){var n=this._styleMap[l];l=n.line,c=n.offset+c,this.styles[l][c]=i},_deleteStyleDeclaration:function(l,c){var i=this._styleMap[l];l=i.line,c=i.offset+c,delete this.styles[l][c]},_getLineStyle:function(l){var c=this._styleMap[l];return!!this.styles[c.line]},_setLineStyle:function(l){var c=this._styleMap[l];this.styles[c.line]={}},_wrapText:function(l,c){var i=[],n;for(this.isWrapping=!0,n=0;n<l.length;n++)i=i.concat(this._wrapLine(l[n],n,c));return this.isWrapping=!1,i},_measureWord:function(l,c,i){var n=0,e,o=!0;i=i||0;for(var u=0,s=l.length;u<s;u++){var f=this._getGraphemeBox(l[u],c,u+i,e,o);n+=f.kernedWidth,e=l[u]}return n},_wrapLine:function(l,c,i,n){var e=0,o=this.splitByGrapheme,u=[],s=[],f=o?r.util.string.graphemeSplit(l):l.split(this._wordJoiners),d="",p=0,m=o?"":" ",y=0,S=0,O=0,R=!0,Y=this._getWidthOfCharSpacing(),n=n||0;f.length===0&&f.push([]),i-=n;for(var q=0;q<f.length;q++)d=o?f[q]:r.util.string.graphemeSplit(f[q]),y=this._measureWord(d,c,p),p+=d.length,e+=S+y-Y,e>i&&!R?(u.push(s),s=[],e=y,R=!0):e+=Y,!R&&!o&&s.push(m),s=s.concat(d),S=o?0:this._measureWord([m],c,p),p++,R=!1,y>O&&(O=y);return q&&u.push(s),O+n>this.dynamicMinWidth&&(this.dynamicMinWidth=O-Y+n),u},isEndOfWrapping:function(l){return!this._styleMap[l+1]||this._styleMap[l+1].line!==this._styleMap[l].line},missingNewlineOffset:function(l){return this.splitByGrapheme?this.isEndOfWrapping(l)?1:0:1},_splitTextIntoLines:function(l){for(var c=r.Text.prototype._splitTextIntoLines.call(this,l),i=this._wrapText(c.lines,this.width),n=new Array(i.length),e=0;e<i.length;e++)n[e]=i[e].join("");return c.lines=n,c.graphemeLines=i,c},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var l={};for(var c in this._styleMap)this._textLines[c]&&(l[this._styleMap[c].line]=1);for(var c in this.styles)l[c]||delete this.styles[c]},toObject:function(l){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(l))}}),r.Textbox.fromObject=function(l,c){return r.Object._fromObject("Textbox",l,c,"text")}}(a),function(){var h=t.controlsUtils,r=h.scaleSkewCursorStyleHandler,l=h.scaleCursorStyleHandler,c=h.scalingEqually,i=h.scalingYOrSkewingX,n=h.scalingXOrSkewingY,e=h.scaleOrSkewActionName,o=t.Object.prototype.controls;if(o.ml=new t.Control({x:-.5,y:0,cursorStyleHandler:r,actionHandler:n,getActionName:e}),o.mr=new t.Control({x:.5,y:0,cursorStyleHandler:r,actionHandler:n,getActionName:e}),o.mb=new t.Control({x:0,y:.5,cursorStyleHandler:r,actionHandler:i,getActionName:e}),o.mt=new t.Control({x:0,y:-.5,cursorStyleHandler:r,actionHandler:i,getActionName:e}),o.tl=new t.Control({x:-.5,y:-.5,cursorStyleHandler:l,actionHandler:c}),o.tr=new t.Control({x:.5,y:-.5,cursorStyleHandler:l,actionHandler:c}),o.bl=new t.Control({x:-.5,y:.5,cursorStyleHandler:l,actionHandler:c}),o.br=new t.Control({x:.5,y:.5,cursorStyleHandler:l,actionHandler:c}),o.mtr=new t.Control({x:0,y:-.5,actionHandler:h.rotationWithSnapping,cursorStyleHandler:h.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),t.Textbox){var u=t.Textbox.prototype.controls={};u.mtr=o.mtr,u.tr=o.tr,u.br=o.br,u.tl=o.tl,u.bl=o.bl,u.mt=o.mt,u.mb=o.mb,u.mr=new t.Control({x:.5,y:0,actionHandler:h.changeWidth,cursorStyleHandler:r,actionName:"resizing"}),u.ml=new t.Control({x:-.5,y:0,actionHandler:h.changeWidth,cursorStyleHandler:r,actionName:"resizing"})}}()})(Pe);const Ht={w:120,h:40,bgColor:["#78c386","#e48484","#c28976"],lineColor:"#69b1e4",textColor:"white",fontSize:16,origin:"center"};function Bh(a,t){const g=[],v=[];let _,C=new Pe.fabric.Canvas(a,{containerClass:"roadmap-container",hoverCursor:"pointer",interactive:!1,selection:!1});return t.forEach(w=>{const h=Rs(w);if(h.link=w.link,g.push(h),_&&v.push(Xh(_,h)),_=h,w.children){const[l=[],c=[]]=w.children;r(h,l,"left",1),r(h,c,"right",1)}function r(l,c,i,n){if(!c)return;const e=c.length,o=!(e&1);c.forEach((u,s)=>{let f=u.y||l.top-(Math.floor(e/2)-s)*(Ht.h+10);f+=o?Ht.h/2:0;const d=Rs(Xi(Bi({},u),{y:f,depth:n}));g.push(d);const p=i=="left"?Is(d,l):Is(l,d);v.push(p),u.children&&r(d,u.children,i,n+1)})}}),g.forEach(w=>C.add(w)),v.forEach(w=>C.add(w)),C}function Is(a,t){const g=a.left+a.width,v=a.top+a.height/2;let _,C;a.left>t.left?(_=t.left-(a.left-t.left)/2,C=a.top+(t.top-a.top)/2):(_=a.left+(t.left+a.width-a.left)/2,C=a.top+(t.top-a.top)/2);const w=t.left,h=t.top+Ht.h/2;return new Pe.fabric.Path(`M ${g} ${v} Q ${_},${C},${w},${h}`,{fill:"",stroke:Ht.lineColor,strokeWidth:2,strokeDashArray:[5,5]})}function Rs(a){const{title:t,x:g,y:v,depth:_=0}=a,{w:C,h:w,textColor:h,bgColor:r,fontSize:l,origin:c}=Ht,i=new Pe.fabric.Rect({fill:r[_],originX:c,originY:c,rx:"5",shadow:"rgba(0,0,0,.2) 2px 2px 2px",width:C-_*15,height:w}),n=new Pe.fabric.Text(t,{fill:h,originY:c,originX:c,fontWeight:"500",fontSize:l}),e=new Pe.fabric.Group([i,n],{left:g,top:v,lockMovementX:!0,lockMovementY:!0});return a.link&&(e.link=a.link),e}let Xn="left";function Xh(a,t){const g=a.left+Ht.w/2,v=a.top+Ht.h/2,_=Xn==="left"?a.left-Ht.w/3:a.left+Ht.w,C=a.top+(t.top-a.top)/2,w=t.left+Ht.w/2,h=t.top+Ht.h/2,r=new Pe.fabric.Path(`M ${g} ${v} Q ${_},${C},${w},${h}`,{fill:"",stroke:Ht.lineColor,strokeWidth:3});return Xn=Xn==="left"?"right":"left",r.globalCompositeOperation="destination-over",r}function oe(a,t,g={},v){const{w:_=120,h:C=40}=g,{bgColor:w,textColor:h}=Ht;return{title:a,x:t,w:_,h:C,bgColor:w,textColor:h,children:v}}const Wh=["height"],Yh={props:{height:Number},setup(a){let t=he(),g=[{title:"\u7F16\u7A0B\u5B66\u4E60\u4E4B\u8DEF",x:400,y:0},{title:"HTML",x:400,y:200},{title:"CSS",x:400,y:400,link:"/fe/css.html",children:[[oe("\u5E03\u5C40\u7B97\u6CD5",200),oe("css\u67B6\u6784",200)],[oe("\u9009\u62E9\u5668",600),oe("\u9884\u7F16\u8BD1",600,{},[oe("sass",750),oe("less",750),oe("stylus",750),oe("sass",750),oe("sass",750)])]]}];function v(_){console.log(_.target.link),_.target&&_.target.link&&(location.href=_.target.link)}return be(()=>{Bh(t.value,g).on("mouse:down",v)}),Ve(()=>{canvas.off("mouse:down",v)}),(_,C)=>(ft(),yt("canvas",{ref:(w,h)=>{h.canvasRef=w,Dt(t)?t.value=w:t=w},height:a.height,width:"900"},null,8,Wh))}};var Ri=Xi(Bi({},Lh),{enhanceApp({app:a}){a.component("Roadmap",Yh)}});const Wn=new Set,js=()=>document.createElement("link"),Hh=a=>{const t=js();t.rel="prefetch",t.href=a,document.head.appendChild(t)},Nh=a=>{const t=new XMLHttpRequest;t.open("GET",a,t.withCredentials=!0),t.send()};let ji;const Uh=zt&&(ji=js())&&ji.relList&&ji.relList.supports&&ji.relList.supports("prefetch")?Hh:Nh;function zh(){if(!zt||!window.IntersectionObserver)return;let a;if((a=navigator.connection)&&(a.saveData||/2g/.test(a.effectiveType)))return;const t=window.requestIdleCallback||setTimeout;let g=null;const v=()=>{g&&g.disconnect(),g=new IntersectionObserver(C=>{C.forEach(w=>{if(w.isIntersecting){const h=w.target;g.unobserve(h);const{pathname:r}=h;if(!Wn.has(r)){Wn.add(r);const l=vs(r);Uh(l)}}})}),t(()=>{document.querySelectorAll("#app a").forEach(C=>{const{target:w,hostname:h,pathname:r}=C,l=r.match(/\.\w+$/);l&&l[0]!==".html"||w!=="_blank"&&h===location.hostname&&(r!==location.pathname?g.observe(C):Wn.add(r))})})};be(v);const _=pe();Te(()=>_.path,v),Ve(()=>{g&&g.disconnect()})}const Gh=Pt({setup(a,{slots:t}){const g=he(!1);return be(()=>{g.value=!0}),()=>g.value&&t.default?t.default():null}}),Vh=Ri.NotFound||(()=>"404 Not Found"),$h={name:"VitePressApp",setup(){const{site:a}=Gt();return be(()=>{Te(()=>a.value.lang,t=>{document.documentElement.lang=t},{immediate:!0})}),zh(),()=>Oe(Ri.Layout)}};function qh(){const a=Jh(),t=Kh();t.provide(_s,a);const g=ml(a.route);return t.provide(ms,g),zt&&bl(a.route,g.site),t.component("Content",wl),t.component("ClientOnly",Gh),t.component("Debug",()=>null),Object.defineProperty(t.config.globalProperties,"$frontmatter",{get(){return g.frontmatter.value}}),Ri.enhanceApp&&Ri.enhanceApp({app:t,router:a,siteData:Mn}),{app:t,router:a}}function Kh(){return ll($h)}function Jh(){let a=zt,t;return yl(g=>{let v=vs(g);return a&&(t=v),(a||t===v)&&(v=v.replace(/\.js$/,".lean.js")),zt?(a=!1,import(v)):require(v)},Vh)}if(zt){const{app:a,router:t}=qh();t.go().then(()=>{a.mount("#app")})}export{Et as F,Ps as N,Ft as _,Zh as a,pt as b,yt as c,qh as createApp,_t as d,Pt as e,xt as f,ht as g,Ot as h,Ut as i,yn as j,Mt as k,ft as o,mn as r,Qt as t,Gt as u,oi as w};
